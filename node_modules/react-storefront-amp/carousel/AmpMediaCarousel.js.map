{"version":3,"sources":["../../src/carousel/AmpMediaCarousel.js"],"names":["styles","theme","lightbox","height","display","flexDirection","justifyContent","breakpoints","down","margin","thumbnails","paddingBottom","spacing","order","lightboxMagnifyHint","useStyles","name","AmpMediaCarousel","amp","maxItems","props","classes","createSpace","type","magnify","_","index","media","full","length","magnifyPrefix","getValue","bind","attribute","value","createMedia","isMagnify","Array","fill","map","filter","Boolean","mediaSpace","lightboxMediaSpace","open","Function","prototype","AmpCarousel","AmpMedia","AmpCarouselThumbnails","pairedIndex","lightboxClassName","thumbnailPosition","propTypes","MediaCarousel","defaultProps","id"],"mappings":"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","sourcesContent":["import React from 'react'\nimport DataBindingProvider from '../bind/DataBindingProvider'\nimport AmpCarousel from './AmpCarousel'\nimport AmpCarouselThumbnails from './AmpCarouselThumbnails'\nimport AmpDrawer from '../AmpDrawer'\nimport AmpMedia from './AmpMedia'\nimport MediaCarousel from 'react-storefront/carousel/MediaCarousel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useAmp } from 'next/amp'\nimport withDataBinding from '../bind/withDataBinding'\n\nconst styles = theme => ({\n  lightbox: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    '& > div:first-of-type': {\n      [theme.breakpoints.down('xs')]: {\n        margin: 0,\n      },\n    },\n  },\n  thumbnails: {\n    paddingBottom: theme.spacing(2),\n    order: 'inherit',\n  },\n  lightboxMagnifyHint: {\n    display: 'none',\n  },\n})\n\nconst useStyles = makeStyles(styles, { name: 'RSFAmpMediaCarousel' })\n\nfunction AmpMediaCarousel({ amp, maxItems = 8, ...props }) {\n  if (!useAmp()) return <MediaCarousel {...props} />\n\n  const classes = useStyles({ classes: props.classes })\n\n  function createSpace(type, magnify) {\n    return (_, index) => {\n      if (index >= props.media.full.length) return null\n      const magnifyPrefix = `${amp.getValue('media')}.full[${index}].magnify.src || `\n      return {\n        ...props.media[type][index],\n        ...amp.bind({\n          attribute: 'src',\n          value: `${magnify ? magnifyPrefix : ''}${amp.getValue('media')}.${type}[${index}].src`,\n        }),\n      }\n    }\n  }\n\n  function createMedia(isMagnify) {\n    return {\n      full: Array(maxItems)\n        .fill(0)\n        .map(createSpace('full', isMagnify))\n        .filter(Boolean),\n      thumbnails: Array(maxItems)\n        .fill(0)\n        .map(createSpace('thumbnails'))\n        .filter(Boolean),\n    }\n  }\n\n  const mediaSpace = createMedia(false)\n  const lightboxMediaSpace = createMedia(true)\n\n  return (\n    <DataBindingProvider\n      id=\"rsfMediaCarousel\"\n      store={{ open: false }}\n      root={null}\n      updateStore={Function.prototype}\n    >\n      <MediaCarousel\n        {...props}\n        id=\"ampCarousel\"\n        pairedCarouselId=\"ampLightboxCarousel\"\n        media={mediaSpace}\n        CarouselComponent={AmpCarousel}\n        MediaComponent={AmpMedia}\n        CarouselThumbnailsComponent={AmpCarouselThumbnails}\n        bind={{\n          index: `ampCarousel.index`,\n          pairedIndex: `ampLightboxCarousel.index`,\n          open: 'open',\n        }}\n      />\n      <AmpDrawer open showCloseButton fullscreen>\n        <div className={classes.lightbox}>\n          <MediaCarousel\n            {...props}\n            id=\"ampLightboxCarousel\"\n            pairedCarouselId=\"ampCarousel\"\n            media={lightboxMediaSpace}\n            CarouselComponent={AmpCarousel}\n            MediaComponent={AmpMedia}\n            CarouselThumbnailsComponent={AmpCarouselThumbnails}\n            thumbsClassName={classes.thumbnails}\n            className={props.lightboxClassName}\n            magnifyHintClassName={classes.lightboxMagnifyHint}\n            thumbnailPosition={props.thumbnailPosition === 'top' ? 'top' : 'bottom'}\n            bind={{\n              index: `ampLightboxCarousel.index`,\n              pairedIndex: `ampCarousel.index`,\n            }}\n          />\n        </div>\n      </AmpDrawer>\n    </DataBindingProvider>\n  )\n}\n\nAmpMediaCarousel.propTypes = MediaCarousel.propTypes\nAmpMediaCarousel.defaultProps = { ...MediaCarousel.defaultProps, id: 'carousel' }\n\nexport default withDataBinding(AmpMediaCarousel)\n"],"file":"AmpMediaCarousel.js"}
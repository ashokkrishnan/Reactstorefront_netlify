"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = getImageSize;

var _sync = _interopRequireDefault(require("probe-image-size/sync"));

/**
 * Returns the height and width of an image
 * @param {String} url The image url or src for inline images
 * @param {Object} options
 * @param {Object} options.imageService The hostname to use for the image size service
 * @return {Object} An object with `height` and `width`.
 */
function getImageSize(url) {
  var imageService = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'image.moovweb.net';

  // we're dealing with an inline image
  if (url.startsWith('data:')) {
    var base64Img = url.toString().split(',')[1].trim();
    var imgAttributes = (0, _sync["default"])(Buffer.from(base64Img, 'base64'));
    var width = imgAttributes.width,
        height = imgAttributes.height;
    return {
      width: width,
      height: height
    };
  } // it's an external url - use the Moovweb image service


  return fetch("https://".concat(imageService, "/size?url=").concat(encodeURIComponent(url))).then(function (res) {
    return res.json();
  });
}
//# sourceMappingURL=getImageSize.js.map
{"version":3,"sources":["../../src/menu/AmpMenu.js"],"names":["AmpMenu","props","cards","root","nextId","addMenuData","item","depth","result","_rsfMenuItem","_rsfMenuCard","items","map","card","push","card0","propTypes","Menu","defaultProps"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;AAEA;;;;;AAKe,SAASA,OAAT,CAAiBC,KAAjB,EAAwB;AACrC,MAAI,CAAC,kBAAL,EAAe;AACb,WAAO,gCAAC,gBAAD,EAAUA,KAAV,CAAP;AACD;;AAED,MAAMC,KAAK,GAAG,EAAd;AALqC,MAM/BC,IAN+B,GAMtBF,KANsB,CAM/BE,IAN+B;AAOrC,MAAIC,MAAM,GAAG,CAAb;;AAEA,WAASC,WAAT,CAAqBC,IAArB,EAAsC;AAAA,QAAXC,KAAW,uEAAH,CAAG;;AACpC,QAAMC,MAAM,qBACPF,IADO;AAEVG,MAAAA,YAAY,EAAEL,MAAM,EAFV;AAGVM,MAAAA,YAAY,EAAEH,KAHJ;AAIVJ,MAAAA,IAAI,EAAEI,KAAK,KAAK,CAJN;AAKVI,MAAAA,KAAK,EACHL,IAAI,IACJA,IAAI,CAACK,KADL,IAEAL,IAAI,CAACK,KAAL,CAAWC,GAAX,CAAe,UAAAN,IAAI,EAAI;AACrB,eAAOD,WAAW,CAACC,IAAD,EAAOC,KAAK,GAAG,CAAf,CAAlB;AACD,OAFD;AARQ,MAAZ;;AAaA,QAAIM,IAAI,GAAGX,KAAK,CAACK,KAAD,CAAhB;AACA,QAAI,CAACM,IAAL,EAAWA,IAAI,GAAGX,KAAK,CAACK,KAAD,CAAL,GAAe,EAAtB;AACXM,IAAAA,IAAI,CAACC,IAAL,CAAUN,MAAV;AAEA,WAAOA,MAAP;AACD;;AAEDL,EAAAA,IAAI,GAAGE,WAAW,CAACJ,KAAK,CAACE,IAAP,CAAlB;AAEA,SACE,kEACE,gCAAC,oBAAD;AAAU,IAAA,EAAE,EAAC,cAAb;AAA4B,IAAA,YAAY,EAAE;AAAEY,MAAAA,KAAK,EAAE,CAAT;AAAYF,MAAAA,IAAI,EAAE;AAAlB;AAA1C,IADF,EAEE,gCAAC,gBAAD,gCACMZ,KADN;AAEE,IAAA,YAAY,EAAE;AAAA,aAAM,gCAAC,yBAAD,gCAAmBA,KAAnB;AAA0B,QAAA,IAAI,EAAEE,IAAhC;AAAsC,QAAA,KAAK,EAAED;AAA7C,SAAN;AAAA;AAFhB,KAFF,CADF;AASD;;AAEDF,OAAO,CAACgB,SAAR,GAAoBC,iBAAKD,SAAzB;AACAhB,OAAO,CAACkB,YAAR,GAAuBD,iBAAKC,YAA5B","sourcesContent":["import React from 'react'\nimport Menu from 'react-storefront/menu/Menu'\nimport AmpMenuDrawer from './AmpMenuDrawer'\nimport { useAmp } from 'next/amp'\nimport AmpState from '../AmpState'\n\n/**\n *\n * Overrides Menu and renders all menu items at once, using CSS to show/hide then based\n * on the user's navigation through the menu.\n */\nexport default function AmpMenu(props) {\n  if (!useAmp()) {\n    return <Menu {...props} />\n  }\n\n  const cards = []\n  let { root } = props\n  let nextId = 0\n\n  function addMenuData(item, depth = 0) {\n    const result = {\n      ...item,\n      _rsfMenuItem: nextId++,\n      _rsfMenuCard: depth,\n      root: depth === 0,\n      items:\n        item &&\n        item.items &&\n        item.items.map(item => {\n          return addMenuData(item, depth + 1)\n        }),\n    }\n\n    let card = cards[depth]\n    if (!card) card = cards[depth] = []\n    card.push(result)\n\n    return result\n  }\n\n  root = addMenuData(props.root)\n\n  return (\n    <>\n      <AmpState id=\"rsfMenuState\" initialState={{ card0: 0, card: 0 }} />\n      <Menu\n        {...props}\n        renderDrawer={() => <AmpMenuDrawer {...props} root={root} cards={cards} />}\n      />\n    </>\n  )\n}\n\nAmpMenu.propTypes = Menu.propTypes\nAmpMenu.defaultProps = Menu.defaultProps\n"],"file":"AmpMenu.js"}
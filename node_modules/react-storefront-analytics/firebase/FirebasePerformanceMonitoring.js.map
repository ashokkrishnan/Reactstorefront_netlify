{"version":3,"sources":["../../src/firebase/FirebasePerformanceMonitoring.js"],"names":["window","__rsfFirebaseSendPerformanceMetrics","reportPerformanceMetrics","FirebasePerformanceMonitoring","config","firebaseSdkUrl","clientSideNavigationTraceName","children","context","trace","Router","events","on","firebasePerf","start","scripts","__html","JSON","stringify","propTypes","PropTypes","object","isRequired","string","defaultProps"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;AACA,IAAI,OAAOA,MAAP,KAAkB,WAAtB,EAAmC;AACjCA,EAAAA,MAAM,CAACC,mCAAP,GAA6CC,oCAA7C;AACD;AAED;;;;;;;;;;;;AAUe,SAASC,6BAAT,OAKZ;AAAA,MAJDC,MAIC,QAJDA,MAIC;AAAA,MAHDC,cAGC,QAHDA,cAGC;AAAA,MAFDC,6BAEC,QAFDA,6BAEC;AAAA,MADDC,QACC,QADDA,QACC;AACD,MAAMC,OAAO,GAAG,oBAAQ;AAAA,WAAO;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAAP;AAAA,GAAR,EAAiC,EAAjC,CAAhB;AAEA,wBAAU,YAAM;AACd,QAAIL,MAAJ,EAAY;AACVM,qBAAOC,MAAP,CAAcC,EAAd,CAAiB,kBAAjB,EAAqC,YAAM;AACzCJ,QAAAA,OAAO,CAACC,KAAR,GAAgBT,MAAM,CAACa,YAAP,CAAoBJ,KAApB,CAA0BH,6BAA1B,CAAhB;AACAE,QAAAA,OAAO,CAACC,KAAR,CAAcK,KAAd,GAFyC,CAEnB;AACvB,OAHD;AAID;AACF,GAPD,EAOG,CAACV,MAAD,CAPH;AASA,MAAIW,OAAO,GAAG,IAAd;;AAEA,MAAIX,MAAM,IAAI,CAAC,kBAAf,EAAyB;AACvBW,IAAAA,OAAO,GACL,kEACE;AACE,MAAA,IAAI,EAAC,wCADP;AAEE,MAAA,GAAG,EAAC,YAFN;AAGE,MAAA,WAAW,EAAC;AAHd,MADF,EAME;AACE,MAAA,KAAK,MADP;AAEE,MAAA,uBAAuB,EAAE;AACvBC,QAAAA,MAAM,kdAQHC,IAAI,CAACC,SAAL,CAAeb,cAAf,CARG,eAQgCY,IAAI,CAACC,SAAL,CAAed,MAAf,CARhC;AADiB;AAF3B,MANF,CADF;AAuBD;;AAED,SACE,gCAAC,2BAAD,CAAiB,QAAjB;AAA0B,IAAA,KAAK,EAAEI;AAAjC,KACGO,OADH,EAEGR,QAFH,CADF;AAMD;;AAEDJ,6BAA6B,CAACgB,SAA9B,GAA0C;AACxC;;;;AAIAf,EAAAA,MAAM,EAAEgB,sBAAUC,MAAV,CAAiBC,UALe;;AAMxC;;;AAGAjB,EAAAA,cAAc,EAAEe,sBAAUG,MAAV,CAAiBD,UATO;;AAUxC;;;;;;;AAOAhB,EAAAA,6BAA6B,EAAEc,sBAAUG;AAjBD,CAA1C;AAoBApB,6BAA6B,CAACqB,YAA9B,GAA6C;AAC3ClB,EAAAA,6BAA6B,EAAE,wBADY;AAE3CD,EAAAA,cAAc,EAAE;AAF2B,CAA7C","sourcesContent":["import React, { useEffect, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport reportPerformanceMetrics from './reportPerformanceMetrics'\nimport { Router } from 'next/router'\nimport FirebaseContext from './FirebaseContext'\nimport { useAmp } from 'next/amp'\n\n/* istanbul ignore else */\nif (typeof window !== 'undefined') {\n  window.__rsfFirebaseSendPerformanceMetrics = reportPerformanceMetrics\n}\n\n/**\n * Reports RUM metrics to Firebase Performance Monitoring.\n *\n * Your firebase config object must be provided as the `config` prop. To get your firebase config object:\n *\n * 1.) Go to your the Settings icon Project settings in the Firebase console.\n * 2.) In the Your apps card, select the nickname of the app for which you need a config object.\n * 3.) Select Config from the Firebase SDK snippet pane.\n * 4.) Provide the config object using the `config` prop on this component.\n */\nexport default function FirebasePerformanceMonitoring({\n  config,\n  firebaseSdkUrl,\n  clientSideNavigationTraceName,\n  children,\n}) {\n  const context = useMemo(() => ({ trace: null }), [])\n\n  useEffect(() => {\n    if (config) {\n      Router.events.on('routeChangeStart', () => {\n        context.trace = window.firebasePerf.trace(clientSideNavigationTraceName)\n        context.trace.start() // the trace will be ended by FirebaseNavigationTrace\n      })\n    }\n  }, [config])\n\n  let scripts = null\n\n  if (config && !useAmp()) {\n    scripts = (\n      <>\n        <link\n          href=\"https://firebaselogging.googleapis.com\"\n          rel=\"preconnect\"\n          crossOrigin=\"anonymous\"\n        />\n        <script\n          defer\n          dangerouslySetInnerHTML={{\n            __html: `\n          (function(sa,fbc){function load(f,c){var a=document.createElement('script');\n          a.async=1;a.src=f;var s=document.getElementsByTagName('script')[0];\n          s.parentNode.insertBefore(a,s);}load(sa);\n          window.addEventListener('load',function(){ \n            window.firebasePerf = firebase.initializeApp(fbc).performance(); \n            __rsfFirebaseSendPerformanceMetrics(window.firebasePerf)\n          });\n          })(${JSON.stringify(firebaseSdkUrl)}, ${JSON.stringify(config)});`,\n          }}\n        />\n      </>\n    )\n  }\n\n  return (\n    <FirebaseContext.Provider value={context}>\n      {scripts}\n      {children}\n    </FirebaseContext.Provider>\n  )\n}\n\nFirebasePerformanceMonitoring.propTypes = {\n  /**\n   * Your firebase config.  You can get this from the Firebase console at\n   * Settings => General => Your Apps => Firebase SDK Snippet => Config\n   */\n  config: PropTypes.object.isRequired,\n  /**\n   * The CDN URL for the standalone firebase SDK\n   */\n  firebaseSdkUrl: PropTypes.string.isRequired,\n  /**\n   * The name of the custom trace used to capture client side navigation time.\n   * Defaults to \"client-side-navigation\".\n   *\n   * To track client side navigation time, you need to add `<TrackPageView/>` to\n   * each page component in your app.\n   */\n  clientSideNavigationTraceName: PropTypes.string,\n}\n\nFirebasePerformanceMonitoring.defaultProps = {\n  clientSideNavigationTraceName: 'client-side-navigation',\n  firebaseSdkUrl: 'https://www.gstatic.com/firebasejs/7.15.1/firebase-performance-standalone.js',\n}\n"],"file":"FirebasePerformanceMonitoring.js"}
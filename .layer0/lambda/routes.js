var If=Object.defineProperty,Nf=Object.defineProperties;var jf=Object.getOwnPropertyDescriptors;var Hr=Object.getOwnPropertySymbols;var fo=Object.prototype.hasOwnProperty,ho=Object.prototype.propertyIsEnumerable;var po=(e,t,r)=>t in e?If(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,S=(e,t)=>{for(var r in t||(t={}))fo.call(t,r)&&po(e,r,t[r]);if(Hr)for(var r of Hr(t))ho.call(t,r)&&po(e,r,t[r]);return e},O=(e,t)=>Nf(e,jf(t));var yo=(e,t)=>{var r={};for(var n in e)fo.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Hr)for(var n of Hr(e))t.indexOf(n)<0&&ho.call(e,n)&&(r[n]=e[n]);return r};var h=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var H=h(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.LAYER0_CONFIG_FILE="layer0.config.js";C.LAYER0_ASSET_ALIASES_FILE="asset-aliases.json";C.LAYER0_ENV_VARIABLES={config:"LAYER0_CONFIG",deploymentType:"LAYER0_DEPLOYMENT_TYPE",versionOverride:"LAYER0_VERSION_OVERRIDE"};C.LAYER0_DEPLOYMENT_TYPE_AWS="AWS";C.LAYER0_HEADERS_PREFIX="x-0-";C.LAYER0_MAX_USER_HEADERS_ALLOWED=70;C.LAYER0_TOO_MANY_HEADERS_STATUS_CODE=542;C.LAYER0_UNCACHED_PREFETCH_STATUS=412;C.ACTIONS={setHeader:"set-header",updateHeader:"update-header",removeHeader:"remove-header",syntheticRes:"synthetic-response",updatePath:"update-path",proxy:"proxy",addCookie:"add-cookie",updateCookie:"update-cookie",removeCookie:"remove-cookie"};C.BACKENDS={js:"__js__",static:"__static__",permanentStatic:"__permanent_static__",imageOptimizer:"__image_optimizer__"};C.JS_BACKEND_HOSTNAME="127.0.0.1";C.HTTP_METHODS={head:"head",get:"get",post:"post",delete:"delete",put:"put",patch:"patch",options:"options"};C.HTTP_HEADERS={authorization:"authorization",acceptEncoding:"accept-encoding",cacheControl:"cache-control",contentEncoding:"content-encoding",contentLength:"content-length",contentType:"content-type",cookie:"cookie",host:"host",location:"location",serverTiming:"server-timing",setCookie:"set-cookie",userAgent:"user-agent",vary:"vary",xForwardedFor:"x-forwarded-for",xRequestId:"x-request-id",xSwCacheControl:"x-sw-cache-control",x0Browser:"x-0-browser",x0CacheControl:"x-0-cache-control",x0CachingStatus:"x-0-caching-status",x0ClientIp:"x-0-client-ip",x0Components:"x-0-components",x0Destination:"x-0-destination",x0Device:"x-0-device",x0DeviceIsBot:"x-0-device-is-bot",x0GeoCity:"x-0-geo-city",x0GeoCountryCode:"x-0-geo-country-code",x0GeoLatitude:"x-0-geo-latitude",x0GeoLongitude:"x-0-geo-longitude",x0GeoPostalCode:"x-0-geo-postal-code",x0MatchedRoutes:"x-0-matched-routes",x0Protocol:"x-0-protocol",x0Route:"x-0-route",x0Status:"x-0-status",x0SurrogateKey:"x-0-surrogate-key",x0T:"x-0-t",x0UserT:"x-0-user-t",x0Vendor:"x-0-vendor",x0Version:"x-0-version"};C.CACHING_STATUS={ok:"ok",private:"private",method:"method",bodyTooBig:"body-too-big",code:"code",setCookie:"set-cookie",noMaxAge:"no-max-age"};C.CACHEABLE_METHODS=new Set(["get","head"]);C.THROTTLED_QUERY_PARAM="layer0_prefetch";C.PREFETCH_QUERY_PARAM=C.THROTTLED_QUERY_PARAM;C.DEVTOOLS_PREFETCH_QUERY_PARAM="layer0_dt_pf";C.HEAD_QUERY_PARAM="layer0_head";C.POST_BODY_QUERY_PARAM="pref_layer0_body";C.METHOD_QUERY_PARAM="pref_layer0_method";C.ROUTES_FALLBACK="fallback";C.ROUTES_CATCH_GROUP="catch";C.LAYER0_IMAGE_OPTIMIZER_PATH="/__layer0_image_optimizer"});var Xe=h(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});var go=H();function mo(){return process.env[go.LAYER0_ENV_VARIABLES.deploymentType]===go.LAYER0_DEPLOYMENT_TYPE_AWS}Je.isCloud=mo;function Lf(){return process.env.LAYER0_LOCAL==="true"}Je.isLocal=Lf;function vo(){return process.env.NODE_ENV==="production"}Je.isProductionBuild=vo;function $f(){return!mo()&&!vo()}Je.isLayer0RunDev=$f});var Vn=h((ER,_o)=>{"use strict";_o.exports=e=>{let t=/^\\\\\?\\/.test(e),r=/[^\u0000-\u0080]+/.test(e);return t||r?e:e.replace(/\\/g,"/")}});var ie=h((exports,module)=>{"use strict";var __importDefault=exports&&exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var slash_1=__importDefault(Vn());function nonWebpackRequire(modulePath,{ignoreErrors=!1}={}){try{return eval("require")(slash_1.default(modulePath))}catch(e){if(ignoreErrors)return;throw e}}exports.default=nonWebpackRequire});var Co=h(xe=>{"use strict";var Ff=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xe,"__esModule",{value:!0});var kf=Xe(),Ro=Ff(ie()),Eo="layer0",Yn;function Bf(e){return kf.isLocal()?Uf().runAndReturn(e):(global.__layer0_timings__=new So,e())}xe.withContext=Bf;function bo(){return global.__layer0_timings__||Wf()}function Uf(){let e=Ro.default("cls-hooked");return Yn||(Yn=e.createNamespace(Eo)),Yn}function Wf(){return Ro.default("cls-hooked").getNamespace(Eo)}function Gf(e,t){try{let r=bo(),n=r.get(e);return n==null&&(n=t,r.set(e,t)),n}catch(r){return t}}xe.get=Gf;function Vf(e,t){try{bo().set(e,t)}catch(r){throw new Error("set must be called within withContext")}}xe.set=Vf;var So=class{constructor(){this.values={}}get(t){return this.values[t]}set(t,r){this.values[t]=r}}});var Xn=h(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});var Dr=H(),zn=Co();V.NOT_ENDED_VALUE="na";var Kn=class{constructor(t,r=!0){this.duration=0,this.ended=!1,this.name=t,(r?Qn():Jn()).push(this)}start(){return this.startTime=new Date,this.ended=!1,this}set(t){return this.discreteValue=t,this}end(){return this.startTime?(this.ended=!0,this.duration+=new Date().getTime()-this.startTime.getTime(),this):(console.warn(`Timing ${this.name} not started.`),this)}pause(){return this.end()}resume(){return this.start()}get value(){return this.discreteValue!=null?this.discreteValue:this.ended?this.duration:V.NOT_ENDED_VALUE}};V.InternalTiming=Kn;function Yf(e){return(...t)=>zn.withContext(()=>e(...t))}V.withTimings=Yf;function zf(e){var t;return(t=Qn().find(r=>r.name===e))===null||t===void 0?void 0:t.value}V.getInternalTiming=zf;function Qn(){return zn.get("internalTimings",[])}function Jn(){return zn.get("userTimings",[])}function Kf(e){let t=Jn(),r=Qn();t.length&&(e.setHeader(Dr.HTTP_HEADERS.x0UserT,Ao(t)),e.setHeader(Dr.HTTP_HEADERS.serverTiming,Qf(e))),r.length&&e.setHeader(Dr.HTTP_HEADERS.x0T,Ao(r))}V.addTimings=Kf;function Ao(e){return e.map(t=>`${t.name}=${t.value}`).join(",")}function Qf(e){let t=e.getHeader(Dr.HTTP_HEADERS.serverTiming),r=Jn().map(n=>`${n.name};dur=${n.value}`);return Array.isArray(t)?r.push(...t):t&&r.push(t),r.join(", ")}var wo=class extends Kn{constructor(t){super(t,!1)}};V.default=wo;var Jf;(function(e){e.edgeCache="oc",e.transformRequest="wa",e.transformResponse="wz",e.routeMatching="wr",e.proxying="wp"})(Jf=V.InternalNames||(V.InternalNames={}));var Xf;(function(e){e.hit="hit",e.pass="pass",e.cached="cached"})(Xf=V.CacheValue||(V.CacheValue={}))});var es=h(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.default=td;var Zf=ed(require("crypto"));function ed(e){return e&&e.__esModule?e:{default:e}}var qr=new Uint8Array(256),Mr=qr.length;function td(){return Mr>qr.length-16&&(Zf.default.randomFillSync(qr),Mr=0),qr.slice(Mr,Mr+=16)}});var xo=h(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.default=void 0;var rd=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Ir.default=rd});var Ht=h(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.default=void 0;var nd=sd(xo());function sd(e){return e&&e.__esModule?e:{default:e}}function id(e){return typeof e=="string"&&nd.default.test(e)}var od=id;Nr.default=od});var Dt=h(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.default=void 0;var ad=ud(Ht());function ud(e){return e&&e.__esModule?e:{default:e}}var I=[];for(let e=0;e<256;++e)I.push((e+256).toString(16).substr(1));function cd(e,t=0){let r=(I[e[t+0]]+I[e[t+1]]+I[e[t+2]]+I[e[t+3]]+"-"+I[e[t+4]]+I[e[t+5]]+"-"+I[e[t+6]]+I[e[t+7]]+"-"+I[e[t+8]]+I[e[t+9]]+"-"+I[e[t+10]]+I[e[t+11]]+I[e[t+12]]+I[e[t+13]]+I[e[t+14]]+I[e[t+15]]).toLowerCase();if(!(0,ad.default)(r))throw TypeError("Stringified UUID is invalid");return r}var ld=cd;jr.default=ld});var Oo=h(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.default=void 0;var fd=To(es()),dd=To(Dt());function To(e){return e&&e.__esModule?e:{default:e}}var Po,ts,rs=0,ns=0;function hd(e,t,r){let n=t&&r||0,i=t||new Array(16);e=e||{};let s=e.node||Po,o=e.clockseq!==void 0?e.clockseq:ts;if(s==null||o==null){let d=e.random||(e.rng||fd.default)();s==null&&(s=Po=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),o==null&&(o=ts=(d[6]<<8|d[7])&16383)}let a=e.msecs!==void 0?e.msecs:Date.now(),u=e.nsecs!==void 0?e.nsecs:ns+1,c=a-rs+(u-ns)/1e4;if(c<0&&e.clockseq===void 0&&(o=o+1&16383),(c<0||a>rs)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");rs=a,ns=u,ts=o,a+=122192928e5;let l=((a&268435455)*1e4+u)%4294967296;i[n++]=l>>>24&255,i[n++]=l>>>16&255,i[n++]=l>>>8&255,i[n++]=l&255;let f=a/4294967296*1e4&268435455;i[n++]=f>>>8&255,i[n++]=f&255,i[n++]=f>>>24&15|16,i[n++]=f>>>16&255,i[n++]=o>>>8|128,i[n++]=o&255;for(let d=0;d<6;++d)i[n+d]=s[d];return t||(0,dd.default)(i)}var pd=hd;Lr.default=pd});var ss=h($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.default=void 0;var yd=gd(Ht());function gd(e){return e&&e.__esModule?e:{default:e}}function md(e){if(!(0,yd.default)(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}var vd=md;$r.default=vd});var is=h(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.default=bd;Te.URL=Te.DNS=void 0;var _d=Ho(Dt()),Rd=Ho(ss());function Ho(e){return e&&e.__esModule?e:{default:e}}function Ed(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Do="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Te.DNS=Do;var qo="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Te.URL=qo;function bd(e,t,r){function n(i,s,o,a){if(typeof i=="string"&&(i=Ed(i)),typeof s=="string"&&(s=(0,Rd.default)(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+i.length);if(u.set(s),u.set(i,s.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,o){a=a||0;for(let c=0;c<16;++c)o[a+c]=u[c];return o}return(0,_d.default)(u)}try{n.name=e}catch(i){}return n.DNS=Do,n.URL=qo,n}});var Mo=h(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.default=void 0;var Sd=Cd(require("crypto"));function Cd(e){return e&&e.__esModule?e:{default:e}}function Ad(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),Sd.default.createHash("md5").update(e).digest()}var wd=Ad;Fr.default=wd});var No=h(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.default=void 0;var xd=Io(is()),Td=Io(Mo());function Io(e){return e&&e.__esModule?e:{default:e}}var Pd=(0,xd.default)("v3",48,Td.default),Od=Pd;kr.default=Od});var Lo=h(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.default=void 0;var Hd=jo(es()),Dd=jo(Dt());function jo(e){return e&&e.__esModule?e:{default:e}}function qd(e,t,r){e=e||{};let n=e.random||(e.rng||Hd.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let i=0;i<16;++i)t[r+i]=n[i];return t}return(0,Dd.default)(n)}var Md=qd;Br.default=Md});var $o=h(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.default=void 0;var Id=Nd(require("crypto"));function Nd(e){return e&&e.__esModule?e:{default:e}}function jd(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),Id.default.createHash("sha1").update(e).digest()}var Ld=jd;Ur.default=Ld});var ko=h(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.default=void 0;var $d=Fo(is()),Fd=Fo($o());function Fo(e){return e&&e.__esModule?e:{default:e}}var kd=(0,$d.default)("v5",80,Fd.default),Bd=kd;Wr.default=Bd});var Bo=h(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.default=void 0;var Ud="00000000-0000-0000-0000-000000000000";Gr.default=Ud});var Uo=h(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.default=void 0;var Wd=Gd(Ht());function Gd(e){return e&&e.__esModule?e:{default:e}}function Vd(e){if(!(0,Wd.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var Yd=Vd;Vr.default=Yd});var Wo=h(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});Object.defineProperty(te,"v1",{enumerable:!0,get:function(){return zd.default}});Object.defineProperty(te,"v3",{enumerable:!0,get:function(){return Kd.default}});Object.defineProperty(te,"v4",{enumerable:!0,get:function(){return Qd.default}});Object.defineProperty(te,"v5",{enumerable:!0,get:function(){return Jd.default}});Object.defineProperty(te,"NIL",{enumerable:!0,get:function(){return Xd.default}});Object.defineProperty(te,"version",{enumerable:!0,get:function(){return Zd.default}});Object.defineProperty(te,"validate",{enumerable:!0,get:function(){return eh.default}});Object.defineProperty(te,"stringify",{enumerable:!0,get:function(){return th.default}});Object.defineProperty(te,"parse",{enumerable:!0,get:function(){return rh.default}});var zd=le(Oo()),Kd=le(No()),Qd=le(Lo()),Jd=le(ko()),Xd=le(Bo()),Zd=le(Uo()),eh=le(Ht()),th=le(Dt()),rh=le(ss());function le(e){return e&&e.__esModule?e:{default:e}}});var os=h(qt=>{"use strict";var Go=qt&&qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qt,"__esModule",{value:!0});var nh=Go(require("url")),sh=Go(require("querystring")),Vo=class{constructor(t,r,n){}cache(t){}redirect(t,r){}_readRedirectParams(t,r){let{statusCode:n=302,query:i={}}=typeof r=="number"?{statusCode:r}:r,s={},o=nh.default.parse(t);return(o==null?void 0:o.search)&&(t=t.substr(0,t.length-o.search.length),s=sh.default.parse(o.query)),{to:t,statusCode:n,query:S(S({},s),i)}}proxy(t,r){}render(t){}stream(t){}serveStatic(t,r){}updatePath(t){}rewrite(t,r){}setRequestHeader(t,r){}updateRequestHeader(t,r,n){}removeRequestHeader(t){}setUpstreamResponseHeader(t,r){}updateUpstreamResponseHeader(t,r,n){}removeUpstreamResponseHeader(t){}setResponseHeader(t,r){}updateResponseHeader(t,r,n){}removeResponseHeader(t){}addResponseCookie(t,r){}updateResponseCookie(t,r,n){}removeResponseCookie(t){}addUpstreamResponseCookie(t,r){}updateUpstreamResponseCookie(t,r,n){}removeUpstreamResponseCookie(t){}send(t,r,n){}compute(t){}serviceWorker(t){}allowCors(t){}appShell(t){}renderWithApp(t){}};qt.BaseResponseWriter=Vo});var Mt=h(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});var ih=e=>e;function oh(e,t,r=ih){let n={};return Object.entries(e).every(([i,s])=>{let o=t[r(i)];if(s===null)return o===void 0;if(typeof s=="string"){if(typeof o=="string"&&Yo(s)){let a=zo(s);return n[a]=o,!0}s=new RegExp(`^${s}$`,"i")}return Ko(s,o)})&&n}Ze.matchCriteriaRegexObjectWithRequestObject=oh;function Yo(e){return typeof e=="string"&&/^:\w+$/.test(e)}Ze.isParamMatcher=Yo;function zo(e){return e.slice(1)}Ze.paramMatcherToParam=zo;function Ko(e,t){return t==null?!1:(e.global&&(e=new RegExp(e)),Array.isArray(t)?t.some(r=>e.test(r)):e.test(t))}Ze.testRegExp=Ko});var us=h(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});function ah(e,t){let r={};for(let[n,i]of Object.entries(e))r[n]=t(i,n);return r}as.default=ah});var Qo=h(It=>{"use strict";var uh=It&&It.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(It,"__esModule",{value:!0});var ch=Mt(),lh=uh(us()),Pe=class{constructor(t){this.entries=t||[]}get cacheableEntries(){return this.entries.filter(Pe.isEntryCacheable)}get spaRoutes(){return this.cacheableEntries.filter(({cacheOptions:t})=>t.browser&&t.browser.spa).map(({route:t})=>new RegExp(t,"i"))}shouldPrefetch(t){let r=!1;return this.entries.some(n=>Pe.entryMatches(n,t)?(r=Pe.isEntryCacheable(n)||!!n.cacheOptions.prefetchUpstreamRequests,r||n.returnsResponse):!1),r}static entryMatches(t,r){return new RegExp(t.route,"i").test(r.pathname)&&ch.matchCriteriaRegexObjectWithRequestObject(lh.default(t.query||{},n=>n?new RegExp(n,"i"):null),Object.fromEntries(Array.from(r.searchParams.entries())))&&(t.protocol?new RegExp(t.protocol,"i").test(r.protocol):!0)}static isEntryCacheable({cacheOptions:t}){return!!(t.browser&&(t.browser.serviceWorkerSeconds||0)>0&&t.edge&&(t.edge.maxAgeSeconds||0)>0)}static fromEntries(t){return new Pe(t)}toJSON(){return JSON.stringify(this.entries)}};It.default=Pe});var Zo=h(Nt=>{"use strict";var Jo=Nt&&Nt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nt,"__esModule",{value:!0});var fh=os(),dh=Jo(Qo()),hh=Jo(us());function ph(e){let t=new dh.default,r=n=>{if(n!==void 0)return n instanceof RegExp?n.source:n};for(let n of e.routeGroups.getRoutes()){let i=new Xo;n.handler(i);let s={criteriaPath:n.criteria.path,route:n.toRegexString(),method:r(n.criteria.method),protocol:r(n.criteria.protocol),cacheOptions:i.cacheOptions,returnsResponse:i.returnsResponse};n.criteria.query&&(s.query=hh.default(n.criteria.query,o=>o?o.source:null)),!(n.criteria.headers||n.criteria.cookies)&&t.entries.push(s)}return t}Nt.default=ph;var Xo=class extends fh.BaseResponseWriter{constructor(){super(...arguments);this.response={},this.cacheOptions={},this.returnsResponse=!1,this.doesReturnResponse=()=>this.returnsResponse=!0,this.cache=t=>{this.cacheOptions=t},this.send=this.doesReturnResponse,this.compute=this.doesReturnResponse,this.proxy=this.doesReturnResponse,this.redirect=this.doesReturnResponse,this.render=this.doesReturnResponse,this.serveStatic=this.doesReturnResponse,this.serviceWorker=this.doesReturnResponse,this.renderWithApp=this.doesReturnResponse,this.appShell=this.doesReturnResponse,this.stream=this.doesReturnResponse}}});var na=h((WR,ra)=>{var yh=require("path"),gh=60*60*24*365*10,mh={edge:{maxAgeSeconds:gh},browser:!1},ea="layer0_devtools_enabled",vh="layer0_devtools_env_enabled";function ta(){return process.env.LAYER0_DEVTOOLS_ENABLED?process.env.LAYER0_DEVTOOLS_ENABLED==="true":process.env.PREVIEW_LAYER0_DEVTOOLS_ENABLED?process.env.PREVIEW_LAYER0_DEVTOOLS_ENABLED==="true":null}ra.exports=function(t){ta()!==null&&t.match("/(.*)",({addResponseCookie:r})=>{r(vh,`${ta()}; Path=/`)}),t.get("/__layer0__/devtools/enable",({redirect:r,addResponseCookie:n})=>{n(ea,"true; Path=/"),r("/")}).get("/__layer0__/devtools/disable",({redirect:r,addResponseCookie:n})=>{n(ea,"false; Path=/"),r("/")}).match("/__layer0__/devtools/:path*",({cache:r,serveStatic:n})=>{r(mh),n(yh.join("node_modules","@layer0","devtools","widget",":path*"))})}});var sa=h(jt=>{"use strict";var _h=jt&&jt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jt,"__esModule",{value:!0});var Rh=_h(Zo());function Eh(e){bh(e);try{na()(e)}catch(t){if(t.code!=="MODULE_NOT_FOUND")throw t}}jt.default=Eh;function bh(e){e.match("/__layer0__/cache-manifest.js",({cache:t,setResponseHeader:r,send:n,allowCors:i})=>{t({edge:{maxAgeSeconds:60*60*24*365},browser:{maxAgeSeconds:60*60}}),r("content-type","text/javascript"),i(),n(()=>`self.__LAYER0_CACHE_MANIFEST__=${Rh.default(e).toJSON()}`)})}});var ia=h(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});var Sh=new Set(["cache","setRequestHeader","updateRequestHeader","removeRequestHeader","setResponseHeader","updateResponseHeader","removeResponseHeader","setUpstreamResponseHeader","updateUpstreamResponseHeader","removeUpstreamResponseHeader","addResponseCookie","updateResponseCookie","removeResponseCookie","addUpstreamResponseCookie","updateUpstreamResponseCookie","removeUpstreamResponseCookie"]),Ch=e=>{let t=(r,n)=>async function(...i){if(!!r.runningImmediately)return await r[n](...i)}.bind(r);return new Proxy(e,{get:(r,n)=>n==="serveStatic"?Ah(r,r.serveStatic):Sh.has(n.toString())?t(r,n):r[n]})};cs.default={create:Ch};function Ah(e,t){return async(r,n={})=>{if(e.runningImmediately)return t.call(e,r,n);if(n.onNotFound)e.setCreateResponseAction(()=>e.runImmediately(()=>n.onNotFound(e)));else throw new Error("Should not get to serveStatic without onNotFound when running behind the edge.")}}});var Yr=h(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});function wh(e,t){let r=e,n=t.split(".");for(let i of n){if(typeof r=="undefined")return;r=r[i]}return r}ls.default=wh});var oa=h(Lt=>{"use strict";var xh=Lt&&Lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lt,"__esModule",{value:!0});var Th=xh(Yr());function Ph(e,t){return!!Th.default(e,t)}Lt.default=Ph});var la=h((KR,ca)=>{"use strict";var Oh=function(t){return Hh(t)&&!Dh(t)};function Hh(e){return!!e&&typeof e=="object"}function Dh(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||Ih(e)}var qh=typeof Symbol=="function"&&Symbol.for,Mh=qh?Symbol.for("react.element"):60103;function Ih(e){return e.$$typeof===Mh}function Nh(e){return Array.isArray(e)?[]:{}}function $t(e,t){return t.clone!==!1&&t.isMergeableObject(e)?et(Nh(e),e,t):e}function jh(e,t,r){return e.concat(t).map(function(n){return $t(n,r)})}function Lh(e,t){if(!t.customMerge)return et;var r=t.customMerge(e);return typeof r=="function"?r:et}function $h(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return e.propertyIsEnumerable(t)}):[]}function aa(e){return Object.keys(e).concat($h(e))}function ua(e,t){try{return t in e}catch(r){return!1}}function Fh(e,t){return ua(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function kh(e,t,r){var n={};return r.isMergeableObject(e)&&aa(e).forEach(function(i){n[i]=$t(e[i],r)}),aa(t).forEach(function(i){Fh(e,i)||(ua(e,i)&&r.isMergeableObject(t[i])?n[i]=Lh(i,r)(e[i],t[i],r):n[i]=$t(t[i],r))}),n}function et(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||jh,r.isMergeableObject=r.isMergeableObject||Oh,r.cloneUnlessOtherwiseSpecified=$t;var n=Array.isArray(t),i=Array.isArray(e),s=n===i;return s?n?r.arrayMerge(e,t,r):kh(e,t,r):$t(t,r)}et.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,i){return et(n,i,r)},{})};var Bh=et;ca.exports=Bh});var ga=h(Ft=>{"use strict";var Uh=Ft&&Ft.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ft,"__esModule",{value:!0});var fa=require("os"),zr=H(),Wh=Xe(),Gh=Uh(ie()),fs={$id:"/domainOrIpSchema",type:"string"},da={$id:"/backendObjectSchema",type:"object",properties:{domainOrIp:{$ref:fs.$id},port:{type:"number",minimum:1,maximum:65535},hostHeader:{type:"string"},disableCheckCert:{type:"boolean"},firstByteTimeout:{type:"number"},basePath:{type:"string"}},additionalProperties:!1,required:["domainOrIp"]},ha={$id:"/backendSchema",type:"object",patternProperties:{"^.*$":{oneOf:[{$ref:fs.$id},{$ref:da.$id}]}}},pa={$id:"/layer0FileConfigurationSchema",type:"object",properties:{prerenderConcurrency:{type:"number"},production:{type:"boolean"},routes:{type:"string"},server:{type:"object",required:["path"],properties:{path:{type:"string"},export:{type:"string"}}},includeFiles:{type:"object"},sources:{type:"array",items:{type:"string"}},backends:{$ref:ha.$id},includeNodeModules:{type:"boolean"},connector:{type:"string"}},additionalProperties:!1,required:[]},ya=class{static validateLayer0FileConfiguration(t){var r;if(Wh.isCloud())return t;let n=Gh.default("ajv"),i=new n({allErrors:!0,schemas:[pa,ha,da,fs]}),s=[],o=i.getSchema(pa.$id);if(((r=t.backends)===null||r===void 0?void 0:r.moov)!=null&&s.push({message:"is a reserved backend name",dataPath:".backends['moov']"}),t.backends&&t.backends[zr.BACKENDS.static]&&s.push({message:"is a reserved backend name",dataPath:`.backends.${zr.BACKENDS.static}`}),t.backends&&t.backends[zr.BACKENDS.js]&&s.push({message:"is a reserved backend name",dataPath:`.backends.${zr.BACKENDS.js}`}),!o(t)&&o.errors&&(s=[...s,...o.errors]),s.length){let a=s.map((u,c)=>{let l=`${c+1}) config${u.dataPath}: ${u.message}`;return u.keyword==="additionalProperties"&&(l+=` '${u.params.additionalProperty}'`),l}).join(fa.EOL);throw new Error(`Layer0 configuration validation failed with errors: ${fa.EOL}${a}`)}return t}};Ft.default=ya});var Oe=h(Ut=>{"use strict";var kt=Ut&&Ut.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ut,"__esModule",{value:!0});var Vh=kt(Yr()),Yh=kt(oa()),zh=kt(la()),ma=require("fs"),ds=require("path"),Bt=H(),Kh=kt(ga()),Qh=kt(ie()),va=class{constructor(){this.defaults={production:!0,backends:{},includeNodeModules:!1,routes:["routes.js","routes.ts"].find(t=>ma.existsSync(ds.join(process.cwd(),t)))||"routes.js"}}get(t,r){if(this.has(t))return Vh.default(this.values,t);if(typeof r!="undefined")return r;throw new Error(`Layer0 configuration key: "${t}" is not defined`)}has(t){return this.values||this.loadLayer0Config(),Yh.default(this.values,t)}get all(){return this.values||this.loadLayer0Config(),this.values}loadLayer0Config(){let t=this.loadFromFile(),r=this.loadFromEnv();this.values=zh.default.all([{},this.defaults,t,r])}loadFromFile(){let t=[ds.join(process.cwd(),Bt.LAYER0_CONFIG_FILE),ds.join(process.cwd(),Bt.LAYER0_CONFIG_FILE.replace(".js",".cjs"))].find(ma.existsSync);if(t)try{let r=Qh.default(t);return Kh.default.validateLayer0FileConfiguration(r)}catch(r){throw new Error(`Failed to load ${t}: ${r.message}`)}return{}}loadFromEnv(){if(process.env[Bt.LAYER0_ENV_VARIABLES.config])try{return JSON.parse(process.env[Bt.LAYER0_ENV_VARIABLES.config])}catch(t){throw new Error(`Layer0 configuration variable: ${Bt.LAYER0_ENV_VARIABLES.config}, is not parsable as json`)}return{}}};Ut.default=new va});var Qr=h(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});function Jh(e){return`${e.ignoreCase?"(?i)":""}${e.source}`.replace(/\\\//g,"/")}Kr.default=Jh;function Xh(e){let t=e.indexOf("(?i)")===0;return t&&(e=e.slice("(?i)".length)),new RegExp(e.replace(/\//g,"/"),t?"i":"")}Kr.fromEdgeRegex=Xh});var _a=h(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});function Zh(e){return new RegExp(`^${e}$`,"i")}hs.default=Zh});var Ea=h(Wt=>{"use strict";var ep=Wt&&Wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wt,"__esModule",{value:!0});var Ra=ep(Qr());function tp(e){let t;return e===null?t=null:typeof e=="string"?t=Ra.default(new RegExp(`^${e}$`,"i")):t=Ra.default(e),t}Wt.default=tp});var Jr=h(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.default=(e,t)=>{let r=e;if(/(^|[^$]){/.test(e))throw new Error(`{variable} syntax in the path option is no longer supported, use :variable instead (${e})`);for(let n in t){let i=t[n];Array.isArray(i)&&(i=i.join("/")),r=r.replace(new RegExp(`:${n}(\\([^)]*\\))?[?*]?`,"g"),i===void 0?"":i)}return r=r.replace(/:\w+(\*|\?)?/,""),r=r.replace("\\?","?"),r=r.replace(/\/+/g,"/").replace(/^([^:]+:)\//gi,"$1//"),r}});var Xr=h(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.pathToRegexp=j.tokensToRegexp=j.regexpToFunction=j.match=j.tokensToFunction=j.compile=j.parse=void 0;function rp(e){for(var t=[],r=0;r<e.length;){var n=e[r];if(n==="*"||n==="+"||n==="?"){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if(n==="\\"){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if(n==="{"){t.push({type:"OPEN",index:r,value:e[r++]});continue}if(n==="}"){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(n===":"){for(var i="",s=r+1;s<e.length;){var o=e.charCodeAt(s);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||o===95){i+=e[s++];continue}break}if(!i)throw new TypeError("Missing parameter name at "+r);t.push({type:"NAME",index:r,value:i}),r=s;continue}if(n==="("){var a=1,u="",s=r+1;if(e[s]==="?")throw new TypeError('Pattern cannot start with "?" at '+s);for(;s<e.length;){if(e[s]==="\\"){u+=e[s++]+e[s++];continue}if(e[s]===")"){if(a--,a===0){s++;break}}else if(e[s]==="("&&(a++,e[s+1]!=="?"))throw new TypeError("Capturing groups are not allowed at "+s);u+=e[s++]}if(a)throw new TypeError("Unbalanced pattern at "+r);if(!u)throw new TypeError("Missing pattern at "+r);t.push({type:"PATTERN",index:r,value:u}),r=s;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}function ys(e,t){t===void 0&&(t={});for(var r=rp(e),n=t.prefixes,i=n===void 0?"./":n,s="[^"+tt(t.delimiter||"/#?")+"]+?",o=[],a=0,u=0,c="",l=function(w){if(u<r.length&&r[u].type===w)return r[u++].value},f=function(w){var G=l(w);if(G!==void 0)return G;var ue=r[u],ce=ue.type,J=ue.index;throw new TypeError("Unexpected "+ce+" at "+J+", expected "+w)},d=function(){for(var w="",G;G=l("CHAR")||l("ESCAPED_CHAR");)w+=G;return w};u<r.length;){var p=l("CHAR"),y=l("NAME"),m=l("PATTERN");if(y||m){var g=p||"";i.indexOf(g)===-1&&(c+=g,g=""),c&&(o.push(c),c=""),o.push({name:y||a++,prefix:g,suffix:"",pattern:m||s,modifier:l("MODIFIER")||""});continue}var R=p||l("ESCAPED_CHAR");if(R){c+=R;continue}c&&(o.push(c),c="");var x=l("OPEN");if(x){var g=d(),U=l("NAME")||"",P=l("PATTERN")||"",ee=d();f("CLOSE"),o.push({name:U||(P?a++:""),pattern:U&&!P?s:P,prefix:g,suffix:ee,modifier:l("MODIFIER")||""});continue}f("END")}return o}j.parse=ys;function np(e,t){return ba(ys(e,t),t)}j.compile=np;function ba(e,t){t===void 0&&(t={});var r=gs(t),n=t.encode,i=n===void 0?function(u){return u}:n,s=t.validate,o=s===void 0?!0:s,a=e.map(function(u){if(typeof u=="object")return new RegExp("^(?:"+u.pattern+")$",r)});return function(u){for(var c="",l=0;l<e.length;l++){var f=e[l];if(typeof f=="string"){c+=f;continue}var d=u?u[f.name]:void 0,p=f.modifier==="?"||f.modifier==="*",y=f.modifier==="*"||f.modifier==="+";if(Array.isArray(d)){if(!y)throw new TypeError('Expected "'+f.name+'" to not repeat, but got an array');if(d.length===0){if(p)continue;throw new TypeError('Expected "'+f.name+'" to not be empty')}for(var m=0;m<d.length;m++){var g=i(d[m],f);if(o&&!a[l].test(g))throw new TypeError('Expected all "'+f.name+'" to match "'+f.pattern+'", but got "'+g+'"');c+=f.prefix+g+f.suffix}continue}if(typeof d=="string"||typeof d=="number"){var g=i(String(d),f);if(o&&!a[l].test(g))throw new TypeError('Expected "'+f.name+'" to match "'+f.pattern+'", but got "'+g+'"');c+=f.prefix+g+f.suffix;continue}if(!p){var R=y?"an array":"a string";throw new TypeError('Expected "'+f.name+'" to be '+R)}}return c}}j.tokensToFunction=ba;function sp(e,t){var r=[],n=ms(e,r,t);return Sa(n,r,t)}j.match=sp;function Sa(e,t,r){r===void 0&&(r={});var n=r.decode,i=n===void 0?function(s){return s}:n;return function(s){var o=e.exec(s);if(!o)return!1;for(var a=o[0],u=o.index,c=Object.create(null),l=function(d){if(o[d]===void 0)return"continue";var p=t[d-1];p.modifier==="*"||p.modifier==="+"?c[p.name]=o[d].split(p.prefix+p.suffix).map(function(y){return i(y,p)}):c[p.name]=i(o[d],p)},f=1;f<o.length;f++)l(f);return{path:a,index:u,params:c}}}j.regexpToFunction=Sa;function tt(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function gs(e){return e&&e.sensitive?"":"i"}function ip(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,i=r.exec(e.source);i;)t.push({name:i[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),i=r.exec(e.source);return e}function op(e,t,r){var n=e.map(function(i){return ms(i,t,r).source});return new RegExp("(?:"+n.join("|")+")",gs(r))}function ap(e,t,r){return Ca(ys(e,r),t,r)}function Ca(e,t,r){r===void 0&&(r={});for(var n=r.strict,i=n===void 0?!1:n,s=r.start,o=s===void 0?!0:s,a=r.end,u=a===void 0?!0:a,c=r.encode,l=c===void 0?function(w){return w}:c,f="["+tt(r.endsWith||"")+"]|$",d="["+tt(r.delimiter||"/#?")+"]",p=o?"^":"",y=0,m=e;y<m.length;y++){var g=m[y];if(typeof g=="string")p+=tt(l(g));else{var R=tt(l(g.prefix)),x=tt(l(g.suffix));if(g.pattern)if(t&&t.push(g),R||x)if(g.modifier==="+"||g.modifier==="*"){var U=g.modifier==="*"?"?":"";p+="(?:"+R+"((?:"+g.pattern+")(?:"+x+R+"(?:"+g.pattern+"))*)"+x+")"+U}else p+="(?:"+R+"("+g.pattern+")"+x+")"+g.modifier;else p+="("+g.pattern+")"+g.modifier;else p+="(?:"+R+x+")"+g.modifier}}if(u)i||(p+=d+"?"),p+=r.endsWith?"(?="+f+")":"$";else{var P=e[e.length-1],ee=typeof P=="string"?d.indexOf(P[P.length-1])>-1:P===void 0;i||(p+="(?:"+d+"(?="+f+"))?"),ee||(p+="(?="+d+"|"+f+")")}return new RegExp(p,gs(r))}j.tokensToRegexp=Ca;function ms(e,t,r){return e instanceof RegExp?ip(e,t):Array.isArray(e)?op(e,t,r):ap(e,t,r)}j.pathToRegexp=ms});var wa=h(rt=>{"use strict";var up=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rt,"__esModule",{value:!0});var cp=up(Jr()),lp=Xr();function fp(e,t){if(e==null)return t;let r=Aa(e);return cp.default(t,r)}rt.default=fp;function Aa(e){if(!e)return{};let t=e.match(/https?:\/\/[^/]+(.*)/);t&&(e=`/${t[1]}`);let r=1,n={};return lp.parse(e).forEach(i=>{typeof i!="string"&&(n[i.name]=`\\${r++}`)}),n}rt.getBackReferences=Aa});var xa=h(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});function dp(e){return e?typeof e.length=="number"?!e.length:!(typeof e=="object"&&Object.keys(e).length):!0}vs.default=dp});var Pa=h(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});var Ta=class extends Error{constructor(t){super(t.message);this.type="BackendFetchError",this.cause=t}};_s.default=Ta});var bs=h(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});var Rs="__";function hp(e,t){let r=new URL(e,`https://${Rs}`).searchParams,n=new URL(t,`https://${Rs}`);return r.forEach((i,s)=>{n.searchParams.get(s)||n.searchParams.set(s,i)}),n.hostname===Rs?`${n.pathname}${n.search}`:n.toString()}Es.default=hp});var qa=h(Gt=>{"use strict";var Zr=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gt,"__esModule",{value:!0});var pp=require("url"),Oa=Zr(require("https")),yp=Zr(require("http")),Ha=require("path"),gp=Zr(Pa()),mp=Zr(bs()),vp=H(),_p=["transfer-encoding","content-length"],Da=class{constructor(t){this.config=t}async fetch(t,r,n){let{path:i,headers:s}=n||{},o=this.getProxyTarget(t,i),a=this.getProxyRequestOptions(o,t,s);return new Promise((u,c)=>{let f=(o.protocol==="https:"?Oa.default:yp.default).request(a,d=>{let p=[];d.on("data",y=>p.push(y)).on("end",()=>{Object.entries(d.headers).filter(([y])=>!_p.includes(y.toLowerCase())).forEach(([y,m])=>{try{r.setHeader(y,m)}catch(g){console.warn(`Could not relay upstream response header ${y} with value ${m}`,g)}}),r.statusCode=d.statusCode,r.statusMessage=d.statusMessage,r.body=Buffer.concat(p),u(void 0)})});f.on("error",d=>c(new gp.default(d))),f.end(t.body)})}getProxyTarget(t,r){let n=r?mp.default(t.url,r):t.url,{domainOrIp:i,basePath:s,port:o}=this.config;if(s&&(n=Ha.join(s,n)),i){let a=i.match(/^127.0.0.1(:\d+)?$/)?"http":"https",u=`${i}${o?`:${o}`:""}`;n=`${a}://${Ha.join(u,n)}`}return pp.parse(n,!0)}isLocal(t){return t.hostname===vp.JS_BACKEND_HOSTNAME}getProxyRequestOptions(t,r,n){let i=null;this.config.disableCheckCert&&t.protocol==="https:"&&(i=new Oa.default.Agent({rejectUnauthorized:!1}));let s=O(S(S({},r.headers),n),{host:this.config.hostHeader||r.headers.host});return this.isLocal(t)&&(s["x-forwarded-proto"]=r.secure?"https":"http"),O(S({},t),{method:r.method,timeout:this.config.firstByteTimeout||0,agent:i,body:r.body,headers:s})}};Gt.default=Da});var tn=h(Ss=>{"use strict";Ss.parse=Sp;Ss.serialize=Cp;var Rp=decodeURIComponent,Ep=encodeURIComponent,bp=/; */,en=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Sp(e,t){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var r={},n=t||{},i=e.split(bp),s=n.decode||Rp,o=0;o<i.length;o++){var a=i[o],u=a.indexOf("=");if(!(u<0)){var c=a.substr(0,u).trim(),l=a.substr(++u,a.length).trim();l[0]=='"'&&(l=l.slice(1,-1)),r[c]==null&&(r[c]=Ap(l,s))}}return r}function Cp(e,t,r){var n=r||{},i=n.encode||Ep;if(typeof i!="function")throw new TypeError("option encode is invalid");if(!en.test(e))throw new TypeError("argument name is invalid");var s=i(t);if(s&&!en.test(s))throw new TypeError("argument val is invalid");var o=e+"="+s;if(n.maxAge!=null){var a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(n.domain){if(!en.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!en.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.sameSite){var u=typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite;switch(u){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o}function Ap(e,t){try{return t(e)}catch(r){return e}}});var Ma=h(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});function wp(e){return e}Cs.default=wp});var As=h(Vt=>{"use strict";var Ia=Vt&&Vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vt,"__esModule",{value:!0});var xp=Ia(tn()),Tp=require("querystring"),Pp=Ia(Ma());function Na(e,t,r){if(typeof r=="string")return Op(e,t,r);if(!Array.isArray(r))return r;let n=[];return r.forEach(i=>{n.push(Na(e,t,i))}),n}Vt.default=Na;function Op(e,t,r){let n=r.replace(/\\\${/g,"--backslashdollar--").replace(/\${/g,"--separator--${").split("--separator--"),i={};(e==null?void 0:e.headers.cookie)&&(i=xp.default.parse(e.headers.cookie,{decode:Pp.default}));let s={};if(e==null?void 0:e.url){let c=e.url.indexOf("?");if(c>=0){let l=e.url.substring(c+1);s=Tp.parse(l)}}let o=[],a="${req:".length,u="${query:".length;return n.forEach(c=>{if(e){c=c.replace(/\${method}/,e.method),c=c.replace(/\${path}/,e.path),c=c.replace(/\${url}/,e.url);let f=c.search(/\${query:/);if(f>=0){let p=c.substring(f+u),y=p.indexOf("}");if(y<=0)throw new Error(`Cannot interpolate substring "${c}" of value "${r}" (1)`);p=p.substring(0,y);let m=s[p]||"";Array.isArray(m)&&(m=m[0]),c=c.replace(/\${query:.*?}/,m)}let d=c.search(/\${req:/);if(d>=0){let p=c.substring(d+a),y=p.indexOf("}");if(y<=0)throw new Error(`Cannot interpolate substring "${c}" of value "${r}" (2)`);p=p.substring(0,y);let m="";if(p.indexOf("cookie:")===0){let g=p.split(":")[1];m=i[g]||""}else m=e.headers[p]||"";c=c.replace(/\${req:.*?}/,m)}}let l=c.search(/\${res:/);if(l>=0){if(!t)throw new Error(`Cannot interpolate response parameter "${c}" during receive phase`);let f=c.substring(l+a),d=f.indexOf("}");if(d<=0)throw new Error(`Cannot interpolate substring "${c}" of value "${r}" (3)`);f=f.substring(0,d),c=c.replace(/\${res:.*?}/,t.getHeader(f)||"")}if(c.search(/\${/)>=0)throw new Error(`Cannot interpolate substring "${c}" of "${r}" (4)`);o.push(c)}),o.join("").replace(/--backslashdollar--/g,"${")}});var La=h((fE,ws)=>{"use strict";var Hp=Object.prototype.hasOwnProperty,W="~";function Yt(){}Object.create&&(Yt.prototype=Object.create(null),new Yt().__proto__||(W=!1));function Dp(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function ja(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new Dp(r,n||e,i),o=W?W+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],s]:e._events[o].push(s):(e._events[o]=s,e._eventsCount++),e}function rn(e,t){--e._eventsCount==0?e._events=new Yt:delete e._events[t]}function L(){this._events=new Yt,this._eventsCount=0}L.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)Hp.call(r,n)&&t.push(W?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};L.prototype.listeners=function(t){var r=W?W+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o};L.prototype.listenerCount=function(t){var r=W?W+t:t,n=this._events[r];return n?n.fn?1:n.length:0};L.prototype.emit=function(t,r,n,i,s,o){var a=W?W+t:t;if(!this._events[a])return!1;var u=this._events[a],c=arguments.length,l,f;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,r),!0;case 3:return u.fn.call(u.context,r,n),!0;case 4:return u.fn.call(u.context,r,n,i),!0;case 5:return u.fn.call(u.context,r,n,i,s),!0;case 6:return u.fn.call(u.context,r,n,i,s,o),!0}for(f=1,l=new Array(c-1);f<c;f++)l[f-1]=arguments[f];u.fn.apply(u.context,l)}else{var d=u.length,p;for(f=0;f<d;f++)switch(u[f].once&&this.removeListener(t,u[f].fn,void 0,!0),c){case 1:u[f].fn.call(u[f].context);break;case 2:u[f].fn.call(u[f].context,r);break;case 3:u[f].fn.call(u[f].context,r,n);break;case 4:u[f].fn.call(u[f].context,r,n,i);break;default:if(!l)for(p=1,l=new Array(c-1);p<c;p++)l[p-1]=arguments[p];u[f].fn.apply(u[f].context,l)}}return!0};L.prototype.on=function(t,r,n){return ja(this,t,r,n,!1)};L.prototype.once=function(t,r,n){return ja(this,t,r,n,!0)};L.prototype.removeListener=function(t,r,n,i){var s=W?W+t:t;if(!this._events[s])return this;if(!r)return rn(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&rn(this,s);else{for(var a=0,u=[],c=o.length;a<c;a++)(o[a].fn!==r||i&&!o[a].once||n&&o[a].context!==n)&&u.push(o[a]);u.length?this._events[s]=u.length===1?u[0]:u:rn(this,s)}return this};L.prototype.removeAllListeners=function(t){var r;return t?(r=W?W+t:t,this._events[r]&&rn(this,r)):(this._events=new Yt,this._eventsCount=0),this};L.prototype.off=L.prototype.removeListener;L.prototype.addListener=L.prototype.on;L.prefixed=W;L.EventEmitter=L;typeof ws!="undefined"&&(ws.exports=L)});var Fa=h((dE,$a)=>{"use strict";$a.exports=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var nn=h(Ba=>{var fe=Ba,qp=require("url"),ka=require("util")._extend,Mp=Fa(),Ip=/(^|,)\s*upgrade\s*($|,)/i,xs=/^https|wss/;fe.isSSL=xs;fe.setupOutgoing=function(e,t,r,n){e.port=t[n||"target"].port||(xs.test(t[n||"target"].protocol)?443:80),["host","hostname","socketPath","pfx","key","passphrase","cert","ca","ciphers","secureProtocol"].forEach(function(a){e[a]=t[n||"target"][a]}),e.method=t.method||r.method,e.headers=ka({},r.headers),t.headers&&ka(e.headers,t.headers),t.auth&&(e.auth=t.auth),t.ca&&(e.ca=t.ca),xs.test(t[n||"target"].protocol)&&(e.rejectUnauthorized=typeof t.secure=="undefined"?!0:t.secure),e.agent=t.agent||!1,e.localAddress=t.localAddress,e.agent||(e.headers=e.headers||{},(typeof e.headers.connection!="string"||!Ip.test(e.headers.connection))&&(e.headers.connection="close"));var i=t[n||"target"],s=i&&t.prependPath!==!1&&i.path||"",o=t.toProxy?r.url:qp.parse(r.url).path||"";return o=t.ignorePath?"":o,e.path=fe.urlJoin(s,o),t.changeOrigin&&(e.headers.host=Mp(e.port,t[n||"target"].protocol)&&!Np(e.host)?e.host+":"+e.port:e.host),e};fe.setupSocket=function(e){return e.setTimeout(0),e.setNoDelay(!0),e.setKeepAlive(!0,0),e};fe.getPort=function(e){var t=e.headers.host?e.headers.host.match(/:(\d+)/):"";return t?t[1]:fe.hasEncryptedConnection(e)?"443":"80"};fe.hasEncryptedConnection=function(e){return Boolean(e.connection.encrypted||e.connection.pair)};fe.urlJoin=function(){var e=Array.prototype.slice.call(arguments),t=e.length-1,r=e[t],n=r.split("?"),i;return e[t]=n.shift(),i=[e.filter(Boolean).join("/").replace(/\/+/g,"/").replace("http:/","http://").replace("https:/","https://")],i.push.apply(i,n),i.join("?")};fe.rewriteCookieProperty=function e(t,r,n){return Array.isArray(t)?t.map(function(i){return e(i,r,n)}):t.replace(new RegExp("(;\\s*"+n+"=)([^;]+)","i"),function(i,s,o){var a;if(o in r)a=r[o];else if("*"in r)a=r["*"];else return i;return a?s+a:""})};function Np(e){return!!~e.indexOf(":")}});var Va=h((pE,Ga)=>{var Ua=require("url"),Wa=nn(),jp=/^201|30(1|2|7|8)$/;Ga.exports={removeChunked:function(t,r,n){t.httpVersion==="1.0"&&delete n.headers["transfer-encoding"]},setConnection:function(t,r,n){t.httpVersion==="1.0"?n.headers.connection=t.headers.connection||"close":t.httpVersion!=="2.0"&&!n.headers.connection&&(n.headers.connection=t.headers.connection||"keep-alive")},setRedirectHostRewrite:function(t,r,n,i){if((i.hostRewrite||i.autoRewrite||i.protocolRewrite)&&n.headers.location&&jp.test(n.statusCode)){var s=Ua.parse(i.target),o=Ua.parse(n.headers.location);if(s.host!=o.host)return;i.hostRewrite?o.host=i.hostRewrite:i.autoRewrite&&(o.host=t.headers.host),i.protocolRewrite&&(o.protocol=i.protocolRewrite),n.headers.location=o.format()}},writeHeaders:function(t,r,n,i){var s=i.cookieDomainRewrite,o=i.cookiePathRewrite,a=i.preserveHeaderKeyCase,u,c=function(d,p){p!=null&&(s&&d.toLowerCase()==="set-cookie"&&(p=Wa.rewriteCookieProperty(p,s,"domain")),o&&d.toLowerCase()==="set-cookie"&&(p=Wa.rewriteCookieProperty(p,o,"path")),r.setHeader(String(d).trim(),p))};if(typeof s=="string"&&(s={"*":s}),typeof o=="string"&&(o={"*":o}),a&&n.rawHeaders!=null){u={};for(var l=0;l<n.rawHeaders.length;l+=2){var f=n.rawHeaders[l];u[f.toLowerCase()]=f}}Object.keys(n.headers).forEach(function(d){var p=n.headers[d];a&&u&&(d=u[d]||d),c(d,p)})},writeStatusCode:function(t,r,n){n.statusMessage?(r.statusCode=n.statusCode,r.statusMessage=n.statusMessage):r.statusCode=n.statusCode}}});var za=h((yE,Ya)=>{var nt=1e3,st=nt*60,it=st*60,He=it*24,Lp=He*7,$p=He*365.25;Ya.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Fp(e);if(r==="number"&&isFinite(e))return t.long?Bp(e):kp(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Fp(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*$p;case"weeks":case"week":case"w":return r*Lp;case"days":case"day":case"d":return r*He;case"hours":case"hour":case"hrs":case"hr":case"h":return r*it;case"minutes":case"minute":case"mins":case"min":case"m":return r*st;case"seconds":case"second":case"secs":case"sec":case"s":return r*nt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function kp(e){var t=Math.abs(e);return t>=He?Math.round(e/He)+"d":t>=it?Math.round(e/it)+"h":t>=st?Math.round(e/st)+"m":t>=nt?Math.round(e/nt)+"s":e+"ms"}function Bp(e){var t=Math.abs(e);return t>=He?sn(e,t,He,"day"):t>=it?sn(e,t,it,"hour"):t>=st?sn(e,t,st,"minute"):t>=nt?sn(e,t,nt,"second"):e+" ms"}function sn(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var Ts=h((gE,Ka)=>{function Up(e){r.debug=r,r.default=r,r.coerce=u,r.disable=s,r.enable=i,r.enabled=o,r.humanize=za(),r.destroy=c,Object.keys(e).forEach(l=>{r[l]=e[l]}),r.names=[],r.skips=[],r.formatters={};function t(l){let f=0;for(let d=0;d<l.length;d++)f=(f<<5)-f+l.charCodeAt(d),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(l){let f,d=null,p,y;function m(...g){if(!m.enabled)return;let R=m,x=Number(new Date),U=x-(f||x);R.diff=U,R.prev=f,R.curr=x,f=x,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let P=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(w,G)=>{if(w==="%%")return"%";P++;let ue=r.formatters[G];if(typeof ue=="function"){let ce=g[P];w=ue.call(R,ce),g.splice(P,1),P--}return w}),r.formatArgs.call(R,g),(R.log||r.log).apply(R,g)}return m.namespace=l,m.useColors=r.useColors(),m.color=r.selectColor(l),m.extend=n,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==r.namespaces&&(p=r.namespaces,y=r.enabled(l)),y),set:g=>{d=g}}),typeof r.init=="function"&&r.init(m),m}function n(l,f){let d=r(this.namespace+(typeof f=="undefined"?":":f)+l);return d.log=this.log,d}function i(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,d=(typeof l=="string"?l:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)!d[f]||(l=d[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.substr(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let f,d;for(f=0,d=r.skips.length;f<d;f++)if(r.skips[f].test(l))return!1;for(f=0,d=r.names.length;f<d;f++)if(r.names[f].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function u(l){return l instanceof Error?l.stack||l.message:l}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Ka.exports=Up});var Qa=h((Y,on)=>{Y.formatArgs=Gp;Y.save=Vp;Y.load=Yp;Y.useColors=Wp;Y.storage=zp();Y.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Y.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Wp(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Gp(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+on.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}Y.log=console.debug||console.log||(()=>{});function Vp(e){try{e?Y.storage.setItem("debug",e):Y.storage.removeItem("debug")}catch(t){}}function Yp(){let e;try{e=Y.storage.getItem("debug")}catch(t){}return!e&&typeof process!="undefined"&&"env"in process&&(e=process.env.DEBUG),e}function zp(){try{return localStorage}catch(e){}}on.exports=Ts()(Y);var{formatters:Kp}=on.exports;Kp.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Xa=h((mE,Ja)=>{"use strict";Ja.exports=(e,t)=>{t=t||process.argv;let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return n!==-1&&(i===-1?!0:n<i)}});var eu=h((vE,Za)=>{"use strict";var Qp=require("os"),re=Xa(),$=process.env,ot;re("no-color")||re("no-colors")||re("color=false")?ot=!1:(re("color")||re("colors")||re("color=true")||re("color=always"))&&(ot=!0);"FORCE_COLOR"in $&&(ot=$.FORCE_COLOR.length===0||parseInt($.FORCE_COLOR,10)!==0);function Jp(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function Xp(e){if(ot===!1)return 0;if(re("color=16m")||re("color=full")||re("color=truecolor"))return 3;if(re("color=256"))return 2;if(e&&!e.isTTY&&ot!==!0)return 0;let t=ot?1:0;if(process.platform==="win32"){let r=Qp.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in $)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in $)||$.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in $)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test($.TEAMCITY_VERSION)?1:0;if($.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in $){let r=parseInt(($.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch($.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test($.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test($.TERM)||"COLORTERM"in $?1:($.TERM==="dumb",t)}function Ps(e){let t=Xp(e);return Jp(t)}Za.exports={supportsColor:Ps,stdout:Ps(process.stdout),stderr:Ps(process.stderr)}});var ru=h((N,un)=>{var Zp=require("tty"),an=require("util");N.init=oy;N.log=ny;N.formatArgs=ty;N.save=sy;N.load=iy;N.useColors=ey;N.destroy=an.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");N.colors=[6,2,3,4,5,1];try{let e=eu();e&&(e.stderr||e).level>=2&&(N.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}N.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(i,s)=>s.toUpperCase()),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function ey(){return"colors"in N.inspectOpts?Boolean(N.inspectOpts.colors):Zp.isatty(process.stderr.fd)}function ty(e){let{namespace:t,useColors:r}=this;if(r){let n=this.color,i="[3"+(n<8?n:"8;5;"+n),s=`  ${i};1m${t} [0m`;e[0]=s+e[0].split(`
`).join(`
`+s),e.push(i+"m+"+un.exports.humanize(this.diff)+"[0m")}else e[0]=ry()+t+" "+e[0]}function ry(){return N.inspectOpts.hideDate?"":new Date().toISOString()+" "}function ny(...e){return process.stderr.write(an.format(...e)+`
`)}function sy(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function iy(){return process.env.DEBUG}function oy(e){e.inspectOpts={};let t=Object.keys(N.inspectOpts);for(let r=0;r<t.length;r++)e.inspectOpts[t[r]]=N.inspectOpts[t[r]]}un.exports=Ts()(N);var{formatters:tu}=un.exports;tu.o=function(e){return this.inspectOpts.colors=this.useColors,an.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};tu.O=function(e){return this.inspectOpts.colors=this.useColors,an.inspect(e,this.inspectOpts)}});var nu=h((_E,Os)=>{typeof process=="undefined"||process.type==="renderer"||process.browser===!0||process.__nwjs?Os.exports=Qa():Os.exports=ru()});var iu=h((RE,su)=>{var zt;su.exports=function(){if(!zt){try{zt=nu()("follow-redirects")}catch(e){}typeof zt!="function"&&(zt=function(){})}zt.apply(null,arguments)}});var fu=h((EE,Ms)=>{var at=require("url"),Hs=at.URL,ay=require("http"),uy=require("https"),ou=require("stream").Writable,cy=require("assert"),au=iu(),De=["abort","aborted","connect","error","socket","timeout"],Ds=Object.create(null);De.forEach(function(e){Ds[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}});var ly=cn("ERR_FR_REDIRECTION_FAILURE",""),fy=cn("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),dy=cn("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),hy=cn("ERR_STREAM_WRITE_AFTER_END","write after end");function z(e,t){ou.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(n){r._processResponse(n)},this._performRequest()}z.prototype=Object.create(ou.prototype);z.prototype.abort=function(){lu(this._currentRequest),this.emit("abort")};z.prototype.write=function(e,t,r){if(this._ending)throw new hy;if(!(typeof e=="string"||typeof e=="object"&&"length"in e))throw new TypeError("data should be a string, Buffer or Uint8Array");if(typeof t=="function"&&(r=t,t=null),e.length===0){r&&r();return}this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new dy),this.abort())};z.prototype.end=function(e,t,r){if(typeof e=="function"?(r=e,e=t=null):typeof t=="function"&&(r=t,t=null),!e)this._ended=this._ending=!0,this._currentRequest.end(null,null,r);else{var n=this,i=this._currentRequest;this.write(e,t,function(){n._ended=!0,i.end(null,null,r)}),this._ending=!0}};z.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)};z.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)};z.prototype.setTimeout=function(e,t){var r=this;t&&this.on("timeout",t);function n(o){o.setTimeout(e),o.removeListener("timeout",o.destroy),o.addListener("timeout",o.destroy)}function i(o){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout(function(){r.emit("timeout"),s()},e),n(o)}function s(){clearTimeout(this._timeout),t&&r.removeListener("timeout",t),this.socket||r._currentRequest.removeListener("socket",i)}return this.socket?i(this.socket):this._currentRequest.once("socket",i),this.on("socket",n),this.once("response",s),this.once("error",s),this};["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach(function(e){z.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}});["aborted","connection","socket"].forEach(function(e){Object.defineProperty(z.prototype,e,{get:function(){return this._currentRequest[e]}})});z.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}};z.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(!t){this.emit("error",new TypeError("Unsupported protocol "+e));return}if(this._options.agents){var r=e.substr(0,e.length-1);this._options.agent=this._options.agents[r]}var n=this._currentRequest=t.request(this._options,this._onNativeResponse);this._currentUrl=at.format(this._options),n._redirectable=this;for(var i=0;i<De.length;i++)n.on(De[i],Ds[De[i]]);if(this._isRedirect){var s=0,o=this,a=this._requestBodyBuffers;(function u(c){if(n===o._currentRequest)if(c)o.emit("error",c);else if(s<a.length){var l=a[s++];n.finished||n.write(l.data,l.encoding,u)}else o._ended&&n.end()})()}};z.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(r&&this._options.followRedirects!==!1&&t>=300&&t<400){if(lu(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects){this.emit("error",new fy);return}((t===301||t===302)&&this._options.method==="POST"||t===303&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],qs(/^content-/i,this._options.headers));var n=qs(/^host$/i,this._options.headers)||at.parse(this._currentUrl).hostname,i=at.resolve(this._currentUrl,r);au("redirecting to",i),this._isRedirect=!0;var s=at.parse(i);if(Object.assign(this._options,s),s.hostname!==n&&qs(/^authorization$/i,this._options.headers),typeof this._options.beforeRedirect=="function"){var o={headers:e.headers};try{this._options.beforeRedirect.call(null,this._options,o)}catch(u){this.emit("error",u);return}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(u){var a=new ly("Redirected request failed: "+u.message);a.cause=u,this.emit("error",a)}}else e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[]};function uu(e){var t={maxRedirects:21,maxBodyLength:10*1024*1024},r={};return Object.keys(e).forEach(function(n){var i=n+":",s=r[i]=e[n],o=t[n]=Object.create(s);function a(c,l,f){if(typeof c=="string"){var d=c;try{c=cu(new Hs(d))}catch(p){c=at.parse(d)}}else Hs&&c instanceof Hs?c=cu(c):(f=l,l=c,c={protocol:i});return typeof l=="function"&&(f=l,l=null),l=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},c,l),l.nativeProtocols=r,cy.equal(l.protocol,i,"protocol mismatch"),au("options",l),new z(l,f)}function u(c,l,f){var d=o.request(c,l,f);return d.end(),d}Object.defineProperties(o,{request:{value:a,configurable:!0,enumerable:!0,writable:!0},get:{value:u,configurable:!0,enumerable:!0,writable:!0}})}),t}function py(){}function cu(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return e.port!==""&&(t.port=Number(e.port)),t}function qs(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return r}function cn(e,t){function r(n){Error.captureStackTrace(this,this.constructor),this.message=n||t}return r.prototype=new Error,r.prototype.constructor=r,r.prototype.name="Error ["+e+"]",r.prototype.code=e,r}function lu(e){for(var t=0;t<De.length;t++)e.removeListener(De[t],Ds[De[t]]);e.on("error",py),e.abort()}Ms.exports=uu({http:ay,https:uy});Ms.exports.wrap=uu});var hu=h((bE,du)=>{var yy=require("http"),gy=require("https"),Kt=Va(),ln=nn(),my=fu();Kt=Object.keys(Kt).map(function(e){return Kt[e]});var vy={http:yy,https:gy};du.exports={deleteLength:function(t,r,n){(t.method==="DELETE"||t.method==="OPTIONS")&&!t.headers["content-length"]&&(t.headers["content-length"]="0",delete t.headers["transfer-encoding"])},timeout:function(t,r,n){n.timeout&&t.socket.setTimeout(n.timeout)},XHeaders:function(t,r,n){if(!!n.xfwd){var i=t.isSpdy||ln.hasEncryptedConnection(t),s={for:t.connection.remoteAddress||t.socket.remoteAddress,port:ln.getPort(t),proto:i?"https":"http"};["for","port","proto"].forEach(function(o){t.headers["x-forwarded-"+o]=(t.headers["x-forwarded-"+o]||"")+(t.headers["x-forwarded-"+o]?",":"")+s[o]}),t.headers["x-forwarded-host"]=t.headers["x-forwarded-host"]||t.headers.host||""}},stream:function(t,r,n,i,s,o){s.emit("start",t,r,n.target||n.forward);var a=n.followRedirects?my:vy,u=a.http,c=a.https;if(n.forward){var l=(n.forward.protocol==="https:"?c:u).request(ln.setupOutgoing(n.ssl||{},n,t,"forward")),f=y(l,n.forward);if(t.on("error",f),l.on("error",f),(n.buffer||t).pipe(l),!n.target)return r.end()}var d=(n.target.protocol==="https:"?c:u).request(ln.setupOutgoing(n.ssl||{},n,t));d.on("socket",function(m){s&&!d.getHeader("expect")&&s.emit("proxyReq",d,t,r,n)}),n.proxyTimeout&&d.setTimeout(n.proxyTimeout,function(){d.abort()}),t.on("aborted",function(){d.abort()});var p=y(d,n.target);t.on("error",p),d.on("error",p);function y(m,g){return function(x){if(t.socket.destroyed&&x.code==="ECONNRESET")return s.emit("econnreset",x,t,r,g),m.abort();o?o(x,t,r,g):s.emit("error",x,t,r,g)}}(n.buffer||t).pipe(d),d.on("response",function(m){if(s&&s.emit("proxyRes",m,t,r),!r.headersSent&&!n.selfHandleResponse)for(var g=0;g<Kt.length&&!Kt[g](t,r,m,n);g++);r.finished?s&&s.emit("end",t,r,m):(m.on("end",function(){s&&s.emit("end",t,r,m)}),n.selfHandleResponse||m.pipe(r))})}}});var yu=h((SE,pu)=>{var _y=require("http"),Ry=require("https"),ut=nn();pu.exports={checkMethodAndHeader:function(t,r){if(t.method!=="GET"||!t.headers.upgrade||t.headers.upgrade.toLowerCase()!=="websocket")return r.destroy(),!0},XHeaders:function(t,r,n){if(!!n.xfwd){var i={for:t.connection.remoteAddress||t.socket.remoteAddress,port:ut.getPort(t),proto:ut.hasEncryptedConnection(t)?"wss":"ws"};["for","port","proto"].forEach(function(s){t.headers["x-forwarded-"+s]=(t.headers["x-forwarded-"+s]||"")+(t.headers["x-forwarded-"+s]?",":"")+i[s]})}},stream:function(t,r,n,i,s,o){var a=function(l,f){return Object.keys(f).reduce(function(d,p){var y=f[p];if(!Array.isArray(y))return d.push(p+": "+y),d;for(var m=0;m<y.length;m++)d.push(p+": "+y[m]);return d},[l]).join(`\r
`)+`\r
\r
`};ut.setupSocket(r),i&&i.length&&r.unshift(i);var u=(ut.isSSL.test(n.target.protocol)?Ry:_y).request(ut.setupOutgoing(n.ssl||{},n,t));return s&&s.emit("proxyReqWs",u,t,r,n,i),u.on("error",c),u.on("response",function(l){l.upgrade||(r.write(a("HTTP/"+l.httpVersion+" "+l.statusCode+" "+l.statusMessage,l.headers)),l.pipe(r))}),u.on("upgrade",function(l,f,d){f.on("error",c),f.on("end",function(){s.emit("close",l,f,d)}),r.on("error",function(){f.end()}),ut.setupSocket(f),d&&d.length&&f.unshift(d),r.write(a("HTTP/1.1 101 Switching Protocols",l.headers)),f.pipe(r).pipe(f),s.emit("open",f),s.emit("proxySocket",f)}),u.end();function c(l){o?o(l,t,r):s.emit("error",l,t,r),r.end()}}}});var bu=h((CE,Eu)=>{var gu=Eu.exports,mu=require("util")._extend,Ey=require("url").parse,vu=La(),by=require("http"),Sy=require("https"),_u=hu(),Ru=yu();gu.Server=qe;function Is(e){return function(t){return function(r,n){var i=e==="ws"?this.wsPasses:this.webPasses,s=[].slice.call(arguments),o=s.length-1,a,u;typeof s[o]=="function"&&(u=s[o],o--);var c=t;if(!(s[o]instanceof Buffer)&&s[o]!==n&&(c=mu({},t),mu(c,s[o]),o--),s[o]instanceof Buffer&&(a=s[o]),["target","forward"].forEach(function(f){typeof c[f]=="string"&&(c[f]=Ey(c[f]))}),!c.target&&!c.forward)return this.emit("error",new Error("Must provide a proper URL as target"));for(var l=0;l<i.length&&!i[l](r,n,c,a,this,u);l++);}}}gu.createRightProxy=Is;function qe(e){vu.call(this),e=e||{},e.prependPath=e.prependPath!==!1,this.web=this.proxyRequest=Is("web")(e),this.ws=this.proxyWebsocketRequest=Is("ws")(e),this.options=e,this.webPasses=Object.keys(_u).map(function(t){return _u[t]}),this.wsPasses=Object.keys(Ru).map(function(t){return Ru[t]}),this.on("error",this.onError,this)}require("util").inherits(qe,vu);qe.prototype.onError=function(e){if(this.listeners("error").length===1)throw e};qe.prototype.listen=function(e,t){var r=this,n=function(i,s){r.web(i,s)};return this._server=this.options.ssl?Sy.createServer(this.options.ssl,n):by.createServer(n),this.options.ws&&this._server.on("upgrade",function(i,s,o){r.ws(i,s,o)}),this._server.listen(e,t),this};qe.prototype.close=function(e){var t=this;this._server&&this._server.close(r);function r(){t._server=null,e&&e.apply(null,arguments)}};qe.prototype.before=function(e,t,r){if(e!=="ws"&&e!=="web")throw new Error("type must be `web` or `ws`");var n=e==="ws"?this.wsPasses:this.webPasses,i=!1;if(n.forEach(function(s,o){s.name===t&&(i=o)}),i===!1)throw new Error("No such pass");n.splice(i,0,r)};qe.prototype.after=function(e,t,r){if(e!=="ws"&&e!=="web")throw new Error("type must be `web` or `ws`");var n=e==="ws"?this.wsPasses:this.webPasses,i=!1;if(n.forEach(function(s,o){s.name===t&&(i=o)}),i===!1)throw new Error("No such pass");n.splice(i++,0,r)}});var Cu=h((AE,Su)=>{var Qt=bu().Server;function Ns(e){return new Qt(e)}Qt.createProxyServer=Ns;Qt.createServer=Ns;Qt.createProxy=Ns;Su.exports=Qt});var wu=h((wE,Au)=>{Au.exports=Cu()});var xu=h(Jt=>{"use strict";var Cy=Jt&&Jt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jt,"__esModule",{value:!0});var Ay=Cy(wu()),wy=Ay.default.createProxyServer({changeOrigin:!0});function xy(e,t,r,n){let s={target:{protocol:r.domainOrIp==="127.0.0.1"?"http":"https",host:r.domainOrIp,port:r.port}};wy.web(e,t,s,n||Function.prototype)}Jt.default=xy});var js=h(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});var Ty=[/^x-0-/i,/^host$/i,/^x-request-id$/i,/^content-length$/i],Py=[/^layer0_/i],Oy=[/^layer0_devtools/i],ct=e=>{if(Ty.find(t=>e.match(t)))throw new Error(`Header "${e}" is reserved and cannot be modified`)},Hy=e=>{if(Py.find(t=>e.match(t))&&!Oy.find(t=>e.match(t)))throw new Error(`Cookie "${e}" is reserved and cannot be modified`)};de.validateSetResponseHeader=e=>{ct(e)};de.validateUpdateResponseHeader=e=>{ct(e)};de.validateRemoveResponseHeader=e=>{ct(e)};de.validateSetRequestHeader=e=>{ct(e)};de.validateUpdateRequestHeader=e=>{ct(e)};de.validateRemoveRequestHeader=e=>{ct(e)};de.validateCookieName=e=>{Hy(e)}});var $s=h(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});function Dy(e){return e==null?{}:typeof e=="string"?{path:e}:e}Ls.default=Dy});var Fs=h(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});var qy=Xr(),fn=class extends Error{constructor(t){super(`Route pattern "${t}" contains invalid syntax. See https://docs.layer0.co/guides/routing#section_route_pattern_syntax`);this.isUserError=!0}};dn.PathMatcherError=fn;var Xt=class{constructor(t){this.pattern=t}match(t){if(!this.matcher)try{this.matcher=qy.match(this.pattern,{decode:decodeURIComponent})}catch(n){throw new fn(this.pattern)}Xt.validatePattern(this.pattern);let r=this.matcher(t);return r?r.params:void 0}static validatePattern(t){let r=t.match(this.PARTIAL_SPLAT_ROUTE);if(r){let[n,i,s]=r,o=t.replace(`${i}${s}`,`${i}:suffix/${s}`);throw new fn(`Partial splat routes are not supported. Use "${o}" instead of "${t}"`)}return!0}};dn.default=Xt;Xt.PARTIAL_SPLAT_ROUTE=/(\/[^:/]+)(:[^*/#?]+\*)/});var Tu=h(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});function My(e){return typeof e!="string"?"":e.toLowerCase()}ks.default=My});var yn=h(Me=>{"use strict";var hn=Me&&Me.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Iy=Me&&Me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Me,"__esModule",{value:!0});var Ny=H(),pn=Mt(),jy=tn(),Ly=Xr(),$y=hn($s()),Pu=Iy(Fs()),Fy=hn(require("querystring")),ky=hn(Qr()),By=hn(Tu()),lt=class{constructor(t,r,n){this.criteria=$y.default(t),this.handler=r,this.options=n,this.criteria.path&&(this.matcher=new Pu.default(this.criteria.path))}match(t){let r=[this.matchPath,this.matchProtocol,this.matchMethod,this.matchHeaders,this.matchQueryParams,this.matchCookies],n={};for(let i of r){let s=i.bind(this)(t);if(!s)return!1;Object.assign(n,s)}return t.params=n,n}matchResponse(t){return this.matchResponseStatus(t)}matchResponseStatus(t){var r,n,i;return((n=(r=this.criteria)===null||r===void 0?void 0:r.response)===null||n===void 0?void 0:n.statusCode)?!!((i=t.statusCode)===null||i===void 0?void 0:i.toString().match(this.criteria.response.statusCode)):!1}matchPath(t){return this.matcher?this.matcher.match(t.path):{}}matchMethod(t){return!this.criteria.method||!t.method?!0:new RegExp(this.criteria.method,"i").test(t.method)}matchHeaders(t){return this.criteria.headers?pn.matchCriteriaRegexObjectWithRequestObject(this.criteria.headers,t.headers,By.default):!0}matchQueryParams(t){return this.criteria.query?t.query?pn.matchCriteriaRegexObjectWithRequestObject(this.criteria.query,t.query):!1:!0}matchCookies(t){if(this.criteria.cookies){let r=t.headers.cookie;if(r==null)return Object.values(this.criteria.cookies).every(s=>s===null);let n=Array.isArray(r)?r.join("; "):r,i=jy.parse(n);return pn.matchCriteriaRegexObjectWithRequestObject(this.criteria.cookies,i)}return!0}matchProtocol(t){let r=t.headers&&t.headers[Ny.HTTP_HEADERS.x0Protocol]||"https",n;return typeof this.criteria.protocol=="string"?n=new RegExp(`^${this.criteria.protocol}$`,"i"):n=new RegExp(this.criteria.protocol||"^https$","i"),pn.testRegExp(n,r)}toString(){let n=this.criteria,{path:t}=n,r=yo(n,["path"]);return Object.keys(r).length?JSON.stringify(this.criteria):t||"fallback"}toRegex(){return lt.toRegexp(this.criteria.path)}toJson(){var t;return JSON.stringify(O(S({},this.criteria),{label:(t=this.options)===null||t===void 0?void 0:t.label}),(r,n)=>n instanceof RegExp?n.toString():n)}toRegexString(){return this.toRegex().source}toEdgeRegexString(){return lt.toEdgeRegexString(this.criteria.path)}isRespRoute(){return!!this.criteria.response}static toRegexp(t){if(t)try{return Ly.pathToRegexp(t)}catch(r){throw new Pu.PathMatcherError(t)}else return/^.*$/}static toEdgeRegexString(t){return ky.default(lt.toRegexp(t))}static pathWithQueryString(t,r){let n=Fy.default.stringify(r).replace(/%3A/g,":");return t+(n&&`\\?${n}`)}};Me.default=lt});var Ou=h(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});var Uy=require("zlib"),Bs=H();function Wy(e){var t;((t=e.getHeader(Bs.HTTP_HEADERS.contentEncoding))===null||t===void 0?void 0:t.toLowerCase())==="gzip"&&e.body instanceof Buffer&&(e.removeHeader(Bs.HTTP_HEADERS.contentEncoding),e.removeHeader(Bs.HTTP_HEADERS.contentLength),e.body=Uy.gunzipSync(e.body))}Us.default=Wy});var Du=h((ME,Hu)=>{"use strict";Hu.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}});var Mu=h((IE,qu)=>{"use strict";qu.exports=b;b.Node=Ie;b.create=b;function b(e){var t=this;if(t instanceof b||(t=new b),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}b.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t};b.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};b.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};b.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Vy(this,arguments[e]);return this.length};b.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Yy(this,arguments[e]);return this.length};b.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};b.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};b.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;r!==null;n++)e.call(t,r.value,n,this),r=r.next};b.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;r!==null;n--)e.call(t,r.value,n,this),r=r.prev};b.prototype.get=function(e){for(var t=0,r=this.head;r!==null&&t<e;t++)r=r.next;if(t===e&&r!==null)return r.value};b.prototype.getReverse=function(e){for(var t=0,r=this.tail;r!==null&&t<e;t++)r=r.prev;if(t===e&&r!==null)return r.value};b.prototype.map=function(e,t){t=t||this;for(var r=new b,n=this.head;n!==null;)r.push(e.call(t,n.value,this)),n=n.next;return r};b.prototype.mapReverse=function(e,t){t=t||this;for(var r=new b,n=this.tail;n!==null;)r.push(e.call(t,n.value,this)),n=n.prev;return r};b.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)r=e(r,n.value,i),n=n.next;return r};b.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)r=e(r,n.value,i),n=n.prev;return r};b.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;r!==null;t++)e[t]=r.value,r=r.next;return e};b.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;r!==null;t++)e[t]=r.value,r=r.prev;return e};b.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new b;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)r.push(i.value);return r};b.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new b;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>e;n--,i=i.prev)r.push(i.value);return r};b.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<r.length;n++)i=Gy(this,i,r[n]);return s};b.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};function Gy(e,t,r){var n=t===e.head?new Ie(r,null,t,e):new Ie(r,t,t.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function Vy(e,t){e.tail=new Ie(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Yy(e,t){e.head=new Ie(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ie(e,t,r,n){if(!(this instanceof Ie))return new Ie(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{Du()(b)}catch(e){}});var ku=h((NE,Fu)=>{"use strict";var zy=Mu(),Ne=Symbol("max"),he=Symbol("length"),ft=Symbol("lengthCalculator"),Zt=Symbol("allowStale"),je=Symbol("maxAge"),pe=Symbol("dispose"),Iu=Symbol("noDisposeOnSet"),D=Symbol("lruList"),ne=Symbol("cache"),Nu=Symbol("updateAgeOnGet"),Ws=()=>1,ju=class{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");let r=this[Ne]=t.max||Infinity,n=t.length||Ws;if(this[ft]=typeof n!="function"?Ws:n,this[Zt]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[je]=t.maxAge||0,this[pe]=t.dispose,this[Iu]=t.noDisposeOnSet||!1,this[Nu]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Ne]=t||Infinity,er(this)}get max(){return this[Ne]}set allowStale(t){this[Zt]=!!t}get allowStale(){return this[Zt]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[je]=t,er(this)}get maxAge(){return this[je]}set lengthCalculator(t){typeof t!="function"&&(t=Ws),t!==this[ft]&&(this[ft]=t,this[he]=0,this[D].forEach(r=>{r.length=this[ft](r.value,r.key),this[he]+=r.length})),er(this)}get lengthCalculator(){return this[ft]}get length(){return this[he]}get itemCount(){return this[D].length}rforEach(t,r){r=r||this;for(let n=this[D].tail;n!==null;){let i=n.prev;$u(this,t,n,r),n=i}}forEach(t,r){r=r||this;for(let n=this[D].head;n!==null;){let i=n.next;$u(this,t,n,r),n=i}}keys(){return this[D].toArray().map(t=>t.key)}values(){return this[D].toArray().map(t=>t.value)}reset(){this[pe]&&this[D]&&this[D].length&&this[D].forEach(t=>this[pe](t.key,t.value)),this[ne]=new Map,this[D]=new zy,this[he]=0}dump(){return this[D].map(t=>gn(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[D]}set(t,r,n){if(n=n||this[je],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let i=n?Date.now():0,s=this[ft](r,t);if(this[ne].has(t)){if(s>this[Ne])return dt(this,this[ne].get(t)),!1;let u=this[ne].get(t).value;return this[pe]&&(this[Iu]||this[pe](t,u.value)),u.now=i,u.maxAge=n,u.value=r,this[he]+=s-u.length,u.length=s,this.get(t),er(this),!0}let o=new Lu(t,r,s,i,n);return o.length>this[Ne]?(this[pe]&&this[pe](t,r),!1):(this[he]+=o.length,this[D].unshift(o),this[ne].set(t,this[D].head),er(this),!0)}has(t){if(!this[ne].has(t))return!1;let r=this[ne].get(t).value;return!gn(this,r)}get(t){return Gs(this,t,!0)}peek(t){return Gs(this,t,!1)}pop(){let t=this[D].tail;return t?(dt(this,t),t.value):null}del(t){dt(this,this[ne].get(t))}load(t){this.reset();let r=Date.now();for(let n=t.length-1;n>=0;n--){let i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-r;o>0&&this.set(i.k,i.v,o)}}}prune(){this[ne].forEach((t,r)=>Gs(this,r,!1))}},Gs=(e,t,r)=>{let n=e[ne].get(t);if(n){let i=n.value;if(gn(e,i)){if(dt(e,n),!e[Zt])return}else r&&(e[Nu]&&(n.value.now=Date.now()),e[D].unshiftNode(n));return i.value}},gn=(e,t)=>{if(!t||!t.maxAge&&!e[je])return!1;let r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[je]&&r>e[je]},er=e=>{if(e[he]>e[Ne])for(let t=e[D].tail;e[he]>e[Ne]&&t!==null;){let r=t.prev;dt(e,t),t=r}},dt=(e,t)=>{if(t){let r=t.value;e[pe]&&e[pe](r.key,r.value),e[he]-=r.length,e[ne].delete(r.key),e[D].removeNode(t)}},Lu=class{constructor(t,r,n,i,s){this.key=t,this.value=r,this.length=n,this.now=i,this.maxAge=s||0}},$u=(e,t,r,n)=>{let i=r.value;gn(e,i)&&(dt(e,r),e[Zt]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};Fu.exports=ju});var oi=h((nr,gt)=>{var Ky=200,Bu="__lodash_hash_undefined__",Uu=9007199254740991,Vs="[object Arguments]",Qy="[object Array]",Wu="[object Boolean]",Gu="[object Date]",Jy="[object Error]",Ys="[object Function]",Vu="[object GeneratorFunction]",mn="[object Map]",Yu="[object Number]",zs="[object Object]",zu="[object Promise]",Ku="[object RegExp]",vn="[object Set]",Qu="[object String]",Ju="[object Symbol]",Ks="[object WeakMap]",Xu="[object ArrayBuffer]",_n="[object DataView]",Zu="[object Float32Array]",ec="[object Float64Array]",tc="[object Int8Array]",rc="[object Int16Array]",nc="[object Int32Array]",sc="[object Uint8Array]",ic="[object Uint8ClampedArray]",oc="[object Uint16Array]",ac="[object Uint32Array]",Xy=/[\\^$.*+?()[\]{}|]/g,Zy=/\w*$/,eg=/^\[object .+?Constructor\]$/,tg=/^(?:0|[1-9]\d*)$/,A={};A[Vs]=A[Qy]=A[Xu]=A[_n]=A[Wu]=A[Gu]=A[Zu]=A[ec]=A[tc]=A[rc]=A[nc]=A[mn]=A[Yu]=A[zs]=A[Ku]=A[vn]=A[Qu]=A[Ju]=A[sc]=A[ic]=A[oc]=A[ac]=!0;A[Jy]=A[Ys]=A[Ks]=!1;var rg=typeof global=="object"&&global&&global.Object===Object&&global,ng=typeof self=="object"&&self&&self.Object===Object&&self,ye=rg||ng||Function("return this")(),uc=typeof nr=="object"&&nr&&!nr.nodeType&&nr,cc=uc&&typeof gt=="object"&&gt&&!gt.nodeType&&gt,sg=cc&&cc.exports===uc;function ig(e,t){return e.set(t[0],t[1]),e}function og(e,t){return e.add(t),e}function ag(e,t){for(var r=-1,n=e?e.length:0;++r<n&&t(e[r],r,e)!==!1;);return e}function ug(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function lc(e,t,r,n){var i=-1,s=e?e.length:0;for(n&&s&&(r=e[++i]);++i<s;)r=t(r,e[i],i,e);return r}function cg(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function lg(e,t){return e==null?void 0:e[t]}function fc(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch(r){}return t}function dc(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}function Qs(e,t){return function(r){return e(t(r))}}function hc(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var fg=Array.prototype,dg=Function.prototype,Rn=Object.prototype,Js=ye["__core-js_shared__"],pc=function(){var e=/[^.]+$/.exec(Js&&Js.keys&&Js.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),yc=dg.toString,Ee=Rn.hasOwnProperty,En=Rn.toString,hg=RegExp("^"+yc.call(Ee).replace(Xy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gc=sg?ye.Buffer:void 0,mc=ye.Symbol,vc=ye.Uint8Array,pg=Qs(Object.getPrototypeOf,Object),yg=Object.create,gg=Rn.propertyIsEnumerable,mg=fg.splice,_c=Object.getOwnPropertySymbols,vg=gc?gc.isBuffer:void 0,_g=Qs(Object.keys,Object),Xs=yt(ye,"DataView"),tr=yt(ye,"Map"),Zs=yt(ye,"Promise"),ei=yt(ye,"Set"),ti=yt(ye,"WeakMap"),rr=yt(Object,"create"),Rg=Fe(Xs),Eg=Fe(tr),bg=Fe(Zs),Sg=Fe(ei),Cg=Fe(ti),Rc=mc?mc.prototype:void 0,Ec=Rc?Rc.valueOf:void 0;function Le(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ag(){this.__data__=rr?rr(null):{}}function wg(e){return this.has(e)&&delete this.__data__[e]}function xg(e){var t=this.__data__;if(rr){var r=t[e];return r===Bu?void 0:r}return Ee.call(t,e)?t[e]:void 0}function Tg(e){var t=this.__data__;return rr?t[e]!==void 0:Ee.call(t,e)}function Pg(e,t){var r=this.__data__;return r[e]=rr&&t===void 0?Bu:t,this}Le.prototype.clear=Ag;Le.prototype.delete=wg;Le.prototype.get=xg;Le.prototype.has=Tg;Le.prototype.set=Pg;function ge(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Og(){this.__data__=[]}function Hg(e){var t=this.__data__,r=bn(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():mg.call(t,r,1),!0}function Dg(e){var t=this.__data__,r=bn(t,e);return r<0?void 0:t[r][1]}function qg(e){return bn(this.__data__,e)>-1}function Mg(e,t){var r=this.__data__,n=bn(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}ge.prototype.clear=Og;ge.prototype.delete=Hg;ge.prototype.get=Dg;ge.prototype.has=qg;ge.prototype.set=Mg;function ht(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ig(){this.__data__={hash:new Le,map:new(tr||ge),string:new Le}}function Ng(e){return Sn(this,e).delete(e)}function jg(e){return Sn(this,e).get(e)}function Lg(e){return Sn(this,e).has(e)}function $g(e,t){return Sn(this,e).set(e,t),this}ht.prototype.clear=Ig;ht.prototype.delete=Ng;ht.prototype.get=jg;ht.prototype.has=Lg;ht.prototype.set=$g;function pt(e){this.__data__=new ge(e)}function Fg(){this.__data__=new ge}function kg(e){return this.__data__.delete(e)}function Bg(e){return this.__data__.get(e)}function Ug(e){return this.__data__.has(e)}function Wg(e,t){var r=this.__data__;if(r instanceof ge){var n=r.__data__;if(!tr||n.length<Ky-1)return n.push([e,t]),this;r=this.__data__=new ht(n)}return r.set(e,t),this}pt.prototype.clear=Fg;pt.prototype.delete=kg;pt.prototype.get=Bg;pt.prototype.has=Ug;pt.prototype.set=Wg;function Gg(e,t){var r=si(e)||ym(e)?cg(e.length,String):[],n=r.length,i=!!n;for(var s in e)(t||Ee.call(e,s))&&!(i&&(s=="length"||fm(s,n)))&&r.push(s);return r}function bc(e,t,r){var n=e[t];(!(Ee.call(e,t)&&wc(n,r))||r===void 0&&!(t in e))&&(e[t]=r)}function bn(e,t){for(var r=e.length;r--;)if(wc(e[r][0],t))return r;return-1}function Vg(e,t){return e&&Sc(t,ii(t),e)}function ri(e,t,r,n,i,s,o){var a;if(n&&(a=s?n(e,i,s,o):n(e)),a!==void 0)return a;if(!Cn(e))return e;var u=si(e);if(u){if(a=um(e),!t)return im(e,a)}else{var c=$e(e),l=c==Ys||c==Vu;if(mm(e))return Xg(e,t);if(c==zs||c==Vs||l&&!s){if(fc(e))return s?e:{};if(a=cm(l?{}:e),!t)return om(e,Vg(a,e))}else{if(!A[c])return s?e:{};a=lm(e,c,ri,t)}}o||(o=new pt);var f=o.get(e);if(f)return f;if(o.set(e,a),!u)var d=r?am(e):ii(e);return ag(d||e,function(p,y){d&&(y=p,p=e[y]),bc(a,y,ri(p,t,r,n,y,e,o))}),a}function Yg(e){return Cn(e)?yg(e):{}}function zg(e,t,r){var n=t(e);return si(e)?n:ug(n,r(e))}function Kg(e){return En.call(e)}function Qg(e){if(!Cn(e)||hm(e))return!1;var t=Tc(e)||fc(e)?hg:eg;return t.test(Fe(e))}function Jg(e){if(!Ac(e))return _g(e);var t=[];for(var r in Object(e))Ee.call(e,r)&&r!="constructor"&&t.push(r);return t}function Xg(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}function ni(e){var t=new e.constructor(e.byteLength);return new vc(t).set(new vc(e)),t}function Zg(e,t){var r=t?ni(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function em(e,t,r){var n=t?r(dc(e),!0):dc(e);return lc(n,ig,new e.constructor)}function tm(e){var t=new e.constructor(e.source,Zy.exec(e));return t.lastIndex=e.lastIndex,t}function rm(e,t,r){var n=t?r(hc(e),!0):hc(e);return lc(n,og,new e.constructor)}function nm(e){return Ec?Object(Ec.call(e)):{}}function sm(e,t){var r=t?ni(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function im(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function Sc(e,t,r,n){r||(r={});for(var i=-1,s=t.length;++i<s;){var o=t[i],a=n?n(r[o],e[o],o,r,e):void 0;bc(r,o,a===void 0?e[o]:a)}return r}function om(e,t){return Sc(e,Cc(e),t)}function am(e){return zg(e,ii,Cc)}function Sn(e,t){var r=e.__data__;return dm(t)?r[typeof t=="string"?"string":"hash"]:r.map}function yt(e,t){var r=lg(e,t);return Qg(r)?r:void 0}var Cc=_c?Qs(_c,Object):Rm,$e=Kg;(Xs&&$e(new Xs(new ArrayBuffer(1)))!=_n||tr&&$e(new tr)!=mn||Zs&&$e(Zs.resolve())!=zu||ei&&$e(new ei)!=vn||ti&&$e(new ti)!=Ks)&&($e=function(e){var t=En.call(e),r=t==zs?e.constructor:void 0,n=r?Fe(r):void 0;if(n)switch(n){case Rg:return _n;case Eg:return mn;case bg:return zu;case Sg:return vn;case Cg:return Ks}return t});function um(e){var t=e.length,r=e.constructor(t);return t&&typeof e[0]=="string"&&Ee.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function cm(e){return typeof e.constructor=="function"&&!Ac(e)?Yg(pg(e)):{}}function lm(e,t,r,n){var i=e.constructor;switch(t){case Xu:return ni(e);case Wu:case Gu:return new i(+e);case _n:return Zg(e,n);case Zu:case ec:case tc:case rc:case nc:case sc:case ic:case oc:case ac:return sm(e,n);case mn:return em(e,n,r);case Yu:case Qu:return new i(e);case Ku:return tm(e);case vn:return rm(e,n,r);case Ju:return nm(e)}}function fm(e,t){return t=t??Uu,!!t&&(typeof e=="number"||tg.test(e))&&e>-1&&e%1==0&&e<t}function dm(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function hm(e){return!!pc&&pc in e}function Ac(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Rn;return e===r}function Fe(e){if(e!=null){try{return yc.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function pm(e){return ri(e,!0,!0)}function wc(e,t){return e===t||e!==e&&t!==t}function ym(e){return gm(e)&&Ee.call(e,"callee")&&(!gg.call(e,"callee")||En.call(e)==Vs)}var si=Array.isArray;function xc(e){return e!=null&&vm(e.length)&&!Tc(e)}function gm(e){return _m(e)&&xc(e)}var mm=vg||Em;function Tc(e){var t=Cn(e)?En.call(e):"";return t==Ys||t==Vu}function vm(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Uu}function Cn(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function _m(e){return!!e&&typeof e=="object"}function ii(e){return xc(e)?Gg(e):Jg(e)}function Rm(){return[]}function Em(){return!1}gt.exports=pm});var ui=h(me=>{"use strict";var Pc=me&&me.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(me,"__esModule",{value:!0});var q=H(),bm=Pc(ku()),Sm=Pc(oi()),ai;function Cm(){return process.env.LAYER0_CACHE==="true"}me.isCacheEnabled=Cm;function An(){return ai||(ai=new bm.default),ai}me.getCache=An;function Am(){An().reset()}me.clearCache=Am;function wm(e){return An().get(e.toString())}me.getCachedResponse=wm;function xm({response:e,cacheKey:t,context:r}){var n;let i=(n=t.method)===null||n===void 0?void 0:n.toLowerCase();if(i&&!q.CACHEABLE_METHODS.has(i)&&r.cacheRouteMethod!==i)return e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.method),!1;if(t.body&&Buffer.from(t.body,"utf8").length>8e3)return e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.bodyTooBig),!1;if(e.statusCode&&e.statusCode>=400)return e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.code),!1;if(e.getHeader(q.HTTP_HEADERS.setCookie))return e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.setCookie),!1;let s=Pm(e);return s.private&&!r.forcePrivateCaching?(e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.private),!1):s.maxAge?(An().set(t.toString(),Tm(e),s.maxAge*1e3),e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.ok),!0):(e.setHeader(q.HTTP_HEADERS.x0CachingStatus,q.CACHING_STATUS.noMaxAge),!1)}me.maybeCacheResponse=xm;function Tm(e){return{statusCode:e.statusCode,statusMessage:e.statusMessage,headers:Sm.default(e.getHeaders()),body:e.body}}function Pm(e){return S(S(S({},{private:!1,maxAge:0}),Oc(e.getHeader(q.HTTP_HEADERS.cacheControl))),Oc(e.getHeader(q.HTTP_HEADERS.x0CacheControl)))}function Oc(e){let t={};if(e){Array.isArray(e)||(e=[e]);let r={};for(let n of e){let i=n.split(/,\s*/).map(s=>s.split(/=/));for(let[s,o]of i)s&&o&&(r[s.toLowerCase()]=o),s.toLowerCase()==="private"&&(t.private=!0);t.maxAge=parseInt(r["s-maxage"]||r["max-age"]||"0")}}return t}});var Hc=h(sr=>{"use strict";var Om=sr&&sr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sr,"__esModule",{value:!0});var be=H(),Hm=Om(require("crypto")),wn=class{constructor(t,r){var n;this.cookies={};let{host:i}=t.headers;if(this.body=t.body,this.method=(n=t.method)===null||n===void 0?void 0:n.toLowerCase(),this.query=this.excludeLayer0QueryParams(t.query||{}),this.pathname=new URL(t.url,`http://${i}`).pathname,this.headers=this.getDefaultHeaders(t.headers),r)for(let s of r.getActions())s(this,t)}static create(t,r){return new wn(t,r)}excludeLayer0QueryParams(t){let r={};for(let n in t)n.startsWith("layer0_")||(r[n]=t[n]);return r}toSortedArray(t){return Object.keys(t).sort().map(r=>[r,t[r]])}getDefaultHeaders(t){return{[be.HTTP_HEADERS.host]:t[be.HTTP_HEADERS.host],[be.HTTP_HEADERS.acceptEncoding]:t[be.HTTP_HEADERS.acceptEncoding],[be.HTTP_HEADERS.x0Destination]:t[be.HTTP_HEADERS.x0Destination],[be.HTTP_HEADERS.x0Protocol]:t[be.HTTP_HEADERS.x0Protocol]}}toString(){return JSON.stringify({pathname:this.pathname,method:this.method,query:this.toSortedArray(this.query),body:Dm(this.body),headers:this.toSortedArray(this.headers),cookies:this.toSortedArray(this.cookies)})}};sr.default=wn;function Dm(e){if(!e)return null;let t=Hm.default.createHash("sha256");return t.update(e),t.digest("hex")}});var Dc=h(Se=>{"use strict";var qm=Se&&Se.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Se,"__esModule",{value:!0});var Mm=qm(ie()),ci,ir,li="info",fi="warn",di="error";try{let e=Mm.default("chalk"),t=e.hex("D355A7");ir=e.grey("Layer0"),ci=e.bold(`Layer${t("0")}`),li=e.cyan(li),fi=e.yellow(fi),di=e.red(di)}catch(e){ci=ir="Layer0"}Se.infoLogLabel=`${ir} ${li} -`;Se.warnLogLabel=`${ir} ${fi} -`;Se.errorLogLabel=`${ir} ${di} -`;Se.default=ci});var Pn=h(ar=>{"use strict";var K=ar&&ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ar,"__esModule",{value:!0});var xn=K(require("fs")),Im=require("path"),mt=K(Jr()),Tn=K(Oe()),Nm=K(qa()),jm=K(As()),Lm=K(xu()),T=H(),$m=Xe(),X=js(),Fm=K(yn()),km=K(Ou()),or=ui(),Bm=K(Hc()),F=Xn(),Um=K(Fs()),Wm=K(ie()),ke=Dc(),Gm=os(),qc=K(oi()),Vm=K(bs()),Mc=class extends Gm.BaseResponseWriter{constructor(t,r,n,i){super(t,r,n);this.params={},this.streaming=!1,this.preCacheRequestActions=[],this.postCacheRequestActions=[],this.preCacheResponseActions=[],this.postCacheResponseActions=[],this.interpolateParams=s=>jm.default(this.request,this.response,s),this.redirect=(s,o={})=>{let{to:a,statusCode:u,query:c}=this._readRedirectParams(s,o),l=Vm.default(this.request.url,mt.default(Fm.default.pathWithQueryString(a,c),this.request.params));this.setResponseHeader(T.HTTP_HEADERS.location,l),this.send("",u)},this.proxy=async(s,o)=>{let a=Tn.default.get(`backends.${s}`);await this.proxyHost(a,o)},this.render=s=>{console.warn(`${ke.warnLogLabel} Warning ResponseWriter#render is deprecated.`),s(this.request,this.proxy,this.request.params)},this.renderWithApp=s=>this.proxy(T.BACKENDS.js,s),this.stream=s=>{if(process.env.NODE_ENV==="production")throw new Error("stream can only be used in development");let o=Ic(Tn.default.get(`backends.${s}`));this.response.setHeader(T.HTTP_HEADERS.contentType,"text/event-stream"),this.streaming=!0,Lm.default(this.request,this.response,o,Function.prototype),this.setCreateResponseAction(()=>Promise.resolve())},this.proxyHost=async(s,{path:o,transformRequest:a,transformResponse:u,headers:c}={})=>{s=Ic(s);let l=new Nm.default(s),f;typeof o=="function"?f=o():f=o,f=f&&mt.default(f,this.request.params),await this.setCreateResponseAction(async()=>{try{if(a){let p=new F.InternalTiming(F.InternalNames.transformRequest).start();try{await this.runImmediately(()=>a(this.request))}finally{p.end()}}let d=new F.InternalTiming(F.InternalNames.proxying).start();try{await l.fetch(this.request,this.response,{path:f||this.request.url,disableCheckCert:s.disableCheckCert,headers:c})}finally{d.end()}if(u){let p=new F.InternalTiming(F.InternalNames.transformResponse).start();try{km.default(this.response),await this.runImmediately(()=>u(this.response,this.request))}finally{p.end()}}}catch(d){d.type==="BackendFetchError"?(console.error(`${ke.errorLogLabel} Could not connect to backend ${s.domainOrIp}:`,d.message),this.response.statusCode=503):(console.error(`${ke.errorLogLabel} Error in ResponseWriter:`,d),this.response.statusCode=500)}})},this.updatePath=s=>{let o=mt.default(s,this.request.params);Object.defineProperty(this.request,"path",{get:()=>o})},this.rewrite=(s,o)=>{let a=mt.default(s,this.request.params);this.request.params=new Um.default(o).match(a)},this.serveStatic=async(s,o={})=>{let a=s&&mt.default(s,this.request.params),{permanent:u,exclude:c}=o;if(a=a.replace(/\/$/,""),c==null?void 0:c.some(l=>a.indexOf(l)>=0))return this.send("404 - Not found",404);if($m.isCloud()){let l=Tn.default.get(`backends.${u?T.BACKENDS.permanentStatic:T.BACKENDS.static}`);await this.proxyHost(l,{path:a,transformResponse:async f=>{f.statusCode===403&&(o.loadingPage?await this.proxyHost(Tn.default.get(`backends.${T.BACKENDS.static}`),{path:mt.default(o.loadingPage,this.request.params)}):o.onNotFound?await o.onNotFound(this):(f.statusCode=404,f.statusMessage="Not Found")),o.statusCode&&(f.statusCode=o.statusCode),o.statusMessage&&(f.statusMessage=o.statusMessage)}})}else{if(!xn.default.existsSync(a))return this.send("404 - Not found",404);xn.default.lstatSync(a).isDirectory()&&(a=Im.join(a,"./index.html"));let l=xn.default.statSync(a),d=Wm.default("mime-types").lookup(a);d&&this.setResponseHeader(T.HTTP_HEADERS.contentType,d),this.internalSetResponseHeader(T.HTTP_HEADERS.contentLength,l.size.toString(),!1,this.postCacheResponseActions),o.statusCode&&(this.response.statusCode=o.statusCode,this.response.statusMessage=o.statusMessage),this.setCreateResponseAction(()=>new Promise((p,y)=>{xn.default.readFile(a,(m,g)=>{m?y(m):(this.response.body=g,p())})}))}},this.cache=s=>{let{browser:o,edge:a,key:u}=s;if(a){let{maxAgeSeconds:c,staleWhileRevalidateSeconds:l,forcePrivateCaching:f}=a,d=[];typeof f!="undefined"&&(this.context.forcePrivateCaching=f===!0),this.cacheKey=u,typeof this.route.criteria.method=="string"&&(this.context.cacheRouteMethod=this.route.criteria.method),c&&(d.push("max-age="+c),l&&d.push("stale-while-revalidate="+l)),d.length&&this.internalSetResponseHeader(T.HTTP_HEADERS.x0CacheControl,d.join(", "),!1,this.preCacheResponseActions)}if(o||o===!1){let{maxAgeSeconds:c,serviceWorkerSeconds:l}=o||{maxAgeSeconds:0};c===0?this.setResponseHeader(T.HTTP_HEADERS.cacheControl,"private, no-store, no-cache"):c&&this.setResponseHeader(T.HTTP_HEADERS.cacheControl,`private, max-age=${c}`),l&&this.setResponseHeader(T.HTTP_HEADERS.xSwCacheControl,`max-age=${l}`)}},this.setResponseHeader=(s,o)=>{this.internalSetResponseHeader(s,o,!0,this.postCacheResponseActions)},this.internalSetResponseHeader=(s,o,a,u)=>{a&&X.validateSetResponseHeader(s),this.scheduleExecution(u,()=>{let c=this.interpolateParams(o);this.response.setHeader(s,c)})},this.updateResponseHeader=(s,o,a)=>{this.internalUpdateResponseHeader(s,o,a,this.preCacheResponseActions)},this.internalUpdateResponseHeader=(s,o,a,u)=>{X.validateUpdateResponseHeader(s),this.scheduleExecution(u,()=>{let c=this.response.getHeader(s),l=this.interpolateParams(a);c&&this.response.setHeader(s,c.replace(o,l))})},this.removeResponseHeader=s=>{this.internalRemoveResponseHeader(s,this.postCacheResponseActions)},this.internalRemoveResponseHeader=(s,o)=>{X.validateRemoveResponseHeader(s),this.scheduleExecution(o,()=>{this.response.removeHeader(s)})},this.getSetCookieValues=()=>{let s=this.response.getHeader(T.HTTP_HEADERS.setCookie);return typeof s=="string"?[s]:s||[]},this.getAddResponseCookieAction=(s,o)=>()=>{let a=this.getSetCookieValues(),u=this.interpolateParams(o);this.response.setHeader(T.HTTP_HEADERS.setCookie,[...a,`${s}=${u}`])},this.addUpstreamResponseCookie=(s,o)=>{X.validateCookieName(s),this.scheduleExecution(this.preCacheResponseActions,this.getAddResponseCookieAction(s,o))},this.addResponseCookie=(s,o)=>{X.validateCookieName(s),this.scheduleExecution(this.postCacheResponseActions,this.getAddResponseCookieAction(s,o))},this.getUpdateResponseCookieAction=(s,o,a)=>()=>{let u=this.getSetCookieValues().map(c=>{let[l,...f]=c.split("=");if(l!==s)return c;let d=f.join("=").replace(o,a);return[l,d].join("=")});this.response.setHeader(T.HTTP_HEADERS.setCookie,u)},this.updateUpstreamResponseCookie=(s,o,a)=>{X.validateCookieName(s),this.scheduleExecution(this.preCacheResponseActions,this.getUpdateResponseCookieAction(s,o,a))},this.updateResponseCookie=(s,o,a)=>{X.validateCookieName(s),this.scheduleExecution(this.postCacheResponseActions,this.getUpdateResponseCookieAction(s,o,a))},this.getRemoveResponseCookieAction=s=>()=>{let o=this.getSetCookieValues().filter(a=>a.split("=")[0]!==s);this.response.setHeader(T.HTTP_HEADERS.setCookie,o)},this.removeUpstreamResponseCookie=s=>{X.validateCookieName(s),this.scheduleExecution(this.preCacheResponseActions,this.getRemoveResponseCookieAction(s))},this.removeResponseCookie=s=>{X.validateCookieName(s),this.scheduleExecution(this.postCacheResponseActions,this.getRemoveResponseCookieAction(s))},this.setUpstreamResponseHeader=(s,o)=>{let a=s.toLowerCase()!=T.HTTP_HEADERS.x0SurrogateKey;return this.internalSetResponseHeader(s,o,a,this.preCacheResponseActions)},this.updateUpstreamResponseHeader=(s,o,a)=>this.internalUpdateResponseHeader(s,o,a,this.preCacheResponseActions),this.removeUpstreamResponseHeader=s=>this.internalRemoveResponseHeader(s,this.preCacheResponseActions),this.setRequestHeader=(s,o)=>{X.validateSetRequestHeader(s),this.scheduleExecution(this.postCacheRequestActions,()=>{this.request.headers[s.toLowerCase()]=o})},this.runImmediatelyDepthCounter=0,this.runImmediately=async s=>{try{++this.runImmediatelyDepthCounter,await s()}finally{--this.runImmediatelyDepthCounter}},this.scheduleExecution=(s,o)=>{this.runningImmediately?o():s.push(o)},this.updateRequestHeader=(s,o,a)=>{X.validateUpdateRequestHeader(s),this.scheduleExecution(this.postCacheRequestActions,()=>{let u=s.toLowerCase(),c=this.request.headers[u],l=this.interpolateParams(a);Array.isArray(c)?this.request.headers[u]=c.map(f=>f.replace(o,l)):c&&(this.request.headers[u]=c.replace(o,l))})},this.removeRequestHeader=s=>{X.validateRemoveRequestHeader(s),this.scheduleExecution(this.postCacheRequestActions,()=>{delete this.request.headers[s.toLowerCase()]})},this.serviceWorker=s=>{this.cache({edge:{maxAgeSeconds:30758400},browser:{maxAgeSeconds:0}}),this.serveStatic(s)},this.appShell=s=>{this.setResponseHeader(T.HTTP_HEADERS.contentType,"text/html"),this.serveStatic(s)},this.allowCors=(s={})=>{this.setResponseHeader("Access-Control-Allow-Origin",s.origin||"*"),s.methods&&this.setResponseHeader("Access-Control-Allow-Methods",s.methods.join(", ")),s.headers&&this.setResponseHeader("Access-Control-Allow-Headers",s.headers.join(", ")),s.maxAge&&this.setResponseHeader("Access-Control-Max-Age",s.maxAge.toString()),s.credentials!=null&&this.setResponseHeader("Access-Control-Allow-Credentials",s.credentials.toString())},this.send=(s,o=200,a)=>{this.setCreateResponseAction(async()=>{this.response.statusCode=o,this.response.statusMessage=a,typeof s=="function"?this.response.body=s():this.response.body=s})},this.compute=s=>{this.setCreateResponseAction(async()=>{await this.clearResponseAction().runImmediately(()=>s(this.request,this.response))})},this.onRouteError=s=>{let o={status:"error",message:s.message},a=s.isUserError;a&&console.error(`${ke.errorLogLabel} ${s.message}`),process.env.NODE_ENV!=="production"&&(o={message:`An error occured while running route ${this.route.toString()}: ${s.message}`,stack:a?void 0:s.stack,url:this.request.url});try{this.response.setHeader(T.HTTP_HEADERS.contentType,"application/json"),this.response.writeHead(500),this.response.end(JSON.stringify(o))}catch(u){console.error(`${ke.errorLogLabel} Could not write error response because headers have already been sent.`,o)}},this.request=t,this.response=r,this.route=n,this.context=i}async sendResponse({beforeResponse:t=()=>!0}={}){let r=!1;for(let s of this.preCacheRequestActions)s();let n,i;if(or.isCacheEnabled()&&(i=this.context.cacheKey||Bm.default.create(this.request,this.cacheKey),n=or.getCachedResponse(i),this.cacheKey&&(this.context.cacheKey=i),!this.validatePrefetch(n)))return console.log(`${ke.infoLogLabel} throttle ${this.request.url}`),!0;if(n)r=!0,new F.InternalTiming(F.InternalNames.edgeCache).set(F.CacheValue.hit),this.applyCachedResponse(n);else{for(let o of this.postCacheRequestActions)o();this.createResponseAction&&(await this.createResponseAction(),r=!0);for(let o of this.preCacheResponseActions)o();if(!await t(this.response))return r}if(r&&!this.streaming&&!n&&or.isCacheEnabled()){let s=or.maybeCacheResponse({response:this.response,cacheKey:i,context:this.context});new F.InternalTiming(F.InternalNames.edgeCache).set(s?F.CacheValue.cached:F.CacheValue.pass)}for(let s of this.postCacheResponseActions)s();return r&&!this.streaming&&(this.logCacheStatus(),F.addTimings(this.response),this.response.statusCode&&this.response.writeHead(this.response.statusCode,this.response.statusMessage||void 0),this.response.end(this.response.body)),r}logCacheStatus(){if(or.isCacheEnabled()){let t=this.response.getHeader(T.HTTP_HEADERS.x0CachingStatus),r=F.getInternalTiming(F.InternalNames.edgeCache),{url:n}=this.request;console.log(`${ke.infoLogLabel} ${r} ${n}${t?` (${t})`:""}`)}}applyCachedResponse(t){this.response.statusCode=t.statusCode,this.response.statusMessage=t.statusMessage,this.response.body=qc.default(t.body);for(let r of Object.keys(t.headers))this.response.setHeader(r,qc.default(t.headers[r]))}validatePrefetch(t){return Object.keys(this.request.query||{}).includes(T.THROTTLED_QUERY_PARAM)&&!t?(this.response.writeHead(T.LAYER0_UNCACHED_PREFETCH_STATUS),this.response.end(),!1):!0}async setCreateResponseAction(t){if(this.runningImmediately)await t();else{if(this.createResponseAction!=null)throw new Error("You may only call one of the following once in your route handler: proxy, serveStatic, serviceWorker, redirect, send.");this.createResponseAction=t}}get runningImmediately(){return this.runImmediatelyDepthCounter>0}clearResponseAction(){return this.createResponseAction=void 0,this}};ar.default=Mc;function Ic(e){return typeof e=="string"&&(e={domainOrIp:e}),e}});var jc=h(cr=>{"use strict";var Ym=cr&&cr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(cr,"__esModule",{value:!0});var ur=require("os"),zm=H(),Nc=Ym(Oe());function Km(e){if(Object.values(zm.BACKENDS).includes(e)||Nc.default.get(`backends.${e}`,!1))return;let t=Object.keys(Nc.default.get("backends"));throw t&&t.length?new Error(`To fix this problem use one of the "backends" configured in layer0.config.js:${ur.EOL}${ur.EOL} - ${t.join(`${ur.EOL} - `)}${ur.EOL}${ur.EOL}or add "${e}" to the "backends" property in layer0.config.js.`):new Error(`Add "${e}" to the "backends" property in layer0.config.js.`)}cr.default=Km});var pi=h(Be=>{"use strict";var Qm=Be&&Be.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},lr=Be&&Be.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Be,"__esModule",{value:!0});var fr=Qm(wa()),_=H(),Jm=lr(Yr()),Xm=lr(xa()),Zm=lr(Pn()),hi=lr(yn()),ev=lr(jc()),ve=js(),tv=Mt(),rv=60*60*24*365*10,Lc=class extends Zm.default{constructor(t,r,n,i){super(t,r,n,i);this.stream=()=>{},this.setRequestHeader=(s,o)=>{ve.validateSetRequestHeader(s),this.edgeConfig.transform.request.push({action:_.ACTIONS.setHeader,name:s,value:o})},this.updateRequestHeader=(s,o,a)=>{ve.validateUpdateRequestHeader(s),this.edgeConfig.transform.request.push({action:_.ACTIONS.updateHeader,name:s,valueRegex:o.source,replaceValue:a})},this.removeRequestHeader=s=>{ve.validateRemoveRequestHeader(s),this.edgeConfig.transform.request.push({action:_.ACTIONS.removeHeader,name:s})},this.setResponseHeader=(s,o)=>{ve.validateSetResponseHeader(s),this.edgeConfig.transform.response.push({action:_.ACTIONS.setHeader,name:s,value:o})},this.updateResponseHeader=(s,o,a)=>{ve.validateUpdateResponseHeader(s),this.edgeConfig.transform.response.push({action:_.ACTIONS.updateHeader,name:s,valueRegex:o.source,replaceValue:a})},this.removeResponseHeader=s=>{ve.validateRemoveResponseHeader(s),this.edgeConfig.transform.response.push({action:_.ACTIONS.removeHeader,name:s})},this.setUpstreamResponseHeader=(s,o)=>{s.toLowerCase()!=_.HTTP_HEADERS.x0SurrogateKey&&ve.validateSetResponseHeader(s),this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.setHeader,name:s,value:o})},this.updateUpstreamResponseHeader=(s,o,a)=>{ve.validateUpdateResponseHeader(s),this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.updateHeader,name:s,valueRegex:o.source,replaceValue:a})},this.removeUpstreamResponseHeader=s=>{ve.validateRemoveResponseHeader(s),this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.removeHeader,name:s})},this.addResponseCookie=(s,o)=>{this.edgeConfig.transform.response.push({action:_.ACTIONS.addCookie,name:s,value:o})},this.updateResponseCookie=(s,o,a)=>{this.edgeConfig.transform.response.push({action:_.ACTIONS.updateCookie,name:s,valueRegex:o.source,replaceValue:a})},this.removeResponseCookie=s=>{this.edgeConfig.transform.response.push({action:_.ACTIONS.removeCookie,name:s})},this.addUpstreamResponseCookie=(s,o)=>{this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.addCookie,name:s,value:o})},this.updateUpstreamResponseCookie=(s,o,a)=>{this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.updateCookie,name:s,valueRegex:o.source,replaceValue:a})},this.removeUpstreamResponseCookie=s=>{this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.removeCookie,name:s})},this.redirect=(s,o={})=>{let{to:a,statusCode:u,query:c}=this._readRedirectParams(s,o),l=!Xm.default(c),f=fr.getBackReferences(hi.default.pathWithQueryString(a,c));if(this.shouldParseQueryString(f)||l){this.cache({edge:{maxAgeSeconds:rv}}),this.proxy(_.BACKENDS.js);return}if(this.setEdgeRoute({action:_.ACTIONS.syntheticRes,statusCode:u}),this.edgeConfig.transform.response.push({action:_.ACTIONS.setHeader,name:_.HTTP_HEADERS.location,value:"${url}"}),this.route.criteria.path){let p=hi.default.toEdgeRegexString(this.route.criteria.path+"{(\\?[^#]+)}?"),y=fr.getBackReferences(this.route.criteria.path),m=fr.default(this.route.criteria.path,a)+`\\${Object.keys(y).length+1}`;this.edgeConfig.transform.response.push({action:_.ACTIONS.updateHeader,name:_.HTTP_HEADERS.location,valueRegex:p,replaceValue:m})}else this.edgeConfig.transform.response.push({action:_.ACTIONS.updateHeader,name:_.HTTP_HEADERS.location,valueRegex:hi.default.toEdgeRegexString("([^?]*){(\\?[^#]+)}?"),replaceValue:`${a}\\2`})},this.serveStatic=(s,{permanent:o,exclude:a,onNotFound:u,loadingPage:c,expiresSeconds:l,statusCode:f,statusMessage:d}={})=>{s&&!s.startsWith("/")&&(s=`/${s}`);let p=[],y;c&&(p.push(c),y={valueRegex:this.route.toEdgeRegexString(),replaceValue:fr.default(this.route.criteria.path,c)}),s&&this.updatePath(s),typeof s=="string"&&p.push(s);let m=o===!0||Jm.default(o,"enabled")||!1;return this.setEdgeRoute({action:_.ACTIONS.proxy,backend:m?_.BACKENDS.permanentStatic:_.BACKENDS.static,fsPath:p,fsExclude:a,fallbackToCompute:u!=null,loadingPage:y,expiresSeconds:l,statusMessage:d,statusCode:f}),Promise.resolve()},this.proxy=(s,{path:o,transformResponse:a,transformRequest:u}={})=>(ev.default(s),a!=null||u!=null||typeof o=="function"?s=_.BACKENDS.js:typeof o=="string"&&this.updatePath(o),this.setEdgeRoute({action:_.ACTIONS.proxy,backend:s}),Promise.resolve()),this.updatePath=s=>{let o=fr.default(this.route.criteria.path,s);o[0]!=="/"&&(o=`/${o}`),this.edgeConfig.transform.request.push({action:_.ACTIONS.updatePath,valueRegex:this.route.toEdgeRegexString(),replaceValue:o})},this.cache=s=>{let{edge:o,browser:a,key:u}=s;if(o){let{maxAgeSeconds:c,staleWhileRevalidateSeconds:l,forcePrivateCaching:f}=o;this.edgeConfig.cache={maxAgeSeconds:c,staleWhileRevalidateSeconds:l,forcePrivateCaching:f}}else o===!1&&(this.edgeConfig.cache={disabled:!0});if(u&&(this.edgeConfig.cache||(this.edgeConfig.cache={}),this.edgeConfig.cache.customKey=u.toJSON()),a||a===!1){let{maxAgeSeconds:c,serviceWorkerSeconds:l}=a||{maxAgeSeconds:0};c===0?this.edgeConfig.transform.response.push({action:_.ACTIONS.setHeader,name:_.HTTP_HEADERS.cacheControl,value:"private, no-store, no-cache"}):c&&this.edgeConfig.transform.response.push({action:_.ACTIONS.setHeader,name:_.HTTP_HEADERS.cacheControl,value:`private, max-age=${c}`}),l&&this.edgeConfig.transform.response.push({action:_.ACTIONS.setHeader,name:_.HTTP_HEADERS.xSwCacheControl,value:`max-age=${l}`})}},this.send=(s,o=200,a)=>{typeof s=="function"?this.render():this.setEdgeRoute({action:_.ACTIONS.syntheticRes,statusCode:o,statusMessage:a,content:s})},this.compute=s=>{this.setEdgeRoute({action:_.ACTIONS.proxy,backend:_.BACKENDS.js})},this.render=()=>(this.setEdgeRoute({action:_.ACTIONS.proxy,backend:_.BACKENDS.js}),Promise.resolve()),this.edgeConfig={transform:{request:[],upstreamResponse:[],response:[]}}}shouldParseQueryString(t){let r=this.route.criteria.query;return r===void 0?!1:Object.keys(r).some(n=>{let i=r[n];return tv.isParamMatcher(i)&&!!t[n]})}setEdgeRoute(t){this.edgeConfig.route=t,this.edgeConfig.transform.upstreamResponse.push({action:_.ACTIONS.setHeader,name:_.HTTP_HEADERS.vary,value:_.HTTP_HEADERS.acceptEncoding})}};Be.default=Lc});var gi=h(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});var $c=class{constructor(){this.forcePrivateCaching=!1}};yi.default=$c});var kc=h(dr=>{"use strict";var nv=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dr,"__esModule",{value:!0});var sv=nv(pi()),Fc=class extends sv.default{constructor(){super(...arguments);this.proxy=(t,r={})=>{throw new Error("Proxy cannot be used inside router.catch()")}}};dr.default=Fc});var Bc=h((GE,iv)=>{iv.exports={_from:"@layer0/core@^3.3.0",_id:"@layer0/core@3.16.4",_inBundle:!1,_integrity:"sha512-k5HnwWCT45+SFAZxM6MaBSBfnSmJdqyHNWvlZBp+aRzRos5hb8yrGCFpGhLlOuBMBvAmXxsnXE1H4JylIyE7bA==",_location:"/@layer0/core",_phantomChildren:{"fast-glob":"3.2.7",isexe:"2.0.0",merge2:"1.4.1"},_requested:{type:"range",registry:!0,raw:"@layer0/core@^3.3.0",name:"@layer0/core",escapedName:"@layer0%2fcore",scope:"@layer0",rawSpec:"^3.3.0",saveSpec:null,fetchSpec:"^3.3.0"},_requiredBy:["#DEV:/"],_resolved:"https://registry.npmjs.org/@layer0/core/-/core-3.16.4.tgz",_shasum:"c6bca5465a4c83eed98431d289951efc88ddd4f4",_spec:"@layer0/core@^3.3.0",_where:"C:\\Reactstorefront\\base_reactstorefront\\AK-React-Base",bundleDependencies:!1,dependencies:{"@babel/parser":"^7.13.15","@babel/traverse":"^7.13.15","@types/lodash.clonedeep":"^4.5.6",ajv:"^6.12.6","babel-loader":"^8.2.2",chalk:"^2.4.2",chokidar:"^3.5.1","cls-hooked":"^4.2.2","content-type":"^1.0.4",cookie:"^0.4.1","cross-spawn":"^7.0.3","decode-uri-component":"^0.2.0",deepmerge:"^4.2.2",esbuild:"^0.11.15",express:"^4.17.1","fs-extra":"^8.1.0",globby:"^11.0.2","http-proxy":"^1.18.1","lodash.clonedeep":"^4.5.0","lru-cache":"^6.0.0","mime-types":"^2.1.29","node-fetch":"^2.6.1","path-to-regexp":"^6.2.0",pino:"^6.11.2","resolve-package-path":"^2.0.0",shelljs:"^0.8.4",slash:"^3.0.0","tcp-port-used":"^1.0.2","ts-loader":"^8.2.0",uuid:"^8.3.2"},deprecated:!1,description:"Core library for the [Layer0](https://docs.layer0.co), infrastructure to run your big, dynamic website frontend and make it load in less than one second.",devDependencies:{"@types/cls-hooked":"^4.3.1","@types/content-type":"^1.1.3","@types/cookie":"^0.3.3","@types/cross-spawn":"^6.0.2","@types/decode-uri-component":"^0.2.0","@types/express":"^4.17.7","@types/fs-extra":"^8.1.1","@types/http-proxy":"^1.17.4","@types/lodash":"^4.14.162","@types/lru-cache":"^5.1.0","@types/mime-types":"^2.1.0","@types/node":"^14.6.4","@types/route-parser":"^0.1.3","@types/shelljs":"^0.8.8","@types/tcp-port-used":"^1.0.0","@types/uuid":"^8.0.1","@types/webpack-bundle-analyzer":"^3.9.0",lodash:"^4.17.21",webpack:"^5.27.0","webpack-bundle-analyzer":"^3.9.0","webpack-dev-middleware":"^4.1.0"},jest:{clearMocks:!0,collectCoverage:!0,transform:{"^.+\\.(js)?$":"babel-jest","^.+\\.ts$":"ts-jest"},moduleFileExtensions:["ts","js","json"],setupFilesAfterEnv:["<rootDir>/test/jest.js"],transformIgnorePatterns:["<rootDir>/node_modules/"],moduleNameMapper:{"../package.json":"<rootDir>/package.json","^@layer0/core(.*)$":"<rootDir>/src/$1"},collectCoverageFrom:["./src/**/*.{ts,js}","!**/mocks/**","!**/index.ts","!**/plugins/PluginBase.ts","!**/bin/**/*"]},license:"UNLICENSED",main:"./index.js",name:"@layer0/core",publishConfig:{directory:"dist"},scripts:{build:"rm -rf ./dist; mkdir ./dist; cp -r package.json README.md serverless.yml default-app ./dist; tsc; npm run bundle-handler;","bundle-handler":"esbuild src/lambda/handler.ts --bundle --minify --platform=node --target=node14.0 --outfile=dist/lambda/handler.js --log-level=error --sourcemap",docs:"typedoc","push-build":"npm run build && cd dist && yalc push && cd ..",release:"cd ./dist; npm publish --access public","release:next":"npm run release -- --tag next",test:"jest --watchAll=false --runInBand --forceExit","ts:watch":"tsc --watch",watch:"npm-watch"},version:"3.16.4",watch:{"push-build":{patterns:["src","bin","serverless.yml","default-app","package.json"],extensions:["js","ts"],quiet:!1}}}});var Yc=h(hr=>{"use strict";var Ue=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hr,"__esModule",{value:!0});var ov=Ue(Oe()),Uc=Ue(Qr()),av=Ue(_a()),mi=Ue(Ea()),uv=Ue(pi()),cv=H(),Wc=Ue(gi()),lv=Mt(),fv=Ue(kc());function dv({edgeConfig:e},t){var r,n;return e.cache&&((r=e.cache)===null||r===void 0?void 0:r.maxAgeSeconds)&&((n=e.cache)===null||n===void 0?void 0:n.maxAgeSeconds)>0&&t?O(S({},e.cache),{matchExplicitMethod:t}):e.cache}function hv({edgeConfig:e}){return e.route}function pv({edgeConfig:e}){return e.transform}function yv(e){var t;let r=[],n=[],i,s;if(e.criteria.protocol){let o;if(typeof e.criteria.protocol=="string"?o=new RegExp(`^${e.criteria.protocol}$`,"i"):o=new RegExp(e.criteria.protocol),!o.test("http")&&!o.test("https"))throw new Error('Protocol matcher must match either "http" or "https"');i=o.source}if(e.criteria.path&&r.push({value:"${path}",matchRegex:e.toEdgeRegexString()}),e.criteria.method){let o;typeof e.criteria.method!="string"?o=e.criteria.method:(o=av.default(e.criteria.method),Object.values(cv.HTTP_METHODS).includes(e.criteria.method)&&(s=e.criteria.method)),r.push({value:"${method}",matchRegex:Uc.default(o)})}return e.criteria.headers&&Object.entries(e.criteria.headers).forEach(([o,a])=>{r.push({value:`\${req:${o}}`,matchRegex:mi.default(a)})}),((t=e.criteria.response)===null||t===void 0?void 0:t.statusCode)&&n.push({value:"${resp:status}",matchRegex:Uc.default(e.criteria.response.statusCode)}),e.criteria.query&&Object.entries(e.criteria.query).forEach(([o,a])=>{lv.isParamMatcher(a)||r.push({value:`\${query:${o}}`,matchRegex:mi.default(a)})}),e.criteria.cookies&&Object.entries(e.criteria.cookies).forEach(([o,a])=>{r.push({value:`\${req:cookie:${o}}`,matchRegex:mi.default(a)})}),{match:r,matchResp:n,matchExplicitMethod:s,matchProtocolJavaScriptRegExpSource:i}}async function gv(e){let t={};if(!Object.keys(e.getDestinations()).length)t={default:await Vc(e)};else for(let r in e.getDestinations())t[r]=await Vc(e.getDestinations()[r]);return{version:mv(),backends:S({},ov.default.get("backends")),destinations:t}}hr.default=gv;function mv(){return Bc().version}async function Gc(e,t,r){try{await e.handler(t)}catch(a){Error.captureStackTrace(a),r.push({route:e.toString(),stackTrace:a.stack})}let{match:n,matchResp:i,matchExplicitMethod:s,matchProtocolJavaScriptRegExpSource:o}=yv(e);return{path:e.criteria.path,routeJson:e.toJson(),match:n,matchResp:i,matchProtocolJavaScriptRegExpSource:o,cache:dv(t,s),route:hv(t),transform:pv(t)}}async function Vc(e){let t=[],r={index:e.index,errorRoutes:await Promise.all(e.getRouteGroups().getRoutes().filter(n=>n.isRespRoute()).map(n=>Gc(n,new fv.default({url:"",headers:{}},{},n,new Wc.default),t))),routes:await Promise.all(e.getRouteGroups().getRoutes().filter(n=>!n.isRespRoute()).map(n=>Gc(n,new uv.default({url:"",headers:{}},{},n,new Wc.default),t)))};if(t.length){let n=`
Errors occurred while attempting to deploy your application to Layer0 edge.
The following ${t.length>1?"routes":"route"} could not be processed:`;throw t.forEach(({route:i,stackTrace:s})=>{n=n.concat(`
* ${i}: ${s}`)}),new Error(n)}return r}});var zc=h(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});function vv(e,t){if(!e||!e.length)return;let r,n,i=!1;for(let s of e){if(!i){r=s,t&&(n=t(s)),i=!0;continue}if(t){let o=t(s);o<n&&(r=s,n=o)}else s<r&&(r=s)}return r}vi.default=vv});var Qc=h(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});var Kc=class{constructor(){this._tasks=[],this._resolveHandler=Function.prototype,this._errorHandler=t=>{throw t}}add(...t){return this._tasks.push(...t),this}onTaskDone(t){return this._resolveHandler=t,this}onTaskError(t){return this._errorHandler=t,this}resolve(){let t=this._convertTasksToPromises().map((r,n)=>r.then(i=>(this._resolveHandler(i),i)).catch(i=>this._errorHandler(i)));return Promise.all(t)}_convertTasksToPromises(){return this._tasks.map(t=>{if(typeof t!="function")return Promise.resolve(t);try{let r=t();return r instanceof Promise?r:Promise.resolve(r)}catch(r){return Promise.reject(r)}})}};_i.default=Kc});var Zc=h(yr=>{"use strict";var Jc=yr&&yr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yr,"__esModule",{value:!0});var _v=Jc(Oe()),Xc=Jc(Qc()),pr=class{constructor(){this.options=[]}push(...t){this.options.push(...t)}static async resolveDestinationPreloadConfig(t,r){let n=[];return await new Xc.default().add(...t.preloadRequests.options).onTaskDone(i=>{n.push(...i.map(s=>O(S({},s),{destination:r})))}).resolve(),{requests:n}}static async resolvePreloadConfig(t){let r=[],n=new Xc.default,i=t.getDestinations();if(!Object.keys(i).length)n.add(pr.resolveDestinationPreloadConfig(t,"default"));else for(let s in i)n.add(pr.resolveDestinationPreloadConfig(i[s],s));return await n.onTaskDone(({requests:s})=>{r.push(...s)}).resolve(),{requests:r,concurrency:_v.default.get("prerenderConcurrency",null)}}};yr.default=pr});var el=h(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});function Rv(e){return new Promise(t=>{e.body="",e.on("data",r=>e.body+=r.toString()),e.on("end",t)})}Ri.default=Rv});var tl=h(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});function Ev(){return process.env.LAYER0_ROOT_SOURCE_DIR||process.cwd()}On.getSourceDir=Ev;function bv(e){process.env.LAYER0_ROOT_SOURCE_DIR=e}On.setSourceDir=bv});var bi=h(_e=>{"use strict";var Hn=_e&&_e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_e,"__esModule",{value:!0});var Sv=Hn(yn()),Cv=ui(),Ei=Xe(),rl=require("path"),nl=Hn(ie()),Av=Hn($s()),gr=H(),wv=tl(),sl=Hn(Vn());_e.staticAssetManifest={};_e.STATIC_ASSET_MANIFEST_FILE="static-asset-manifest.json";var il=class{constructor(t){if(this._routes=[],!t)throw new Error("Route group name is required!");this.name=t}match(t,r,{index:n,label:i}={}){let s=new Sv.default(t,r,{label:i});return n!=null?this._routes.splice(n,0,s):this._routes.push(s),this}dir(t,r){let n=rl.join(wv.getSourceDir(),t),i=_e.staticAssetManifest[sl.default(t)]=[],{ignore:s,label:o}=r;typeof s=="string"&&(s=[s]);let a=Ei.isCloud()?this.staticAssetsForPath(t):nl.default("globby").sync(r.glob||"**/*",{cwd:n,onlyFiles:!0,ignore:s||[]});r.sort&&(a=r.sort(a));for(let u of a){let c=r.paths&&r.paths(u)||[`/${u}`];Ei.isCloud()||i.push(sl.default(u));for(let l of c){let f=l.replace(/\/index.html$/,"");f.length===0&&(f="/"),this.match(f,async d=>{r.handler&&r.handler(u)(d)},{label:o})}}return this}static(t,r){let n=i=>s=>{r.handler&&r.handler(i)(s),s.serveStatic(`${t}/${i}`)};return this.dir(t,O(S({},r),{handler:n,label:`static('${t}')`}))}requireBasicAuth(t){let{route:r,username:n,password:i,realm:s="Access to the site"}=t;if(n&&i){let o=Buffer.from(`${n}:${i}`).toString("base64");r=Av.default(r),this.match(O(S({},r),{headers:O(S({},r.headers),{[gr.HTTP_HEADERS.authorization]:null,[gr.HTTP_HEADERS.x0MatchedRoutes]:null})}),({send:a,setResponseHeader:u})=>{u("WWW-Authenticate",`Basic realm="${s}"`),a("",401,"Unauthorized")}).match(O(S({},r),{headers:O(S({},r.headers),{[gr.HTTP_HEADERS.authorization]:new RegExp(`^((?!Basic ${o}).)*$`),[gr.HTTP_HEADERS.x0MatchedRoutes]:null})}),({send:a})=>{a("",403,"Forbidden")}).match(O(S({},r),{headers:O(S({},r.headers),{[gr.HTTP_HEADERS.x0MatchedRoutes]:null})}),({removeRequestHeader:a})=>{a("authorization")})}return this}staticAssetsForPath(t){return nl.default(rl.join(process.cwd(),_e.STATIC_ASSET_MANIFEST_FILE))[t]}clear(){return this._routes=[],Ei.isCloud()||Cv.clearCache(),this}get routes(){return this._routes}get length(){return this._routes.length}};_e.default=il});var al=h(mr=>{"use strict";var xv=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mr,"__esModule",{value:!0});var Tv=xv(bi()),Pv=H(),ol=class{constructor(){this.routeGroups=[]}add(t){return this.routeGroups.push(t),this}getGroups(){return this.routeGroups}findByName(t){return this.routeGroups.find(r=>r.name===t)}getRoutes(){let t=[];return this.getGroups().forEach(r=>{t=t.concat(r.routes)}),this.fallback&&(t=t.concat(this.fallback.routes)),t}setFallback(t){let r=new Tv.default(Pv.ROUTES_FALLBACK);r.match(null,t),this.fallback=r}get length(){return this.routeGroups.length}};mr.default=ol});var fl=h(We=>{"use strict";var se=We&&We.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ov=We&&We.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(We,"__esModule",{value:!0});var v=H(),ul=Xn(),Hv=Wo(),Dv=se(sa()),qv=se(ia()),Mv=se(Oe()),Iv=se(Yc()),Nv=se(As()),jv=se(zc()),cl=se(Zc()),Lv=se(el()),$v=se(gi()),Fv=se(Pn()),ll=Ov(bi()),kv=se(al()),vt=class{constructor(t={excludeBuiltInRoutes:!1}){this.routeGroups=new kv.default,this.preloadRequests=new cl.default,this.plugins=[],this.destinations={},this.nextRouterIndex=0,this._index=0,this.processRequestHeaders=r=>{r.headers[v.HTTP_HEADERS.xRequestId]||(this.newRequestId=Hv.v4(),r.headers[v.HTTP_HEADERS.xRequestId]=this.newRequestId);let n=r.headers[v.HTTP_HEADERS.acceptEncoding];typeof n=="string"&&/gzip/.test(n)?r.headers[v.HTTP_HEADERS.acceptEncoding]="gzip":delete r.headers[v.HTTP_HEADERS.acceptEncoding];let i=r.connection,s="127.0.0.1";if(i&&i.remoteAddress){if(s=i.remoteAddress,r.headers[v.HTTP_HEADERS.x0Protocol]!=="http"){let o=r.headers[v.HTTP_HEADERS.cookie];typeof o=="string"&&/\blocal_layer0_emulate_http_protocol=true\b/.test(o)?r.headers[v.HTTP_HEADERS.x0Protocol]="http":r.headers[v.HTTP_HEADERS.x0Protocol]="https"}}else r.headers[v.HTTP_HEADERS.x0Protocol]||(r.headers[v.HTTP_HEADERS.x0Protocol]="https");r.headers[v.HTTP_HEADERS.xForwardedFor]?r.headers[v.HTTP_HEADERS.xForwardedFor]=`${r.headers[v.HTTP_HEADERS.xForwardedFor]}, ${s}`:r.headers[v.HTTP_HEADERS.xForwardedFor]=`${s}`,r.headers[v.HTTP_HEADERS.x0ClientIp]||(r.headers[v.HTTP_HEADERS.x0ClientIp]=r.headers[v.HTTP_HEADERS.xForwardedFor].split(",")[0]),vt.isRequestFromEdge(r)||(this.processRequestDeviceHeaders(r),this.processRequestGeoHeaders(r))},this.processRequestDeviceHeaders=r=>{let n="desktop",i="generic",s=!1,o="generic",a=(r.headers[v.HTTP_HEADERS.userAgent]||"").toLowerCase();/ipad/.test(a)?(n="tablet",i="apple"):/ip(hone|od)/.test(a)?(n="smartphone",i="apple"):/android.*(mobile|mini)/.test(a)?(n="smartphone",i="android"):/android/.test(a)?(n="tablet",i="android"):/opera mobi/.test(a)?(n="smartphone",i="android"):/playbook u rim tablet/.test(a)?(n="tablet",i="blackberry"):/hp-tablet.*touchpad/.test(a)?(n="tablet",i="hp"):/kindle\/3/.test(a)?(n="tablet",i="kindle"):/mobile.+firefox/.test(a)?(n="mobile",i="firefoxos"):/^htc/.test(a)?(n="smartphone",i="htc"):/fennec/.test(a)?(n="smartphone",i="fennec"):/iemobile/.test(a)?(n="smartphone",i="microsoft"):/blackberry/.test(a)||/bb10.*mobile/.test(a)?(n="smartphone",i="blackberry"):/gt-.*build\/gingerbread/.test(a)?(n="smartphone",i="android"):/symbianos.*applewebkit/.test(a)?(n="smartphone",i="symbian"):(/symbian/.test(a)||/^sonyericsson/.test(a)||/^nokia/.test(a)||/^samsung/.test(a)||/^lg/.test(a)||/bada/.test(a)||/blazer/.test(a)||/cellphone/.test(a)||/midp-2.0/.test(a)||/u990/.test(a)||/netfront/.test(a)||/opera mini/.test(a)||/palm/.test(a)||/nintendo wii/.test(a)||/playstation portable/.test(a)||/portalmmm/.test(a)||/proxinet/.test(a)||/sonyericsson/.test(a)||/windows ?ce/.test(a)||/winwap/.test(a)||/eudoraweb/.test(a)||/240x320/.test(a)||/avantgo/.test(a))&&(n="mobile"),/bot/.test(a)||/crawler/.test(a)||/headless/.test(a)||/prerender/.test(a)||/preview/.test(a)||/scanner/.test(a)||/slurp/.test(a)||/spider/.test(a)||/(developers.google.com\/+\/web\/snippet|embedly|facebookexternalhit|flipboard|googlepagespeed|google page speed)/.test(a)||/(ia_archiver|moov-prerender-cache-exerciser|nuzzel|outbrain|pinterest|qwantify|tumblr|vkshare)/.test(a)||/(w3c_validator|whatsapp|xing-contenttabreceiver|yahoo)/.test(a)?s=!0:s=!1,/edge/.test(a)?o="edge":/chrome|chromium|crios/.test(a)?o="chrome":/firefox/.test(a)?o="firefox":/opera|opr/.test(a)?o="opera":/msie/.test(a)||/trident/.test(a)?o="msie":/safari/.test(a)&&(o="safari"),r.headers[v.HTTP_HEADERS.x0Device]=n,r.headers[v.HTTP_HEADERS.x0DeviceIsBot]=s?"1":"0",r.headers[v.HTTP_HEADERS.x0Vendor]=i,r.headers[v.HTTP_HEADERS.x0Browser]=o},this.processRequestGeoHeaders=r=>{r.headers[v.HTTP_HEADERS.x0GeoCity]="San Francisco",r.headers[v.HTTP_HEADERS.x0GeoCountryCode]="US",r.headers[v.HTTP_HEADERS.x0GeoLatitude]="37.792094",r.headers[v.HTTP_HEADERS.x0GeoLongitude]="-122.401622",r.headers[v.HTTP_HEADERS.x0GeoPostalCode]="94104"},this.isUserHeaderCountWithinLimits=r=>Object.keys(r).filter(i=>i.toLowerCase().indexOf(v.LAYER0_HEADERS_PREFIX)!==0).length<=v.LAYER0_MAX_USER_HEADERS_ALLOWED,this.patchResWriteHead=(r,n)=>{let i=n.writeHead;n.writeHead=(...s)=>{n.writeHead=i,this.newRequestId&&n.setHeader(v.HTTP_HEADERS.xRequestId,this.newRequestId);let a=s[2];if(a)for(let u of Object.keys(a))n.setHeader(u,Nv.default(r,n,a[u]));if(this.isUserHeaderCountWithinLimits(n.getHeaders())){n.writeHead(...s);return}n.writeHead(v.LAYER0_TOO_MANY_HEADERS_STATUS_CODE,"Too many response headers")}},this.run=async(r,n)=>{let i=new ul.InternalTiming(ul.InternalNames.routeMatching).start(),s=this,o=new $v.default;if(this.processRequestHeaders(r),!this.isUserHeaderCountWithinLimits(r.headers)){n.writeHead(v.LAYER0_TOO_MANY_HEADERS_STATUS_CODE,"Too many request headers"),n.end();return}if(await Lv.default(r),this.patchResWriteHead(r,n),Object.keys(this.destinations).length>1){let{LAYER0_ROUTER_DESTINATION:l}=process.env,f=r.headers[v.HTTP_HEADERS.x0Destination]||l;if(f||(f=jv.default(Object.keys(this.destinations),d=>this.destinations[d]._index)),s=this.destinations[f],!s)throw new Error(`Routing destination "${f}" not found.`)}s.plugins.forEach(l=>l.onRequest(r));let a=l=>{let f=new Fv.default(r,n,l,o);return vt.isRequestFromEdge(r)?qv.default.create(f):f},u=s.routeGroups.getRoutes().filter(l=>!l.isRespRoute()),c=s.routeGroups.getRoutes().filter(l=>l.isRespRoute());for(let l of u){let f;try{if(!l.match(r))continue;f=a(l),i.pause(),await l.handler(f);let d=await f.sendResponse({beforeResponse:async p=>{if(!vt.isRequestFromEdge(r)){i.ended&&i.resume();for(let y of c)if(!!y.matchResponse(p))return f=a(y),i.pause(),await y.handler(f),f.sendResponse(),!1}return!0}});if(i.resume(),d)return}catch(d){f=f||a(r,n,l,o),f.onRouteError(d);return}}i.end(),this.builtInFallback(r,n)},t.excludeBuiltInRoutes||Dv.default(this)}getStaticAssetManifest(){return ll.staticAssetManifest}setBackend(t,r){return Mv.default.get("backends")[t]=r,this}use(t){return t.onRegister(this),this.plugins.push(t),this}destination(t,r){return r.setIndex(this.nextRouterIndex++),this.destinations[t]=r,this}getPlugins(){let t=this.plugins;for(let r of Object.values(this.destinations))t=t.concat(r.getPlugins());return t}setIndex(t){this._index=t}get index(){return this._index}group(t,r){let n=new ll.default(t);return r(n),this.routeGroups.add(n),this}match(t,r){return this.group("root",n=>n.match(t,r))}prerender(...t){return this.preloadRequests.push(...t),this}matchMethod(t,r,n){if(typeof r=="string")return this.match({method:t,path:r},n);if(r.method)throw new Error(`Invalid criteria property method passed to call to Router#${t}. Specifying a method in the criteria is redundant.`);return this.match(O(S({},r),{method:t}),n)}head(t,r){return this.matchMethod(v.HTTP_METHODS.head,t,r)}get(t,r){return this.matchMethod(v.HTTP_METHODS.get,t,r)}post(t,r){return this.matchMethod(v.HTTP_METHODS.post,t,r)}delete(t,r){return this.matchMethod(v.HTTP_METHODS.delete,t,r)}put(t,r){return this.matchMethod(v.HTTP_METHODS.put,t,r)}patch(t,r){return this.matchMethod(v.HTTP_METHODS.patch,t,r)}options(t,r){return this.matchMethod(v.HTTP_METHODS.options,t,r)}fallback(t){return this.routeGroups.setFallback(t),this}catch(t,r){let n;return t instanceof RegExp?n=t:n=new RegExp(`^${t.toString()}$`),this.group(v.ROUTES_CATCH_GROUP,i=>i.match({headers:{"x-0-error-status-code":n},response:{statusCode:n}},async s=>{await r(s),s.cache({edge:!1,browser:{maxAgeSeconds:0}})})),this}builtInFallback(t,r){let n=t.connection;n&&n.remoteAddress?r.writeHead(404):t.headers[v.HTTP_HEADERS.x0Protocol]==="http"?(r.setHeader(v.HTTP_HEADERS.location,`https://${t.headers[v.HTTP_HEADERS.host]}${t.url}`),r.writeHead(301)):r.writeHead(404),r.end()}static(t,r={}){return this.group("root",n=>n.static(t,r))}requireBasicAuth(t){return this.group("root",r=>r.requireBasicAuth(t))}createEdgeConfig(){return Iv.default(this)}createPreloadConfig(){return cl.default.resolvePreloadConfig(this)}getDestinations(){return this.destinations}getRouteGroups(){return this.routeGroups}toString(){return`Routes
======
`+this.routeGroups.getRoutes().map((t,r)=>`${r}:	${t.toString()}`).join(`
`)}static isRequestFromEdge(t){return typeof t.headers[v.HTTP_HEADERS.x0Version]=="string"}};We.default=vt});var hl=h(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});var dl=class{constructor(t){this.name=t}byPattern(t){this.pattern=t}toJSON(){if(!this.pattern)throw new Error("byPattern is required for group "+this.name);return{groupedValue:this.name,matchRegex:this.pattern.source}}};Si.default=dl});var yl=h(vr=>{"use strict";var Bv=vr&&vr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vr,"__esModule",{value:!0});var Uv=Bv(hl()),pl=class{constructor(){this.groups=[],this.name=null}group(t){let r=new Uv.default(t);return this.groups.push(r),r}toJSON(){return this.groups.map(t=>t.toJSON())}};vr.default=pl});var Ci=h(Z=>{"use strict";var Wv=Z&&Z.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Z,"__esModule",{value:!0});var gl=Wv(yl()),Gv=tn();Z.CUSTOM_CACHE_KEY_ACTIONS={blacklistAll:"blacklist-all-query-parameters",blacklistSome:"blacklist-some-query-parameters",whitelistSome:"whitelist-some-query-parameters",addValue:"add-value",removeMethod:"remove-method",removeBody:"remove-body"};var Dn=class{constructor(){this.config=[],this.actions=[]}clone(){let t=new Dn;return t.actions=this.actions,t.config=this.config,t}excludeAllQueryParameters(){return this.config.push({action:Z.CUSTOM_CACHE_KEY_ACTIONS.blacklistAll}),this.actions.push((t,r)=>{t.query={}}),this}excludeQueryParameters(...t){return this.config.push({action:Z.CUSTOM_CACHE_KEY_ACTIONS.blacklistSome,names:t}),this.actions.push((r,n)=>{for(let i of t)delete r.query[i]}),this}excludeAllQueryParametersExcept(...t){return this.config.push({action:Z.CUSTOM_CACHE_KEY_ACTIONS.whitelistSome,names:t}),this.actions.push((r,n)=>{let i=new Set(t);for(let s in r.query)i.has(s)||delete r.query[s]}),this}addHeader(t,r){return this.actions.push((n,i)=>{let s=i.headers[t];Array.isArray(s)||(s=[s]),r?n.headers[t]=this.createGroupedValue(r,s):n.headers[t]=s}),this.addValue(`\${req:${t}}`,r)}removeMethod(){return this.actions.push((t,r)=>{t.method=void 0}),this.config.push({action:Z.CUSTOM_CACHE_KEY_ACTIONS.removeMethod}),this}removeBody(){return this.actions.push((t,r)=>{t.body=void 0}),this.config.push({action:Z.CUSTOM_CACHE_KEY_ACTIONS.removeBody}),this}createGroupedValue(t,r){let n=new gl.default,i=[];t(n);let s=this.findMatchingGroup(n,r);return s?i.push(s):i.push(...r),i}findMatchingGroup(t,r){var n;for(let i of t.groups)for(let s of r)if((n=i.pattern)===null||n===void 0?void 0:n.test(s))return i.name}addDevice(){return this.addHeader("x-0-device")}addVendor(){return this.addHeader("x-0-vendor")}addIsBot(){return this.addHeader("x-0-device-is-bot")}addBrowser(){return this.addHeader("x-0-browser")}addCookie(t,r){return this.actions.push((n,i)=>{let s=i.headers.cookie||"";Array.isArray(s)&&(s=s.join(";"));let a=Gv.parse(s)[t];r?n.cookies[t]=this.createGroupedValue(r,[a]):n.cookies[t]=a}),this.addValue(`\${req:cookie:${t}}`,r)}addValue(t,r){let n={action:Z.CUSTOM_CACHE_KEY_ACTIONS.addValue,value:t};if(r!=null){let i=new gl.default;r(i),n.groups=i.toJSON()}return this.config.push(n),this}getActions(){return this.actions}toJSON(){return this.config}};Z.default=Dn});var ml=h(_r=>{"use strict";var Vv=_r&&_r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_r,"__esModule",{value:!0});var Yv=Vv(Ci());function zv(){return new Yv.default}_r.default=zv});var Ai=h(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});var Kv=fl();_t.Router=Kv.default;var Qv=Ci();_t.CustomCacheKey=Qv.default;var Jv=Pn();_t.ResponseWriter=Jv.default;var Xv=ml();_t.createCustomCacheKey=Xv.default});var wi=h((ob,vl)=>{"use strict";vl.exports=e=>{let t=/^\\\\\?\\/.test(e),r=/[^\u0000-\u0080]+/.test(e);return t||r?e:e.replace(/\\/g,"/")}});var xi=h(Ce=>{"use strict";var Zv=Ce&&Ce.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ce,"__esModule",{value:!0});var _l=Zv(wi());Ce.toCleanPath=e=>_l.default(`/${e.replace(/\.[^.]*$/,"").replace(/(^|)\/?index$/,"")}`);Ce.toRouteSyntax=(e,{suffix:t,locale:r}={})=>{let n=_l.default(e.replace(/^\//,"").replace(/\[\[\.\.\.([^\]]+)\]\]/g,":$1*").replace(/\[\.\.\.([^\]]+)\]/g,":$1+").replace(/\[([^\]]+)\]/g,":$1"));return r&&(n=`${r}/${n}`),t?(n===""&&(n="index"),`/${n}.${t}`):Ce.toCleanPath(n)};function e_(e,t){return e?`/:locale(${e.join("|")})?${t}`.replace(/\/$/,"").replace(/\)\?\/(index)?\.(json|html)$/,"|index).json"):t}Ce.localize=e_});var Rl=h(Rr=>{"use strict";var t_=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rr,"__esModule",{value:!0});var r_=t_(ie()),n_=require("path");function s_(){let e=process.cwd(),t=n_.join(e,"next.config.js"),r;try{r=r_.default(t)}catch(n){}return typeof r=="function"&&(r=r("phase-production-build",{})),(r==null?void 0:r.distDir)||".next"}Rr.default=s_});var bl=h(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});var El=class{onRegister(t){}onRequest(t){}};Ti.default=El});var Sl=h(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});function i_(e){if(/text\/html/i.test(e.getHeader("Content-Type"))){let{body:t}=e,r=[],n=/<link rel="preload" href="([^"]*)".+?(?=>)/gis,i=/as="([^"]*)"/i,s;if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),typeof t=="string")for(;s=n.exec(t);){let u=i.exec(s[0]);r.push({uri:s[1],as:u&&u[1]})}let o=r.map(o_).join(", "),a=e.getHeader("link");a?e.setHeader("link",`${a}, ${o}`):o.length&&e.setHeader("link",o)}}Pi.default=i_;function o_(e){let{uri:t,as:r}=e,n=t.split("?")[0];return r||(n.toLowerCase().endsWith(".css")?r="style":n.toLowerCase().match(/(woff|woff2|truetype|opentype|embedded-opentype)$/)?r="font":r="script"),`<${n}>; as=${r}; rel=preload`}});var Al=h((fb,Cl)=>{"use strict";Cl.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;t[r]=i;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var s=Object.getOwnPropertySymbols(t);if(s.length!==1||s[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,r);if(o.value!==i||o.enumerable!==!0)return!1}return!0}});var Tl=h((db,xl)=>{"use strict";var wl=typeof Symbol!="undefined"&&Symbol,a_=Al();xl.exports=function(){return typeof wl!="function"||typeof Symbol!="function"||typeof wl("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:a_()}});var Ol=h((hb,Pl)=>{"use strict";var u_="Function.prototype.bind called on incompatible ",Oi=Array.prototype.slice,c_=Object.prototype.toString,l_="[object Function]";Pl.exports=function(t){var r=this;if(typeof r!="function"||c_.call(r)!==l_)throw new TypeError(u_+r);for(var n=Oi.call(arguments,1),i,s=function(){if(this instanceof i){var l=r.apply(this,n.concat(Oi.call(arguments)));return Object(l)===l?l:this}else return r.apply(t,n.concat(Oi.call(arguments)))},o=Math.max(0,r.length-n.length),a=[],u=0;u<o;u++)a.push("$"+u);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var c=function(){};c.prototype=r.prototype,i.prototype=new c,c.prototype=null}return i}});var qn=h((pb,Hl)=>{"use strict";var f_=Ol();Hl.exports=Function.prototype.bind||f_});var ql=h((yb,Dl)=>{"use strict";var d_=qn();Dl.exports=d_.call(Function.call,Object.prototype.hasOwnProperty)});var jn=h((gb,jl)=>{"use strict";var E,Er=SyntaxError,Ml=Function,Rt=TypeError,Hi=function(e){try{return Ml('"use strict"; return ('+e+").constructor;")()}catch(t){}},Ge=Object.getOwnPropertyDescriptor;if(Ge)try{Ge({},"")}catch(e){Ge=null}var Di=function(){throw new Rt},h_=Ge?function(){try{return arguments.callee,Di}catch(e){try{return Ge(arguments,"callee").get}catch(t){return Di}}}():Di,Et=Tl()(),Ae=Object.getPrototypeOf||function(e){return e.__proto__},bt={},p_=typeof Uint8Array=="undefined"?E:Ae(Uint8Array),St={"%AggregateError%":typeof AggregateError=="undefined"?E:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?E:ArrayBuffer,"%ArrayIteratorPrototype%":Et?Ae([][Symbol.iterator]()):E,"%AsyncFromSyncIteratorPrototype%":E,"%AsyncFunction%":bt,"%AsyncGenerator%":bt,"%AsyncGeneratorFunction%":bt,"%AsyncIteratorPrototype%":bt,"%Atomics%":typeof Atomics=="undefined"?E:Atomics,"%BigInt%":typeof BigInt=="undefined"?E:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?E:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?E:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?E:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?E:FinalizationRegistry,"%Function%":Ml,"%GeneratorFunction%":bt,"%Int8Array%":typeof Int8Array=="undefined"?E:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?E:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?E:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Et?Ae(Ae([][Symbol.iterator]())):E,"%JSON%":typeof JSON=="object"?JSON:E,"%Map%":typeof Map=="undefined"?E:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!Et?E:Ae(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?E:Promise,"%Proxy%":typeof Proxy=="undefined"?E:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?E:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?E:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!Et?E:Ae(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?E:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Et?Ae(""[Symbol.iterator]()):E,"%Symbol%":Et?Symbol:E,"%SyntaxError%":Er,"%ThrowTypeError%":h_,"%TypedArray%":p_,"%TypeError%":Rt,"%Uint8Array%":typeof Uint8Array=="undefined"?E:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?E:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?E:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?E:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?E:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?E:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?E:WeakSet},y_=function e(t){var r;if(t==="%AsyncFunction%")r=Hi("async function () {}");else if(t==="%GeneratorFunction%")r=Hi("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=Hi("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&(r=Ae(i.prototype))}return St[t]=r,r},Il={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Mn=qn(),In=ql(),g_=Mn.call(Function.call,Array.prototype.concat),m_=Mn.call(Function.apply,Array.prototype.splice),Nl=Mn.call(Function.call,String.prototype.replace),Nn=Mn.call(Function.call,String.prototype.slice),v_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,__=/\\(\\)?/g,R_=function(t){var r=Nn(t,0,1),n=Nn(t,-1);if(r==="%"&&n!=="%")throw new Er("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Er("invalid intrinsic syntax, expected opening `%`");var i=[];return Nl(t,v_,function(s,o,a,u){i[i.length]=a?Nl(u,__,"$1"):o||s}),i},E_=function(t,r){var n=t,i;if(In(Il,n)&&(i=Il[n],n="%"+i[0]+"%"),In(St,n)){var s=St[n];if(s===bt&&(s=y_(n)),typeof s=="undefined"&&!r)throw new Rt("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Er("intrinsic "+t+" does not exist!")};jl.exports=function(t,r){if(typeof t!="string"||t.length===0)throw new Rt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Rt('"allowMissing" argument must be a boolean');var n=R_(t),i=n.length>0?n[0]:"",s=E_("%"+i+"%",r),o=s.name,a=s.value,u=!1,c=s.alias;c&&(i=c[0],m_(n,g_([0,1],c)));for(var l=1,f=!0;l<n.length;l+=1){var d=n[l],p=Nn(d,0,1),y=Nn(d,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Er("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(u=!0),i+="."+d,o="%"+i+"%",In(St,o))a=St[o];else if(a!=null){if(!(d in a)){if(!r)throw new Rt("base intrinsic for "+t+" exists, but the property is not available.");return}if(Ge&&l+1>=n.length){var m=Ge(a,d);f=!!m,f&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else f=In(a,d),a=a[d];f&&!u&&(St[o]=a)}}return a}});var Ul=h((mb,Ln)=>{"use strict";var qi=qn(),Ct=jn(),Ll=Ct("%Function.prototype.apply%"),$l=Ct("%Function.prototype.call%"),Fl=Ct("%Reflect.apply%",!0)||qi.call($l,Ll),kl=Ct("%Object.getOwnPropertyDescriptor%",!0),Ve=Ct("%Object.defineProperty%",!0),b_=Ct("%Math.max%");if(Ve)try{Ve({},"a",{value:1})}catch(e){Ve=null}Ln.exports=function(t){var r=Fl(qi,$l,arguments);if(kl&&Ve){var n=kl(r,"length");n.configurable&&Ve(r,"length",{value:1+b_(0,t.length-(arguments.length-1))})}return r};var Bl=function(){return Fl(qi,Ll,arguments)};Ve?Ve(Ln.exports,"apply",{value:Bl}):Ln.exports.apply=Bl});var Yl=h((vb,Vl)=>{"use strict";var Wl=jn(),Gl=Ul(),S_=Gl(Wl("String.prototype.indexOf"));Vl.exports=function(t,r){var n=Wl(t,!!r);return typeof n=="function"&&S_(t,".prototype.")>-1?Gl(n):n}});var Kl=h((_b,zl)=>{zl.exports=require("util").inspect});var sf=h((Rb,nf)=>{var Mi=typeof Map=="function"&&Map.prototype,Ii=Object.getOwnPropertyDescriptor&&Mi?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,$n=Mi&&Ii&&typeof Ii.get=="function"?Ii.get:null,C_=Mi&&Map.prototype.forEach,Ni=typeof Set=="function"&&Set.prototype,ji=Object.getOwnPropertyDescriptor&&Ni?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Fn=Ni&&ji&&typeof ji.get=="function"?ji.get:null,A_=Ni&&Set.prototype.forEach,w_=typeof WeakMap=="function"&&WeakMap.prototype,br=w_?WeakMap.prototype.has:null,x_=typeof WeakSet=="function"&&WeakSet.prototype,Sr=x_?WeakSet.prototype.has:null,T_=typeof WeakRef=="function"&&WeakRef.prototype,Ql=T_?WeakRef.prototype.deref:null,P_=Boolean.prototype.valueOf,O_=Object.prototype.toString,H_=Function.prototype.toString,D_=String.prototype.match,Li=typeof BigInt=="function"?BigInt.prototype.valueOf:null,$i=Object.getOwnPropertySymbols,Fi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Cr=typeof Symbol=="function"&&typeof Symbol.iterator=="object",q_=Object.prototype.propertyIsEnumerable,Jl=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null),ki=Kl().custom,Bi=ki&&Zl(ki)?ki:null,k=typeof Symbol=="function"&&typeof Symbol.toStringTag!="undefined"?Symbol.toStringTag:null;nf.exports=function e(t,r,n,i){var s=r||{};if(Ye(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ye(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==Infinity:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Ye(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ye(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(typeof t=="undefined")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return tf(t,s);if(typeof t=="number")return t===0?Infinity/t>0?"0":"-0":String(t);if(typeof t=="bigint")return String(t)+"n";var a=typeof s.depth=="undefined"?5:s.depth;if(typeof n=="undefined"&&(n=0),n>=a&&a>0&&typeof t=="object")return Ui(t)?"[Array]":"[Object]";var u=X_(s,n);if(typeof i=="undefined")i=[];else if(ef(i,t)>=0)return"[Circular]";function c(J,Or,Mf){if(Or&&(i=i.slice(),i.push(Or)),Mf){var lo={depth:s.depth};return Ye(s,"quoteStyle")&&(lo.quoteStyle=s.quoteStyle),e(J,lo,n+1,i)}return e(J,s,n+1,i)}if(typeof t=="function"){var l=U_(t),f=kn(t,c);return"[Function"+(l?": "+l:" (anonymous)")+"]"+(f.length>0?" { "+f.join(", ")+" }":"")}if(Zl(t)){var d=Cr?String(t).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):Fi.call(t);return typeof t=="object"&&!Cr?Ar(d):d}if(K_(t)){for(var p="<"+String(t.nodeName).toLowerCase(),y=t.attributes||[],m=0;m<y.length;m++)p+=" "+y[m].name+"="+Xl(M_(y[m].value),"double",s);return p+=">",t.childNodes&&t.childNodes.length&&(p+="..."),p+="</"+String(t.nodeName).toLowerCase()+">",p}if(Ui(t)){if(t.length===0)return"[]";var g=kn(t,c);return u&&!J_(g)?"["+Gi(g,u)+"]":"[ "+g.join(", ")+" ]"}if(j_(t)){var R=kn(t,c);return R.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+R.join(", ")+" }"}if(typeof t=="object"&&o){if(Bi&&typeof t[Bi]=="function")return t[Bi]();if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(W_(t)){var x=[];return C_.call(t,function(J,Or){x.push(c(Or,t,!0)+" => "+c(J,t))}),rf("Map",$n.call(t),x,u)}if(Y_(t)){var U=[];return A_.call(t,function(J){U.push(c(J,t))}),rf("Set",Fn.call(t),U,u)}if(G_(t))return Wi("WeakMap");if(z_(t))return Wi("WeakSet");if(V_(t))return Wi("WeakRef");if($_(t))return Ar(c(Number(t)));if(k_(t))return Ar(c(Li.call(t)));if(F_(t))return Ar(P_.call(t));if(L_(t))return Ar(c(String(t)));if(!I_(t)&&!N_(t)){var P=kn(t,c),ee=Jl?Jl(t)===Object.prototype:t instanceof Object||t.constructor===Object,w=t instanceof Object?"":"null prototype",G=!ee&&k&&Object(t)===t&&k in t?we(t).slice(8,-1):w?"Object":"",ue=ee||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",ce=ue+(G||w?"["+[].concat(G||[],w||[]).join(": ")+"] ":"");return P.length===0?ce+"{}":u?ce+"{"+Gi(P,u)+"}":ce+"{ "+P.join(", ")+" }"}return String(t)};function Xl(e,t,r){var n=(r.quoteStyle||t)==="double"?'"':"'";return n+e+n}function M_(e){return String(e).replace(/"/g,"&quot;")}function Ui(e){return we(e)==="[object Array]"&&(!k||!(typeof e=="object"&&k in e))}function I_(e){return we(e)==="[object Date]"&&(!k||!(typeof e=="object"&&k in e))}function N_(e){return we(e)==="[object RegExp]"&&(!k||!(typeof e=="object"&&k in e))}function j_(e){return we(e)==="[object Error]"&&(!k||!(typeof e=="object"&&k in e))}function L_(e){return we(e)==="[object String]"&&(!k||!(typeof e=="object"&&k in e))}function $_(e){return we(e)==="[object Number]"&&(!k||!(typeof e=="object"&&k in e))}function F_(e){return we(e)==="[object Boolean]"&&(!k||!(typeof e=="object"&&k in e))}function Zl(e){if(Cr)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!Fi)return!1;try{return Fi.call(e),!0}catch(t){}return!1}function k_(e){if(!e||typeof e!="object"||!Li)return!1;try{return Li.call(e),!0}catch(t){}return!1}var B_=Object.prototype.hasOwnProperty||function(e){return e in this};function Ye(e,t){return B_.call(e,t)}function we(e){return O_.call(e)}function U_(e){if(e.name)return e.name;var t=D_.call(H_.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function ef(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function W_(e){if(!$n||!e||typeof e!="object")return!1;try{$n.call(e);try{Fn.call(e)}catch(t){return!0}return e instanceof Map}catch(t){}return!1}function G_(e){if(!br||!e||typeof e!="object")return!1;try{br.call(e,br);try{Sr.call(e,Sr)}catch(t){return!0}return e instanceof WeakMap}catch(t){}return!1}function V_(e){if(!Ql||!e||typeof e!="object")return!1;try{return Ql.call(e),!0}catch(t){}return!1}function Y_(e){if(!Fn||!e||typeof e!="object")return!1;try{Fn.call(e);try{$n.call(e)}catch(t){return!0}return e instanceof Set}catch(t){}return!1}function z_(e){if(!Sr||!e||typeof e!="object")return!1;try{Sr.call(e,Sr);try{br.call(e,br)}catch(t){return!0}return e instanceof WeakSet}catch(t){}return!1}function K_(e){return!e||typeof e!="object"?!1:typeof HTMLElement!="undefined"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function tf(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return tf(e.slice(0,t.maxStringLength),t)+n}var i=e.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,Q_);return Xl(i,"single",t)}function Q_(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}function Ar(e){return"Object("+e+")"}function Wi(e){return e+" { ? }"}function rf(e,t,r,n){var i=n?Gi(r,n):r.join(", ");return e+" ("+t+") {"+i+"}"}function J_(e){for(var t=0;t<e.length;t++)if(ef(e[t],`
`)>=0)return!1;return!0}function X_(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Array(e.indent+1).join(" ");else return null;return{base:r,prev:Array(t+1).join(r)}}function Gi(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+e.join(","+r)+`
`+t.prev}function kn(e,t){var r=Ui(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=Ye(e,i)?t(e[i],e):""}var s=typeof $i=="function"?$i(e):[],o;if(Cr){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var u in e)!Ye(e,u)||r&&String(Number(u))===u&&u<e.length||Cr&&o["$"+u]instanceof Symbol||(/[^\w$]/.test(u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e)));if(typeof $i=="function")for(var c=0;c<s.length;c++)q_.call(e,s[c])&&n.push("["+t(s[c])+"]: "+t(e[s[c]],e));return n}});var af=h((Eb,of)=>{"use strict";var Vi=jn(),At=Yl(),Z_=sf(),e0=Vi("%TypeError%"),Bn=Vi("%WeakMap%",!0),Un=Vi("%Map%",!0),t0=At("WeakMap.prototype.get",!0),r0=At("WeakMap.prototype.set",!0),n0=At("WeakMap.prototype.has",!0),s0=At("Map.prototype.get",!0),i0=At("Map.prototype.set",!0),o0=At("Map.prototype.has",!0),Yi=function(e,t){for(var r=e,n;(n=r.next)!==null;r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},a0=function(e,t){var r=Yi(e,t);return r&&r.value},u0=function(e,t,r){var n=Yi(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}},c0=function(e,t){return!!Yi(e,t)};of.exports=function(){var t,r,n,i={assert:function(s){if(!i.has(s))throw new e0("Side channel does not contain "+Z_(s))},get:function(s){if(Bn&&s&&(typeof s=="object"||typeof s=="function")){if(t)return t0(t,s)}else if(Un){if(r)return s0(r,s)}else if(n)return a0(n,s)},has:function(s){if(Bn&&s&&(typeof s=="object"||typeof s=="function")){if(t)return n0(t,s)}else if(Un){if(r)return o0(r,s)}else if(n)return c0(n,s);return!1},set:function(s,o){Bn&&s&&(typeof s=="object"||typeof s=="function")?(t||(t=new Bn),r0(t,s,o)):Un?(r||(r=new Un),i0(r,s,o)):(n||(n={key:{},next:null}),u0(n,s,o))}};return i}});var Wn=h((bb,uf)=>{"use strict";var l0=String.prototype.replace,f0=/%20/g,zi={RFC1738:"RFC1738",RFC3986:"RFC3986"};uf.exports={default:zi.RFC3986,formatters:{RFC1738:function(e){return l0.call(e,f0,"+")},RFC3986:function(e){return String(e)}},RFC1738:zi.RFC1738,RFC3986:zi.RFC3986}});var Qi=h((Sb,lf)=>{"use strict";var d0=Wn(),Ki=Object.prototype.hasOwnProperty,ze=Array.isArray,oe=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),h0=function(t){for(;t.length>1;){var r=t.pop(),n=r.obj[r.prop];if(ze(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]!="undefined"&&i.push(n[s]);r.obj[r.prop]=i}}},cf=function(t,r){for(var n=r&&r.plainObjects?Object.create(null):{},i=0;i<t.length;++i)typeof t[i]!="undefined"&&(n[i]=t[i]);return n},p0=function e(t,r,n){if(!r)return t;if(typeof r!="object"){if(ze(t))t.push(r);else if(t&&typeof t=="object")(n&&(n.plainObjects||n.allowPrototypes)||!Ki.call(Object.prototype,r))&&(t[r]=!0);else return[t,r];return t}if(!t||typeof t!="object")return[t].concat(r);var i=t;return ze(t)&&!ze(r)&&(i=cf(t,n)),ze(t)&&ze(r)?(r.forEach(function(s,o){if(Ki.call(t,o)){var a=t[o];a&&typeof a=="object"&&s&&typeof s=="object"?t[o]=e(a,s,n):t.push(s)}else t[o]=s}),t):Object.keys(r).reduce(function(s,o){var a=r[o];return Ki.call(s,o)?s[o]=e(s[o],a,n):s[o]=a,s},i)},y0=function(t,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},t)},g0=function(e,t,r){var n=e.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(i){return n}},m0=function(t,r,n,i,s){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});for(var a="",u=0;u<o.length;++u){var c=o.charCodeAt(u);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||s===d0.RFC1738&&(c===40||c===41)){a+=o.charAt(u);continue}if(c<128){a=a+oe[c];continue}if(c<2048){a=a+(oe[192|c>>6]+oe[128|c&63]);continue}if(c<55296||c>=57344){a=a+(oe[224|c>>12]+oe[128|c>>6&63]+oe[128|c&63]);continue}u+=1,c=65536+((c&1023)<<10|o.charCodeAt(u)&1023),a+=oe[240|c>>18]+oe[128|c>>12&63]+oe[128|c>>6&63]+oe[128|c&63]}return a},v0=function(t){for(var r=[{obj:{o:t},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),u=0;u<a.length;++u){var c=a[u],l=o[c];typeof l=="object"&&l!==null&&n.indexOf(l)===-1&&(r.push({obj:o,prop:c}),n.push(l))}return h0(r),t},_0=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},R0=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},E0=function(t,r){return[].concat(t,r)},b0=function(t,r){if(ze(t)){for(var n=[],i=0;i<t.length;i+=1)n.push(r(t[i]));return n}return r(t)};lf.exports={arrayToObject:cf,assign:y0,combine:E0,compact:v0,decode:g0,encode:m0,isBuffer:R0,isRegExp:_0,maybeMap:b0,merge:p0}});var gf=h((Cb,yf)=>{"use strict";var ff=af(),Ji=Qi(),wr=Wn(),S0=Object.prototype.hasOwnProperty,df={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,r){return t+"["+r+"]"},repeat:function(t){return t}},Ke=Array.isArray,C0=Array.prototype.push,hf=function(e,t){C0.apply(e,Ke(t)?t:[t])},A0=Date.prototype.toISOString,pf=wr.default,B={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Ji.encode,encodeValuesOnly:!1,format:pf,formatter:wr.formatters[pf],indices:!1,serializeDate:function(t){return A0.call(t)},skipNulls:!1,strictNullHandling:!1},w0=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},x0=function e(t,r,n,i,s,o,a,u,c,l,f,d,p,y,m){var g=t;if(m.has(t))throw new RangeError("Cyclic object value");if(typeof a=="function"?g=a(r,g):g instanceof Date?g=l(g):n==="comma"&&Ke(g)&&(g=Ji.maybeMap(g,function(J){return J instanceof Date?l(J):J})),g===null){if(i)return o&&!p?o(r,B.encoder,y,"key",f):r;g=""}if(w0(g)||Ji.isBuffer(g)){if(o){var R=p?r:o(r,B.encoder,y,"key",f);return[d(R)+"="+d(o(g,B.encoder,y,"value",f))]}return[d(r)+"="+d(String(g))]}var x=[];if(typeof g=="undefined")return x;var U;if(n==="comma"&&Ke(g))U=[{value:g.length>0?g.join(",")||null:void 0}];else if(Ke(a))U=a;else{var P=Object.keys(g);U=u?P.sort(u):P}for(var ee=0;ee<U.length;++ee){var w=U[ee],G=typeof w=="object"&&w.value!==void 0?w.value:g[w];if(!(s&&G===null)){var ue=Ke(g)?typeof n=="function"?n(r,w):r:r+(c?"."+w:"["+w+"]");m.set(t,!0);var ce=ff();hf(x,e(G,ue,n,i,s,o,a,u,c,l,f,d,p,y,ce))}}return x},T0=function(t){if(!t)return B;if(t.encoder!==null&&t.encoder!==void 0&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=t.charset||B.charset;if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=wr.default;if(typeof t.format!="undefined"){if(!S0.call(wr.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var i=wr.formatters[n],s=B.filter;return(typeof t.filter=="function"||Ke(t.filter))&&(s=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:B.addQueryPrefix,allowDots:typeof t.allowDots=="undefined"?B.allowDots:!!t.allowDots,charset:r,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:B.charsetSentinel,delimiter:typeof t.delimiter=="undefined"?B.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:B.encode,encoder:typeof t.encoder=="function"?t.encoder:B.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:B.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:B.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:B.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:B.strictNullHandling}};yf.exports=function(e,t){var r=e,n=T0(t),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):Ke(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a;t&&t.arrayFormat in df?a=t.arrayFormat:t&&"indices"in t?a=t.indices?"indices":"repeat":a="indices";var u=df[a];i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var c=ff(),l=0;l<i.length;++l){var f=i[l];n.skipNulls&&r[f]===null||hf(o,x0(r[f],f,u,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}var d=o.join(n.delimiter),p=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),d.length>0?p+d:""}});var _f=h((Ab,vf)=>{"use strict";var wt=Qi(),Xi=Object.prototype.hasOwnProperty,P0=Array.isArray,M={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:wt.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},O0=function(e){return e.replace(/&#(\d+);/g,function(t,r){return String.fromCharCode(parseInt(r,10))})},mf=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},H0="utf8=%26%2310003%3B",D0="utf8=%E2%9C%93",q0=function(t,r){var n={},i=r.ignoreQueryPrefix?t.replace(/^\?/,""):t,s=r.parameterLimit===Infinity?void 0:r.parameterLimit,o=i.split(r.delimiter,s),a=-1,u,c=r.charset;if(r.charsetSentinel)for(u=0;u<o.length;++u)o[u].indexOf("utf8=")===0&&(o[u]===D0?c="utf-8":o[u]===H0&&(c="iso-8859-1"),a=u,u=o.length);for(u=0;u<o.length;++u)if(u!==a){var l=o[u],f=l.indexOf("]="),d=f===-1?l.indexOf("="):f+1,p,y;d===-1?(p=r.decoder(l,M.decoder,c,"key"),y=r.strictNullHandling?null:""):(p=r.decoder(l.slice(0,d),M.decoder,c,"key"),y=wt.maybeMap(mf(l.slice(d+1),r),function(m){return r.decoder(m,M.decoder,c,"value")})),y&&r.interpretNumericEntities&&c==="iso-8859-1"&&(y=O0(y)),l.indexOf("[]=")>-1&&(y=P0(y)?[y]:y),Xi.call(n,p)?n[p]=wt.combine(n[p],y):n[p]=y}return n},M0=function(e,t,r,n){for(var i=n?t:mf(t,r),s=e.length-1;s>=0;--s){var o,a=e[s];if(a==="[]"&&r.parseArrays)o=[].concat(i);else{o=r.plainObjects?Object.create(null):{};var u=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,c=parseInt(u,10);!r.parseArrays&&u===""?o={0:i}:!isNaN(c)&&a!==u&&String(c)===u&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(o=[],o[c]=i):o[u]=i}i=o}return i},I0=function(t,r,n,i){if(!!t){var s=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,u=n.depth>0&&o.exec(s),c=u?s.slice(0,u.index):s,l=[];if(c){if(!n.plainObjects&&Xi.call(Object.prototype,c)&&!n.allowPrototypes)return;l.push(c)}for(var f=0;n.depth>0&&(u=a.exec(s))!==null&&f<n.depth;){if(f+=1,!n.plainObjects&&Xi.call(Object.prototype,u[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(u[1])}return u&&l.push("["+s.slice(u.index)+"]"),M0(l,r,n,i)}},N0=function(t){if(!t)return M;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof t.charset=="undefined"?M.charset:t.charset;return{allowDots:typeof t.allowDots=="undefined"?M.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:M.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:M.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:M.arrayLimit,charset:r,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:M.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:M.comma,decoder:typeof t.decoder=="function"?t.decoder:M.decoder,delimiter:typeof t.delimiter=="string"||wt.isRegExp(t.delimiter)?t.delimiter:M.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:M.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:M.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:M.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:M.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:M.strictNullHandling}};vf.exports=function(e,t){var r=N0(t);if(e===""||e===null||typeof e=="undefined")return r.plainObjects?Object.create(null):{};for(var n=typeof e=="string"?q0(e,r):e,i=r.plainObjects?Object.create(null):{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],u=I0(a,n[a],r,typeof e=="string");i=wt.merge(i,u,r)}return r.allowSparse===!0?i:wt.compact(i)}});var Ef=h((wb,Rf)=>{"use strict";var j0=gf(),L0=_f(),$0=Wn();Rf.exports={formats:$0,parse:L0,stringify:j0}});var eo=h(xr=>{"use strict";var Zi=xr&&xr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xr,"__esModule",{value:!0});var F0=Zi(Sl()),k0=H(),B0=xi(),U0=Zi(Ef()),W0=Zi(Jr());async function G0(e,t,r,n={rewritePath:!0}){let{request:i,proxy:s,updateUpstreamResponseHeader:o}=t;await s(k0.BACKENDS.js,{headers:{"x-next-page":e},path:()=>{let{query:a}=i;typeof r=="function"?r=r(i.params,i):r||(r=i.params),a=S(S({},a),r);let u=U0.default.stringify(a);return u.length&&(u=`?${u}`),`${n.rewritePath?V0(i,e,r):i.path}${u}`},transformResponse:F0.default}),o("cache-control",/(,\s*\bprivate\b\s*)|(^\s*private,\s*)/g,"")}xr.default=G0;function V0(e,t,r){let n=B0.toRouteSyntax(t);return e.path&&e.path.startsWith("/_next/data/")&&(n=`/_next/data/:__build__/${n.replace(/^\//,"")}.json`),W0.default(n,r)}});var bf=h(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.FAR_FUTURE_TTL=60*60*24*365*10});var Sf=h(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});var Y0=ie();ro.nonWebpackRequire=Y0.default});var Cf=h(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});var z0=Sf();function K0(e,t){return z0.nonWebpackRequire("chokidar").watch(e,t)}no.default=K0});var wf=h(Pr=>{"use strict";var Qe=Pr&&Pr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pr,"__esModule",{value:!0});var Tr=H(),ae=Xe(),Q=xi(),Q0=require("fs"),J0=Qe(Rl()),so=Qe(ie()),Re=require("path"),X0=Qe(bl()),Z0=Qe(eo()),io=bf(),eR=Qe(Cf()),tR=Qe(wi()),rR=Qe(Oe()),nR={browser:{maxAgeSeconds:io.FAR_FUTURE_TTL},edge:{maxAgeSeconds:io.FAR_FUTURE_TTL}},sR={edge:{maxAgeSeconds:io.FAR_FUTURE_TTL}},iR="NextRoutes",xt=(e,t)=>Z0.default(e,t,r=>r,{rewritePath:!1}),Af=class extends X0.default{constructor(t="."){super();this.nextRouteGroupName="next_routes_group",this.type=iR,this.nextRootDir=t,this.pagesDirRelative="pages",this.pagesDir=Re.join(process.cwd(),this.nextRootDir,this.pagesDirRelative),this.distDir=J0.default(),Q0.existsSync(this.pagesDir)||(this.pagesDirRelative=Re.join("src","pages"),this.pagesDir=Re.join(process.cwd(),this.nextRootDir,this.pagesDirRelative)),ae.isProductionBuild()||ae.isCloud()?this.loadRewrites():this.loadRewritesInDev().then(()=>{(this.rewrites||this.redirects)&&this.updateRoutes()})}loadRewrites(){let t=process.env.NEXT_ROUTES_MANIFEST_PATH||Re.join(process.cwd(),this.distDir,"routes-manifest.json");this.routesManifest=so.default(t);let{rewrites:r,redirects:n}=this.routesManifest;this.rewrites=r,this.redirects=n}getPagesManifest(){return so.default(Re.join(process.cwd(),this.distDir,"serverless","pages-manifest.json"))}getPrerenderManifest(){return so.default(Re.join(process.cwd(),this.distDir,"prerender-manifest.json"))}async loadRewritesInDev(){let t=global.LAYER0_NEXT_APP,r=t.nextConfig;if(r||(r=await t.loadConfig()),!r)return;let n=r.rewrites;n&&(this.rewrites=await n());let i=r.redirects;i&&(this.redirects=await i())}onRegister(t){this.router=t,this.router.group(this.nextRouteGroupName,r=>this.addNextRoutesToGroup(r)),this.router.fallback(r=>this.render404(r)),ae.isProductionBuild()||eR.default(this.pagesDir).on("all",()=>this.updateRoutes())}updateRoutes(){var t,r,n;let i=(n=(r=(t=this.router)===null||t===void 0?void 0:t.routeGroups)===null||r===void 0?void 0:r.findByName(this.nextRouteGroupName))===null||n===void 0?void 0:n.clear();this.addNextRoutesToGroup(i)}addNextRoutesToGroup(t){var r,n,i;this.addRewrites((r=this.rewrites)===null||r===void 0?void 0:r.beforeFiles,t),this.addAssets(t),this.addImageOptimizerRoutes(t),this.addRewrites((n=this.rewrites)===null||n===void 0?void 0:n.afterFiles,t),ae.isProductionBuild()?(this.addPagesInProd(t),this.addPrerendering()):this.addPagesInDev(t);let s=((i=this.rewrites)===null||i===void 0?void 0:i.fallback)||this.rewrites;Array.isArray(s)&&this.addRewrites(s,t),this.addRedirects(t)}createRouteCriteria(t,r){let n=t.replace(/\/:nextInternalLocale[^/]+/,"");if(r){let i={},s={},o={};for(let a of r){if(typeof a.value=="string"&&a.value.match(/\(\?<[^>]+>/))throw new Error("Layer0 does not yet support capturing named parameters in `has` elements of `rewrites` or `redirects` in next.config.js.");a.type==="header"?i[a.key]=a.value?new RegExp(a.value):/.*/:a.type==="host"?i.host=new RegExp(a.value):a.type==="cookie"?s[a.key]=a.value?new RegExp(a.value):/.*/:a.type==="query"?o[a.key]=a.value?new RegExp(a.value):/.*/:console.warn(`Warning: has.type ${a.type} is not supported by Layer0`)}return{path:n,headers:Object.keys(i).length?i:void 0,cookies:Object.keys(s).length?s:void 0,query:Object.keys(o).length?o:void 0}}else return n}addRewrite(t,r,n,i){let s=i.replace(/\/:nextInternalLocale[^/]*/,"");if(this.defaultLocale&&(s=s.replace(/:locale/,this.defaultLocale)),ae.isProductionBuild()&&console.log(`[rewrite] ${r} => ${s}`),i.match(/^https?:\/\//)){let o=new URL(i),a=this.backendForDestination(o);a?t.match(this.createRouteCriteria(r,n),({proxy:u})=>{u(a,{path:o.pathname})}):console.warn(`No matching backend was found in layer0.config.js for rewrite to ${o.toString()}. To fix this problem, add key to the backends config with the following value: { "domainOrIp": "${o.hostname}" }. See https://docs.layer0.co/guides/layer0_config#section_backends for more information.`)}else t.match(this.createRouteCriteria(r,n),o=>{let a=t.routes.find(u=>u.match({path:s}));a?(o.rewrite(i,a.criteria.path),a.handler(o)):console.warn(`No matching route found for rewrite ${r} => ${i}`)})}backendForDestination(t){let r=rR.default.get("backends",{}),n=Object.entries(r).find(([i,s])=>s.domainOrIp===t.hostname);if(n)return n[0]}addRewrites(t,r){if(t)for(let{source:n,destination:i,has:s}of t)this.addRewrite(r,n,s,i)}addRedirects(t){if(this.redirects)for(let{source:r,has:n,statusCode:i,destination:s}of this.redirects)r!=="/:path+/"&&t.match(this.createRouteCriteria(r,n),({redirect:o})=>{o(s,{statusCode:i||302})})}addPagesInDev(t){let r=n=>n.proxy(Tr.BACKENDS.js);t.dir(this.pagesDirRelative,{ignore:["_*"],paths:n=>{let i=Q.toRouteSyntax(n);return i.endsWith("/")&&(i+="index"),[`/_next/data/:build${i}.json`]},handler:()=>r}),t.dir(this.pagesDirRelative,{ignore:["_*"],paths:n=>[Q.toRouteSyntax(n)],handler:()=>r})}addPagesInProd(t){var r,n;let{routesManifest:i}=this,s=this.getPagesManifest(),o=this.getPrerenderManifest(),a=(r=i.i18n)===null||r===void 0?void 0:r.locales;this.defaultLocale=(n=i.i18n)===null||n===void 0?void 0:n.defaultLocale;let u=new Set(Object.entries(o.routes).filter(([y,m])=>m.srcRoute==null).map(([y,m])=>y)),c=new Set(i.dataRoutes.map(y=>y.page)),l=(y,m,g)=>{console.debug(`[${y}]`,m),t.match(m,g)},f=a&&new RegExp(`^/(${a.join("|")})(/|$)`),d=(a==null?void 0:a.length)>0;console.debug(`Next.js routes (locales: ${(a==null?void 0:a.join(", "))||"none"})`),console.debug("--------------");let p=oR(Object.keys(s),i);for(let y of p){let m=s[y],g=Q.toRouteSyntax(y);if(y.startsWith("/api"))l("api",g,R=>xt(y.slice(1),R));else if(m&&m.endsWith(".html")){let R=m.replace(/^pages\//,"").replace(/\.html$/,"");this.defaultLocale&&y.startsWith(`/${this.defaultLocale}`)?l("SSG html",Q.localize(a,this.removeLocale(g)),this.createSSGHandler(R.replace(new RegExp(this.defaultLocale+"(/|$)"),":locale$1"))):a&&f.test(y)||l("SSG html",g,this.createSSGHandler(R))}else{let R=o.dynamicRoutes[y];R||u.has(y)?(l("SSG (\u03BB) json",`/_next/data/:__build__${Q.localize(a,Q.toRouteSyntax(y,{suffix:"json"}))}`,this.createSSGHandler(y,{dataRoute:!0,localize:d})),l(`SSG (\u03BB${(R==null?void 0:R.fallback)?" w/fallback":""}) html`,Q.localize(a,Q.toRouteSyntax(y)),this.createSSGHandler(y,{localize:d}))):(c.has(y)&&l("SSR json",`/_next/data/:__build__${Q.localize(a,Q.toRouteSyntax(y,{suffix:"json"}))}`,this.createSSRHandler(y)),l("SSR html",Q.localize(a,Q.toRouteSyntax(y)),this.createSSRHandler(y)))}}}removeLocale(t){let[r,n,...i]=t.split("/");return"/"+i.join("/")}addPrerendering(){let{routes:t}=this.getPrerenderManifest(),r=[];for(let i in t){let s=t[i];r.push({path:i}),s.dataRoute&&r.push({path:s.dataRoute})}this.router.prerender(r)}createSSRHandler(t){return r=>xt(t.slice(1),r)}createSSGHandler(t,{dataRoute:r,localize:n}={}){return i=>{let s=r?"json":"html",o=`${this.distDir}/serverless/pages${n?"/:locale":""}`,a=this.getPrerenderManifest(),u=a.dynamicRoutes[t];if(u){let c=Q.toRouteSyntax(t,{suffix:s}).replace(/\/\.(json|html)$/,".$1"),l=`${o}${c}`,{fallback:f}=u,d=!r&&f?`${o}${f}`:void 0;i.serveStatic(l,{loadingPage:d,onNotFound:()=>{let p=a.routes[i.request.path];return f!==!1||p||r?xt(t,i):this.render404(i)}})}else{let c=`${tR.default(Re.join(o,t))}`;c.endsWith("/")&&(c+="index"),i.serveStatic(`${c}.${s}`,{onNotFound:()=>xt(t,i)})}}}async render404(t){if(ae.isCloud()){let r=this.getPagesManifest(),n=r["/404"]||r[`/${this.defaultLocale}/404`],i=`${this.distDir}/serverless/pages${this.defaultLocale?"/:locale":""}`;n&&n.endsWith(".html")?await t.serveStatic(`${i}/404.html`,{statusCode:404,statusMessage:"Not Found"}):(t.response.statusCode=404,t.response.statusMessage="Not Found",await xt("404",t))}else return xt("404",t)}addAssets(t){t.static(Re.join(this.nextRootDir,"public"),{handler:n=>i=>i.cache(sR)}),ae.isCloud()||t.match("/_next/webpack-hmr",({stream:n})=>n("__js__"));let r=({proxy:n,serveStatic:i,cache:s})=>{ae.isCloud()||ae.isProductionBuild()?(s(nR),i(`${this.distDir}/static/:path*`,{permanent:!0,exclude:[Re.join(this.distDir,"static","service-worker.js")]})):n(Tr.BACKENDS.js)};t.match("/_next/static/:path*",r),t.match("/autostatic/:path*",r)}addImageOptimizerRoutes(t){t.match("/_next/image",({proxy:r})=>{let n=ae.isProductionBuild(),i=n?Tr.BACKENDS.imageOptimizer:Tr.BACKENDS.js,s=n?{path:Tr.LAYER0_IMAGE_OPTIMIZER_PATH}:void 0;r(i,s)})}};Pr.default=Af;function oR(e,t){let r=s=>t.dynamicRoutes.find(o=>o.page===s),n=[],i=[];for(let s of e)r(s)?i.push(s):n.push(s);return n.concat(i)}});var xf=h(Tt=>{"use strict";var aR=Tt&&Tt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tt,"__esModule",{value:!0});var uR=aR(wf());Tt.nextRoutes=new uR.default;var cR=eo();Tt.renderNextPage=cR.default});var Tf=h(Gn=>{"use strict";function lR(e){for(var t in e)Gn.hasOwnProperty(t)||(Gn[t]=e[t])}Object.defineProperty(Gn,"__esModule",{value:!0});lR(xf())});var Of=h((Mb,Pf)=>{var{CustomCacheKey:fR}=Ai(),Pt=60*60*24,oo=60*60*24*365*10,ao=new fR().excludeAllQueryParametersExcept("q","sort","filters","color","size","amp","page");Pf.exports={FAR_FUTURE_TTL:oo,PAGE_TTL:Pt,key:ao,SSR:{key:ao,browser:{maxAgeSeconds:0},edge:{maxAgeSeconds:Pt,staleWhileRevalidateSeconds:Pt}},API:{key:ao,browser:{maxAgeSeconds:0,serviceWorkerSeconds:Pt},edge:{maxAgeSeconds:Pt,staleWhileRevalidateSeconds:Pt}},FAR_FUTURE:{browser:{maxAgeSeconds:oo},edge:{maxAgeSeconds:oo,staleWhileRevalidateSeconds:60*60*24}},cacheResponse:e=>({cache:t})=>t(e)}});var qf=h((Ib,Df)=>{var{existsSync:dR,readFileSync:hR}=require("fs"),{join:pR}=require("path"),Hf=pR(process.cwd(),".next","BUILD_ID");Df.exports=async function(){let t=[{path:"/"}];for(let r=1;r<=10;r++)t.push({path:`/s/${r}`}),t.push({path:`/p/${r}`});if(dR(Hf)){let r=hR(Hf,"utf8"),n=t.map(i=>({path:`/api${i.path.replace(/\/$/,"")}?__v__=${r}`}));t.push(...n)}return t}});var{Router:yR}=Ai(),{nextRoutes:gR}=Tf(),{API:uo,SSR:co,cacheResponse:Ot}=Of(),mR=qf();module.exports=new yR().prerender(mR).match("/service-worker.js",({serviceWorker:e})=>{e(".next/static/service-worker.js")}).match("/",Ot(co)).match("/api",Ot(uo)).match("/s/:categorySlug*",Ot(co)).match("/api/s/:categorySlug*",Ot(uo)).match("/p/:productId",Ot(co)).match("/api/p/:productId",Ot(uo)).use(gR).fallback(({proxy:e})=>e("legacy"));
/*!
 * Array of passes.
 *
 * A `pass` is just a function that is executed on `req, res, options`
 * so that you can easily add new checks while still keeping the base
 * flexible.
 */
/*!
 * Array of passes.
 *
 * A `pass` is just a function that is executed on `req, socket, options`
 * so that you can easily add new checks while still keeping the base
 * flexible.
 */
/*!
 * Caron dimonio, con occhi di bragia
 * loro accennando, tutte le raccoglie;
 * batte col remo qualunque sadagia 
 *
 * Charon the demon, with the eyes of glede,
 * Beckoning to them, collects them all together,
 * Beats with his oar whoever lags behind
 *          
 *          Dante - The Divine Comedy (Canto III)
 */
/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
//# sourceMappingURL=routes.js.map

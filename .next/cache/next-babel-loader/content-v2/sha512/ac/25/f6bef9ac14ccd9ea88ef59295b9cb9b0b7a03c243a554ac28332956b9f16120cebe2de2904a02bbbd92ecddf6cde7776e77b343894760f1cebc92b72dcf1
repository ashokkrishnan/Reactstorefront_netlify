{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Reactstorefront/base_reactstorefront/AK-React-Base/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Reactstorefront/base_reactstorefront/AK-React-Base/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Reactstorefront/base_reactstorefront/AK-React-Base/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"C:/Reactstorefront/base_reactstorefront/AK-React-Base/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport React, { useContext, useState } from 'react';\nimport clsx from 'clsx';\nimport Head from 'next/head';\nimport useLazyState from 'react-storefront/hooks/useLazyState';\nimport Breadcrumbs from 'react-storefront/Breadcrumbs';\nimport CmsSlot from 'react-storefront/CmsSlot';\nimport MediaCarousel from 'react-storefront-amp/carousel/AmpMediaCarousel';\nimport PWAContext from 'react-storefront/PWAContext';\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Hidden from \"@material-ui/core/Hidden\";\nimport Button from \"@material-ui/core/Button\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport Row from 'react-storefront/Row';\nimport { Hbox } from 'react-storefront/Box';\nimport Label from 'react-storefront/Label';\nimport Rating from 'react-storefront/Rating';\nimport get from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\nimport HiddenInput from 'react-storefront-amp/HiddenInput';\nimport SessionContext from 'react-storefront/session/SessionContext';\nimport AddToCartConfirmation from '../../components/product/AddToCartConfirmation';\nimport SuggestedProducts from '../../components/product/SuggestedProducts';\nimport Lazy from 'react-storefront/Lazy';\nimport TabPanel from 'react-storefront-amp/AmpTabPanel';\nimport Text from 'react-storefront-amp/Text';\nimport DataBindingProvider from 'react-storefront-amp/bind/DataBindingProvider';\nimport QuantitySelector from 'react-storefront-amp/AmpQuantitySelector';\nimport ProductOptionSelector from 'react-storefront-amp/option/AmpProductOptionSelector';\nimport { TrackPageView } from 'react-storefront-analytics';\nimport { useAmp } from 'next/amp';\nimport fetchFromAPI from 'react-storefront/props/fetchFromAPI';\nimport createLazyProps from 'react-storefront/props/createLazyProps';\nimport getAPIURL from 'react-storefront/api/getAPIURL';\nimport LazyHydrate from 'react-storefront/LazyHydrate';\n\nvar styles = function styles(theme) {\n  return {\n    carousel: _defineProperty({}, theme.breakpoints.down('xs'), {\n      margin: theme.spacing(0, -2),\n      width: '100vw'\n    }),\n    lightboxCarousel: _defineProperty({}, theme.breakpoints.down('xs'), {\n      margin: 0,\n      width: '100%'\n    }),\n    confirmation: {\n      padding: '2px 0'\n    },\n    dockedSnack: _defineProperty({}, theme.breakpoints.down('xs'), {\n      left: '0',\n      bottom: '0',\n      right: '0'\n    }),\n    docked: _defineProperty({}, theme.breakpoints.down('xs'), {\n      fontSize: theme.typography.subtitle1.fontSize,\n      padding: \"\".concat(theme.spacing(2), \"px\"),\n      position: 'fixed',\n      left: 0,\n      bottom: 0,\n      width: '100%',\n      zIndex: 10,\n      borderRadius: '0'\n    }),\n    noShadow: _defineProperty({}, theme.breakpoints.down('xs'), {\n      boxShadow: 'none'\n    })\n  };\n};\n\nvar useStyles = makeStyles(styles);\nvar Product = /*#__PURE__*/React.memo(function (lazyProps) {\n  var theme = useTheme();\n\n  var _useState = useState(false),\n      confirmationOpen = _useState[0],\n      setConfirmationOpen = _useState[1];\n\n  var _useState2 = useState(false),\n      addToCartInProgress = _useState2[0],\n      setAddToCartInProgress = _useState2[1];\n\n  var _useState3 = useState(null),\n      errorBoxMessage = _useState3[0],\n      setErrorBoxMessage = _useState3[1];\n\n  var _useLazyState = useLazyState(lazyProps, {\n    pageData: {\n      quantity: 1,\n      carousel: {\n        index: 0\n      }\n    }\n  }),\n      _useLazyState2 = _slicedToArray(_useLazyState, 2),\n      state = _useLazyState2[0],\n      updateState = _useLazyState2[1];\n\n  var classes = useStyles();\n  var product = get(state, 'pageData.product') || {};\n  var color = get(state, 'pageData.color') || {};\n  var size = get(state, 'pageData.size') || {};\n  var hasColors = !isEmpty(product.colors);\n  var hasSizes = !isEmpty(product.sizes);\n  var quantity = get(state, 'pageData.quantity');\n\n  var _useContext = useContext(SessionContext),\n      actions = _useContext.actions;\n\n  var loading = state.loading; // This is provided when <ForwardThumbnail> is wrapped around product links\n\n  var _useContext2 = useContext(PWAContext),\n      thumbnail = _useContext2.thumbnail; // Adds an item to the cart\n\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault(); // prevent the page location from changing\n\n              setAddToCartInProgress(true); // disable the add to cart button until the request is finished\n\n              setErrorBoxMessage(null);\n              _context.prev = 3;\n\n              if (!(!color.id && product.hasColors)) {\n                _context.next = 7;\n                break;\n              }\n\n              setErrorBoxMessage('Please select color');\n              return _context.abrupt(\"return\");\n\n            case 7:\n              if (!(!size.id && product.hasSizes)) {\n                _context.next = 10;\n                break;\n              }\n\n              setErrorBoxMessage('Please select size');\n              return _context.abrupt(\"return\");\n\n            case 10:\n              _context.prev = 10;\n              _context.next = 13;\n              return actions.addToCart({\n                product: product,\n                quantity: quantity,\n                color: color.id,\n                size: size.id\n              });\n\n            case 13:\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](10);\n              setErrorBoxMessage(_context.t0.message);\n\n            case 18:\n              // open the confirmation dialog\n              setConfirmationOpen(true);\n\n            case 19:\n              _context.prev = 19;\n              // re-enable the add to cart button\n              setAddToCartInProgress(false);\n              return _context.finish(19);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3,, 19, 22], [10, 15]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var header = /*#__PURE__*/_jsxs(Row, {\n    children: [/*#__PURE__*/_jsx(Typography, {\n      variant: \"h6\",\n      component: \"h1\",\n      gutterBottom: true,\n      children: product ? /*#__PURE__*/_jsx(Text, {\n        bind: \"product.name\"\n      }) : /*#__PURE__*/_jsx(Skeleton, {\n        style: {\n          height: '1em'\n        }\n      })\n    }), /*#__PURE__*/_jsxs(Hbox, {\n      children: [/*#__PURE__*/_jsx(Typography, {\n        style: {\n          marginRight: theme.spacing(2)\n        },\n        children: /*#__PURE__*/_jsx(Text, {\n          bind: \"product.priceText\"\n        })\n      }), /*#__PURE__*/_jsx(Rating, {\n        value: product.rating,\n        reviewCount: 10\n      })]\n    })]\n  });\n\n  return /*#__PURE__*/_jsxs(DataBindingProvider // If data is not already available in the model during SSR,\n  // you can instruct the DataBindingProvider to fetch new state\n  // when the `remote` URL changes.\n  //\n  // If no data will need to be fetched and is available in the page state\n  // this property is not needed and should be removed\n  , {\n    remote: getAPIURL('/p/{product.id}?color={color.id}&size={size.id}'),\n    store: state,\n    updateStore: updateState,\n    root: \"pageData\",\n    children: [useAmp() && /*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"script\", {\n        async: true,\n        \"custom-element\": \"amp-form\",\n        src: \"https://cdn.ampproject.org/v0/amp-form-0.1.js\"\n      })\n    }), !loading && /*#__PURE__*/_jsx(TrackPageView, {}), /*#__PURE__*/_jsx(Breadcrumbs, {\n      items: !loading && state.pageData.breadcrumbs\n    }), /*#__PURE__*/_jsx(Container, {\n      maxWidth: \"lg\",\n      style: {\n        paddingTop: theme.spacing(2)\n      },\n      children: /*#__PURE__*/_jsxs(\"form\", {\n        encType: \"application/x-www-form-urlencoded\",\n        onSubmit: handleSubmit,\n        method: \"post\",\n        \"action-xhr\": \"/api/cart/add\",\n        children: [/*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          spacing: 4,\n          children: [/*#__PURE__*/_jsx(HiddenInput, {\n            name: \"id\",\n            bind: \"product.id\"\n          }), /*#__PURE__*/_jsx(HiddenInput, {\n            name: \"sku\",\n            bind: \"product.sku\"\n          }), /*#__PURE__*/_jsx(HiddenInput, {\n            name: \"isConfigurableProduct\",\n            bind: \"product.isConfigurableProduct\"\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 12,\n            sm: 6,\n            md: 5,\n            children: [/*#__PURE__*/_jsx(Hidden, {\n              implementation: \"css\",\n              smUp: true,\n              children: header\n            }), /*#__PURE__*/_jsx(LazyHydrate, {\n              id: \"carousel\",\n              on: \"touch\",\n              children: /*#__PURE__*/_jsx(MediaCarousel, {\n                className: classes.carousel,\n                lightboxClassName: classes.lightboxCarousel,\n                thumbnail: thumbnail.current,\n                height: \"100%\",\n                bind: {\n                  media: ['color.media', 'product.media']\n                }\n              })\n            })]\n          }), /*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 12,\n            sm: 6,\n            md: 7,\n            children: /*#__PURE__*/_jsx(LazyHydrate, {\n              id: \"options\",\n              children: /*#__PURE__*/_jsxs(Grid, {\n                container: true,\n                spacing: 4,\n                children: [/*#__PURE__*/_jsxs(Grid, {\n                  item: true,\n                  xs: 12,\n                  children: [/*#__PURE__*/_jsx(Hidden, {\n                    implementation: \"css\",\n                    xsDown: true,\n                    children: /*#__PURE__*/_jsx(\"div\", {\n                      style: {\n                        paddingBottom: theme.spacing(1)\n                      },\n                      children: header\n                    })\n                  }), product ? /*#__PURE__*/_jsxs(_Fragment, {\n                    children: [errorBoxMessage && /*#__PURE__*/_jsx(Hbox, {\n                      style: {\n                        marginBottom: 10\n                      },\n                      children: /*#__PURE__*/_jsx(Typography, {\n                        color: \"error\",\n                        children: errorBoxMessage\n                      })\n                    }), hasColors && /*#__PURE__*/_jsxs(_Fragment, {\n                      children: [/*#__PURE__*/_jsxs(Hbox, {\n                        style: {\n                          marginBottom: 10\n                        },\n                        children: [/*#__PURE__*/_jsx(Label, {\n                          children: \"COLOR: \"\n                        }), /*#__PURE__*/_jsxs(Typography, {\n                          children: [/*#__PURE__*/_jsx(HiddenInput, {\n                            name: \"color\",\n                            bind: \"color.id\"\n                          }), /*#__PURE__*/_jsx(Text, {\n                            bind: \"color.text\"\n                          })]\n                        })]\n                      }), /*#__PURE__*/_jsx(ProductOptionSelector, {\n                        optionProps: {\n                          showLabel: false\n                        },\n                        strikeThroughDisabled: true,\n                        bind: {\n                          value: 'color',\n                          options: 'product.colors'\n                        }\n                      })]\n                    })]\n                  }) : /*#__PURE__*/_jsxs(\"div\", {\n                    children: [/*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 14,\n                        marginBottom: theme.spacing(2)\n                      }\n                    }), /*#__PURE__*/_jsxs(Hbox, {\n                      children: [/*#__PURE__*/_jsx(Skeleton, {\n                        style: {\n                          height: 48,\n                          width: 48,\n                          marginRight: 10\n                        }\n                      }), /*#__PURE__*/_jsx(Skeleton, {\n                        style: {\n                          height: 48,\n                          width: 48,\n                          marginRight: 10\n                        }\n                      }), /*#__PURE__*/_jsx(Skeleton, {\n                        style: {\n                          height: 48,\n                          width: 48,\n                          marginRight: 10\n                        }\n                      })]\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsx(Grid, {\n                  item: true,\n                  xs: 12,\n                  children: product ? /*#__PURE__*/_jsx(_Fragment, {\n                    children: hasSizes && /*#__PURE__*/_jsxs(_Fragment, {\n                      children: [/*#__PURE__*/_jsxs(Hbox, {\n                        style: {\n                          marginBottom: 10\n                        },\n                        children: [/*#__PURE__*/_jsx(Label, {\n                          children: \"SIZE: \"\n                        }), /*#__PURE__*/_jsxs(Typography, {\n                          children: [/*#__PURE__*/_jsx(HiddenInput, {\n                            name: \"size\",\n                            bind: \"size.id\"\n                          }), /*#__PURE__*/_jsx(Text, {\n                            bind: \"size.text\"\n                          })]\n                        })]\n                      }), /*#__PURE__*/_jsx(ProductOptionSelector, {\n                        strikeThroughDisabled: true,\n                        bind: {\n                          value: 'size',\n                          options: 'product.sizes'\n                        }\n                      })]\n                    })\n                  }) : /*#__PURE__*/_jsxs(\"div\", {\n                    children: [/*#__PURE__*/_jsx(Skeleton, {\n                      style: {\n                        height: 14,\n                        marginBottom: theme.spacing(2)\n                      }\n                    }), /*#__PURE__*/_jsxs(Hbox, {\n                      children: [/*#__PURE__*/_jsx(Skeleton, {\n                        style: {\n                          height: 48,\n                          width: 48,\n                          marginRight: 10\n                        }\n                      }), /*#__PURE__*/_jsx(Skeleton, {\n                        style: {\n                          height: 48,\n                          width: 48,\n                          marginRight: 10\n                        }\n                      }), /*#__PURE__*/_jsx(Skeleton, {\n                        style: {\n                          height: 48,\n                          width: 48,\n                          marginRight: 10\n                        }\n                      })]\n                    })]\n                  })\n                }), /*#__PURE__*/_jsx(Grid, {\n                  item: true,\n                  xs: 12,\n                  children: /*#__PURE__*/_jsxs(Hbox, {\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      children: \"QTY:\"\n                    }), /*#__PURE__*/_jsx(QuantitySelector, {\n                      bind: \"quantity\"\n                    })]\n                  })\n                }), /*#__PURE__*/_jsxs(Grid, {\n                  item: true,\n                  xs: 12,\n                  children: [/*#__PURE__*/_jsx(Button, {\n                    type: \"submit\",\n                    variant: \"contained\",\n                    color: \"primary\",\n                    size: \"large\",\n                    \"data-th\": \"add-to-cart\",\n                    className: clsx(classes.docked, classes.noShadow),\n                    disabled: addToCartInProgress,\n                    children: \"Add to Cart\"\n                  }, \"button\"), /*#__PURE__*/_jsx(AddToCartConfirmation, {\n                    open: confirmationOpen,\n                    setOpen: setConfirmationOpen,\n                    product: product,\n                    color: color,\n                    size: size,\n                    quantity: quantity,\n                    price: product.priceText\n                  })]\n                })]\n              })\n            })\n          })]\n        }), /*#__PURE__*/_jsx(LazyHydrate, {\n          id: \"info\",\n          on: \"fui\",\n          children: /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(Grid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsxs(TabPanel, {\n                children: [/*#__PURE__*/_jsx(CmsSlot, {\n                  label: \"Description\",\n                  children: product.description\n                }), /*#__PURE__*/_jsx(CmsSlot, {\n                  label: \"Specs\",\n                  children: product.specs\n                })]\n              })\n            }), !useAmp() && /*#__PURE__*/_jsx(Grid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsx(Lazy, {\n                style: {\n                  minHeight: 285\n                },\n                children: /*#__PURE__*/_jsx(SuggestedProducts, {\n                  product: product\n                })\n              })\n            })]\n          })\n        })]\n      })\n    })]\n  });\n});\nProduct.getInitialProps = createLazyProps(fetchFromAPI);\nexport var config = {\n  amp: 'hybrid'\n};\nexport default Product;","map":null,"metadata":{},"sourceType":"module"}